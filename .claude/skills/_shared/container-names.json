{
  "version": "1.0.0",
  "description": "Docker container registry with roles and health check URLs",

  "containers": [
    {
      "name": "vless_haproxy",
      "role": "Frontend proxy and traffic router",
      "purpose": "Unified TLS termination & SNI-based routing",
      "image": "haproxy:2.8-alpine",
      "ports": [443, 1080, 8118, 9000],
      "health_check": "http://127.0.0.1:9000/stats",
      "logs": "/opt/vless/logs/haproxy/",
      "criticality": "CRITICAL"
    },
    {
      "name": "vless_xray",
      "role": "VPN core + SOCKS5/HTTP proxy",
      "purpose": "VLESS Reality protocol + proxy services",
      "image": "teddysun/xray:latest",
      "ports": [8443],
      "health_check": "internal",
      "logs": "/opt/vless/logs/xray/",
      "criticality": "CRITICAL"
    },
    {
      "name": "vless_nginx_reverseproxy",
      "role": "Subdomain-based reverse proxy",
      "purpose": "Reverse proxy backend (SNI routing from HAProxy)",
      "image": "nginx:alpine",
      "ports": [9443, 9444, 9445, 9446, 9447, 9448, 9449, 9450, 9451, 9452],
      "health_check": "http://127.0.0.1:9443",
      "logs": "/opt/vless/logs/nginx_reverseproxy/",
      "criticality": "MEDIUM"
    },
    {
      "name": "vless_certbot_nginx",
      "role": "Certificate validation (on-demand)",
      "purpose": "Let's Encrypt HTTP-01 challenge validation",
      "image": "nginx:alpine",
      "ports": [80],
      "health_check": "http://127.0.0.1:80",
      "logs": "/opt/vless/logs/certbot_nginx/",
      "criticality": "LOW"
    },
    {
      "name": "vless_fake_site",
      "role": "Fallback site for anti-detection",
      "purpose": "Serve fallback content for non-proxy traffic",
      "image": "nginx:alpine",
      "ports": [80],
      "health_check": "http://127.0.0.1:80",
      "logs": "/opt/vless/logs/fake_site/",
      "criticality": "LOW"
    },
    {
      "name": "vless_mtproxy",
      "role": "Telegram MTProxy (optional, v6.0+)",
      "purpose": "Telegram proxy service",
      "image": "telegrammessenger/proxy:latest",
      "ports": [8443],
      "health_check": "tcp://0.0.0.0:8443",
      "logs": "/opt/vless/logs/mtproxy/",
      "criticality": "MEDIUM"
    }
  ],

  "dependency_order": [
    "vless_fake_site",
    "vless_certbot_nginx",
    "vless_nginx_reverseproxy",
    "vless_xray",
    "vless_haproxy",
    "vless_mtproxy"
  ]
}
