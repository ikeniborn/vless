# Product Requirements Document (PRD)
## VLESS + REALITY VPN Service

### 1. –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

**–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:** VLESS + REALITY VPN Service
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.4
**–î–∞—Ç–∞:** 2025-10-01
**–¢–∏–ø –ø—Ä–æ–µ–∫—Ç–∞:** –õ–∏—á–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
**–ú–∞—Å—à—Ç–∞–±:** –î–æ 50 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

#### –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π:
- **v1.4 (2025-10-01):** –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è UFW —Å Docker bridge networking. –î–æ–±–∞–≤–ª–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ UFW FORWARD –ø—Ä–∞–≤–∏–ª, –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ UFW, —Ñ—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è UFW –ø—Ä–∞–≤–∏–ª. –†–µ—à–µ–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –ø—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ–º UFW.
- **v1.3 (2025-09-30):** –ü–µ—Ä–µ—Ö–æ–¥ —Å host –Ω–∞ bridge network mode, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ IP forwarding –∏ NAT, –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–≤–æ–±–æ–¥–Ω–æ–π Docker –ø–æ–¥—Å–µ—Ç–∏
- **v1.2 (2025-09-29):** –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, —Ä–æ—Ç–∞—Ü–∏—è –∫–ª—é—á–µ–π, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–≤–æ—Ç–∞–º–∏, —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞)
- **v1.1 (2025-09-29):** –î–æ–±–∞–≤–ª–µ–Ω host network mode –¥–ª—è Docker, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å UFW firewall
- **v1.0 (2025-09-26):** –ù–∞—á–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞

### 2. –¶–µ–ª—å –∏ –∑–∞–¥–∞—á–∏

#### 2.1 –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞
–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—â–∏—â–µ–Ω–Ω–æ–≥–æ VPN —Å–µ—Ä–≤–∏—Å–∞ –Ω–∞ –±–∞–∑–µ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ VLESS —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º REALITY –¥–ª—è –æ–±—Ö–æ–¥–∞ DPI –∏ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫, —Å –ø—Ä–æ—Å—Ç—ã–º CLI —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–µ–π –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.

#### 2.2 –û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏
- –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ Xray-core —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π VLESS + REALITY –≤ Docker
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- –û–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ bash —Å–∫—Ä–∏–ø—Ç—ã

### 3. –¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è

- **–û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:** –õ–∏—á–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:** –î–æ 50
- **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —É—Ä–æ–≤–µ–Ω—å:** –°—Ä–µ–¥–Ω–∏–π –æ–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å Linux –∏ Docker
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É:** CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### 4. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

#### 4.1 –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

##### 4.1.1 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ –µ–¥–∏–Ω—ã–π —Å–∫—Ä–∏–ø—Ç `install.sh`
- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–≤–µ–¥–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è X25519 –∫–ª—é—á–µ–π –¥–ª—è REALITY
- –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Xray
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ UFW firewall (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω):
  - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ DEFAULT_FORWARD_POLICY
  - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —è–≤–Ω—ã—Ö FORWARD –ø—Ä–∞–≤–∏–ª –¥–ª—è Docker subnet
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤–∏–ª –¥–ª—è bridge network
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ —Å –¥—Ä—É–≥–∏–º–∏ VPN —Å–µ—Ä–≤–∏—Å–∞–º–∏ (pre-installation check)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

##### 4.1.2 –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è UUID)
- –£–¥–∞–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π:
  - vless:// —Å—Å—ã–ª–∫–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∏–º–ø–æ—Ä—Ç–∞
  - JSON –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
  - QR-–∫–æ–¥—ã 640x640 –ø–∏–∫—Å–µ–ª–µ–π –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

##### 4.1.3 –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ Xray-core
- –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –ü—Ä–æ—Å–º–æ—Ç—Ä –∏ –∞–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ —á–µ—Ä–µ–∑ Docker
- –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

##### 4.1.4 –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –°–∏—Å—Ç–µ–º–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π –≤ —Ç—Ä–∞—Ñ–∏–∫–µ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö IP –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ø–æ—Ä–æ–≥–∞
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö security –æ—Ç—á–µ—Ç–æ–≤
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–ø—ã—Ç–æ–∫ –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–æ–±—ã—Ç–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

##### 4.1.5 –†–æ—Ç–∞—Ü–∏—è –∫–ª—é—á–µ–π –∏ —Å–µ–∫—Ä–µ—Ç–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö X25519 –∫–ª—é—á–µ–π
- –†–æ—Ç–∞—Ü–∏—è shortIds –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥ —Ä–æ—Ç–∞—Ü–∏–µ–π
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç–∏ —Ä–æ—Ç–∞—Ü–∏–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –µ–∂–µ–º–µ—Å—è—á–Ω–æ)
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Ä–æ—Ç–∞—Ü–∏–∏

##### 4.1.6 –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–≤–æ—Ç–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ª–∏–º–∏—Ç–æ–≤ bandwidth –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è –∞–∫–∫–∞—É–Ω—Ç–æ–≤ (expiry date)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –∫–≤–æ—Ç
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–∞–∫—Ç–∏–≤–µ–Ω/–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω/–ø—Ä–æ—Å—Ä–æ—á–µ–Ω)
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ —á–µ—Ä–µ–∑ API
- –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (admin, moderator, user)

#### 4.2 –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (—á—Ç–æ –ù–ï –≤—Ö–æ–¥–∏—Ç –≤ –ø—Ä–æ–µ–∫—Ç)
- –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- REST API
- –ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –¥–∞—à–±–æ—Ä–¥—ã –∏ –º–µ—Ç—Ä–∏–∫–∏ –≤ —Ä–µ–∂–∏–º–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
- Telegram –±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å SIEM —Å–∏—Å—Ç–µ–º–∞–º–∏

### 5. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

#### 5.1 –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- **–û–°:** Linux (Ubuntu 20.04+ / Debian 11+)
- **RAM:** –ú–∏–Ω–∏–º—É–º 512 MB, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 1 GB
- **CPU:** 1 vCPU
- **–î–∏—Å–∫:** 10 GB —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞
- **–°–µ—Ç—å:** –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π IP –∞–¥—Ä–µ—Å, –æ—Ç–∫—Ä—ã—Ç—ã–π –ø–æ—Ä—Ç 443
- **–ë–∞–∑–æ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è:** `/opt/vless/` (—Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞)

#### 5.2 –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è:** Docker 24.x, Docker Compose 2.x
- **VPN –¥–≤–∏–∂–æ–∫:** Xray-core (–ø–æ—Å–ª–µ–¥–Ω—è—è –≤–µ—Ä—Å–∏—è)
- **–°–µ—Ç–µ–≤–æ–π —Ä–µ–∂–∏–º:** Bridge network mode —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π NAT –∏ IP forwarding
- **–°–µ—Ç–µ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–≤–æ–±–æ–¥–Ω–æ–π Docker –ø–æ–¥—Å–µ—Ç–∏ (172.16-254.x.x/16)
- **–ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ IP forwarding, iptables NAT MASQUERADE, UFW FORWARD –ø—Ä–∞–≤–∏–ª –¥–ª—è Docker bridge
- **UFW –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ UFW FORWARD –ø—Ä–∞–≤–∏–ª (`ufw route allow`), —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Docker –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º NAT
- **–°–∫—Ä–∏–ø—Ç—ã:** Bash
- **–ë–∞–∑–æ–≤—ã–µ —É—Ç–∏–ª–∏—Ç—ã:** qrencode, jq, curl, openssl, ufw (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è security:** iptables, netfilter-persistent (–¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª), tcpdump (–¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏), netstat

#### 5.3 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

##### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:
```
vless/                          # –ö–æ—Ä–Ω–µ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ install.sh              # –£—Å—Ç–∞–Ω–æ–≤—â–∏–∫ —Å–∏—Å—Ç–µ–º—ã
‚îÇ   ‚îú‚îÄ‚îÄ user-manager.sh         # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ update.sh               # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Xray-core
‚îÇ   ‚îú‚îÄ‚îÄ backup.sh               # –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ logs.sh                 # –†–∞–±–æ—Ç–∞ —Å –ª–æ–≥–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ colors.sh           # –¶–≤–µ—Ç–Ω–æ–π –≤—ã–≤–æ–¥ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ utils.sh            # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.sh           # –†–∞–±–æ—Ç–∞ —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ network.sh          # –°–µ—Ç–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (IP forwarding, NAT, UFW FORWARD –ø—Ä–∞–≤–∏–ª–∞, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–≤–æ–±–æ–¥–Ω–æ–π –ø–æ–¥—Å–µ—Ç–∏, –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ security.sh         # –§—É–Ω–∫—Ü–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è shortIds, –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–≤–æ—Ç)
‚îÇ   ‚îú‚îÄ‚îÄ monitoring/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ monitor-security.sh # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ security-metrics.sh # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
‚îÇ   ‚îî‚îÄ‚îÄ security/
‚îÇ       ‚îú‚îÄ‚îÄ rotate-keys.sh      # –†–æ—Ç–∞—Ü–∏—è X25519 –∫–ª—é—á–µ–π
‚îÇ       ‚îú‚îÄ‚îÄ rotate-shortids.sh  # –†–æ—Ç–∞—Ü–∏—è shortIds –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ       ‚îú‚îÄ‚îÄ check-user-limits.sh # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–≤–æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ       ‚îî‚îÄ‚îÄ security-check.sh   # –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.yml.tpl  # –®–∞–±–ª–æ–Ω Docker Compose
‚îÇ   ‚îú‚îÄ‚îÄ config.json.tpl         # –®–∞–±–ª–æ–Ω –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Xray
‚îÇ   ‚îú‚îÄ‚îÄ config_with_dns.json.tpl # –®–∞–±–ª–æ–Ω —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º DNS
‚îÇ   ‚îú‚îÄ‚îÄ routing_rules.json      # –ü—Ä–∞–≤–∏–ª–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ —Ç—Ä–∞—Ñ–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ dns_config.json         # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è DNS —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç —É—Ç–µ—á–µ–∫
‚îÇ   ‚îî‚îÄ‚îÄ .env.example            # –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îú‚îÄ‚îÄ README.md               # –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
‚îÇ   ‚îú‚îÄ‚îÄ ADMIN_GUIDE.md          # –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ TROUBLESHOOTING.md      # –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º
‚îÇ   ‚îî‚îÄ‚îÄ SECURITY_GUIDE.md       # –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ .gitignore                  # –ò—Å–∫–ª—é—á–µ–Ω–∏—è Git

##### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–∞–±–æ—á–µ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞ (—Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ):
/opt/vless/                     # –†–∞–±–æ—á–∏–π –∫–∞—Ç–∞–ª–æ–≥ (–ù–ï –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏)
‚îú‚îÄ‚îÄ docker-compose.yml          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Docker Compose
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ config.json             # –†–∞–±–æ—á–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Xray
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ users.json              # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Å –∫–≤–æ—Ç–∞–º–∏)
‚îÇ   ‚îú‚îÄ‚îÄ qr_codes/               # QR –∫–æ–¥—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îî‚îÄ‚îÄ keys/                   # –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –∫–ª—é—á–∏
‚îÇ       ‚îú‚îÄ‚îÄ private.key         # –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á X25519
‚îÇ       ‚îî‚îÄ‚îÄ public.key          # –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á X25519
‚îú‚îÄ‚îÄ backups/                    # –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ [timestamp]/            # –î–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å –¥–∞—Ç–æ–π/–≤—Ä–µ–º–µ–Ω–µ–º
‚îú‚îÄ‚îÄ logs/                       # –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ xray.log               # –û—Å–Ω–æ–≤–Ω–æ–π –ª–æ–≥ Xray
‚îÇ   ‚îú‚îÄ‚îÄ access.log             # –õ–æ–≥ –¥–æ—Å—Ç—É–ø–∞
‚îÇ   ‚îú‚îÄ‚îÄ security/               # –õ–æ–≥–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ anomalies.log      # –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –∞–Ω–æ–º–∞–ª–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ security-report-*.txt # –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –æ—Ç—á–µ—Ç—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ key-rotation.log   # –ò—Å—Ç–æ—Ä–∏—è —Ä–æ—Ç–∞—Ü–∏–π –∫–ª—é—á–µ–π
‚îÇ   ‚îî‚îÄ‚îÄ monitoring/             # –õ–æ–≥–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
‚îú‚îÄ‚îÄ scripts/                    # –ö–æ–ø–∏—è —Å–∫—Ä–∏–ø—Ç–æ–≤ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
‚îî‚îÄ‚îÄ .env                        # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (—Å–æ–∑–¥–∞–µ—Ç—Å—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ)
```

##### –í–∞–∂–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ:
- **–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π** —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ —Å–∫—Ä–∏–ø—Ç—ã, —à–∞–±–ª–æ–Ω—ã –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- **–†–∞–±–æ—á–∏–π –∫–∞—Ç–∞–ª–æ–≥** `/opt/vless/` —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç:
  - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
  - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
  - –õ–æ–≥–∏ –∏ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏
  - –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –∫–ª—é—á–∏
- **–†–∞–±–æ—á–∏–π –∫–∞—Ç–∞–ª–æ–≥ –ù–ï –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –≤–µ—Ä—Å–∏–π**

#### 5.4 –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø—Ä–∞–≤–∞–º –¥–æ—Å—Ç—É–ø–∞

##### –í–ª–∞–¥–µ–ª–µ—Ü —Ñ–∞–π–ª–æ–≤ –∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π:
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:** root –∏–ª–∏ –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, vless)
- **–ì—Ä—É–ø–ø–∞:** docker (–¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ Docker daemon)

##### –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è–º:
```bash
/opt/vless/                     # 755 (rwxr-xr-x)
‚îú‚îÄ‚îÄ config/                     # 750 (rwxr-x---)
‚îú‚îÄ‚îÄ scripts/                    # 750 (rwxr-x---)
‚îÇ   ‚îî‚îÄ‚îÄ lib/                    # 750 (rwxr-x---)
‚îú‚îÄ‚îÄ data/                       # 700 (rwx------)
‚îÇ   ‚îî‚îÄ‚îÄ keys/                   # 700 (rwx------)
‚îú‚îÄ‚îÄ backups/                    # 700 (rwx------)
‚îú‚îÄ‚îÄ logs/                       # 755 (rwxr-xr-x)
‚îî‚îÄ‚îÄ docs/                       # 755 (rwxr-xr-x)
```

##### –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º:
```bash
# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
config/config.json              # 600 (rw-------)
config/config.json.template     # 644 (rw-r--r--)
.env                           # 600 (rw-------)

# –°–∫—Ä–∏–ø—Ç—ã
scripts/*.sh                    # 750 (rwxr-x---)
scripts/lib/*.sh               # 640 (rw-r-----)

# –î–∞–Ω–Ω—ã–µ –∏ –∫–ª—é—á–∏
data/users.json                # 600 (rw-------)
data/keys/*                    # 600 (rw-------)

# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
docs/*.md                      # 644 (rw-r--r--)

# Docker —Ñ–∞–π–ª—ã
docker-compose.yml             # 640 (rw-r-----)
```

##### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è Docker:
- Docker daemon –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –æ—Ç root
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –∑–∞–ø—É—Å–∫–∞—é—â–∏–π —Å–∫—Ä–∏–ø—Ç—ã, –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ –≥—Ä—É–ø–ø–µ docker
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä xray-server —Ä–∞–±–æ—Ç–∞–µ—Ç —Å UID 1000 –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- –ú–æ–Ω—Ç–∏—Ä—É–µ–º—ã–µ volumes –Ω–∞—Å–ª–µ–¥—É—é—Ç –ø—Ä–∞–≤–∞ –æ—Ç —Ö–æ—Å—Ç-—Å–∏—Å—Ç–µ–º—ã
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è bridge network mode —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º port mapping
- IP forwarding –∏ NAT –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ
- UFW –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ—Ç—Å—è –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Docker bridge network:
  - Explicit FORWARD –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è Docker subnet
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ–º UFW
  - Graceful degradation –µ—Å–ª–∏ UFW –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω/–Ω–µ –∞–∫—Ç–∏–≤–µ–Ω
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ cleanup —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏—é remove_ufw_docker_rules()

##### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–∞–≤:
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∞–≤ –ø—Ä–∏ –∏–Ω—Å—Ç–∞–ª–ª—è—Ü–∏–∏
sudo mkdir -p /opt/vless/{config,scripts/lib,data/keys,backups,logs}
sudo chown -R root:docker /opt/vless
sudo chmod 755 /opt/vless
sudo chmod 750 /opt/vless/{config,scripts}
sudo chmod 700 /opt/vless/{data,data/keys,backups}
sudo chmod 755 /opt/vless/logs

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∞–≤ –Ω–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã
sudo chmod 600 /opt/vless/config/config.json
sudo chmod 600 /opt/vless/data/users.json
sudo chmod 600 /opt/vless/data/keys/*
sudo chmod 600 /opt/vless/.env
```

##### –†–∞–±–æ—Ç–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤ —Å —Ä–∞–±–æ—á–∏–º –∫–∞—Ç–∞–ª–æ–≥–æ–º:
–í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–∞–±–æ—á–µ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞:
```bash
# –í –Ω–∞—á–∞–ª–µ –∫–∞–∂–¥–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞
VLESS_HOME="${VLESS_HOME:-/opt/vless}"
cd "$VLESS_HOME" || exit 1

# –ü—É—Ç–∏ –∫ –≤–∞–∂–Ω—ã–º —Ñ–∞–π–ª–∞–º –∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è–º
CONFIG_FILE="$VLESS_HOME/config/config.json"
USERS_FILE="$VLESS_HOME/data/users.json"
KEYS_DIR="$VLESS_HOME/data/keys"
BACKUP_DIR="$VLESS_HOME/backups"
LOGS_DIR="$VLESS_HOME/logs"
```

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –∏–∑ –ª—é–±–æ–≥–æ –º–µ—Å—Ç–∞ –≤ —Å–∏—Å—Ç–µ–º–µ
- –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ä–∞–±–æ—á–∏–π –∫–∞—Ç–∞–ª–æ–≥ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –û–±–µ—Å–ø–µ—á–∏—Ç—å –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –ø—É—Ç–µ–π –≤–æ –≤—Å–µ—Ö —Å–∫—Ä–∏–ø—Ç–∞—Ö

### 6. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

#### 6.1 –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

##### Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:
- **xray-server:** –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å Xray-core
  - Image: teddysun/xray:latest
  - –ü–æ—Ä—Ç: 443 (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π), –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π –≤–Ω–µ—à–Ω–∏–π –ø–æ—Ä—Ç —á–µ—Ä–µ–∑ SERVER_PORT
  - Network mode: bridge (vless-network)
  - Subnet: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∏–∑ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ 172.16-254.x.x/16
  - Port mapping: {{SERVER_PORT}}:443
  - Volumes:
    - /opt/vless/config:/etc/xray:ro
    - /opt/vless/logs:/var/log/xray
    - /opt/vless/data:/data:ro

##### Bash —Å–∫—Ä–∏–ø—Ç—ã:
1. **install.sh** - –ú–∞—Å—Ç–µ—Ä —É—Å—Ç–∞–Ω–æ–≤–∫–∏
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π
   - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker –∏ Docker Compose
   - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤–≤–æ–¥ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
     * SERVER_IP - –∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–Ω–µ—à–Ω–µ–≥–æ IP —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º/—Ä—É—á–Ω—ã–º –≤–≤–æ–¥–æ–º
     * SERVER_NAME - —Ü–µ–ª–µ–≤–æ–π –¥–æ–º–µ–Ω –¥–ª—è REALITY (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é speed.cloudflare.com)
     * SHORT_ID - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
     * ADMIN_EMAIL - email –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–≤–µ–¥–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:
     * –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ IP –∞–¥—Ä–µ—Å–∞ (–µ—Å–ª–∏ –≤–≤–µ–¥–µ–Ω –≤—Ä—É—á–Ω—É—é)
     * –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ü–µ–ª–µ–≤–æ–≥–æ –¥–æ–º–µ–Ω–∞
     * –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è SHORT_ID (8 hex —Å–∏–º–≤–æ–ª–æ–≤)
     * –í–∞–ª–∏–¥–∞—Ü–∏—è email (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω)
   - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è firewall:
     * –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ UFW
     * –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –ø–æ—Ä—Ç–∞ 443
     * –ù–∞—Å—Ç—Ä–æ–π–∫–∞ DEFAULT_FORWARD_POLICY="ACCEPT"
     * –î–æ–±–∞–≤–ª–µ–Ω–∏–µ UFW FORWARD –ø—Ä–∞–≤–∏–ª –¥–ª—è Docker subnet (ufw route allow)
     * –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ —Å –¥—Ä—É–≥–∏–º–∏ VPN —Å–µ—Ä–≤–∏—Å–∞–º–∏
     * Graceful degradation –µ—Å–ª–∏ UFW –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
   - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤–≤–µ–¥–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ–º
   - –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –≤ /opt/vless/scripts/
   - –°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞–±–æ—á–∏—Ö –∫–∞—Ç–∞–ª–æ–≥–æ–≤ –≤ /opt/vless/
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è X25519 –∫–ª—é—á–µ–π
   - –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ —à–∞–±–ª–æ–Ω–æ–≤ —Å –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ /opt/vless/.env
   - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (600 –¥–ª—è .env)
   - –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫–∏—Ö —Å—Å—ã–ª–æ–∫ –≤ /usr/local/bin/

2. **user-manager.sh** - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
   - –†–∞–±–æ—Ç–∞–µ—Ç —Å –¥–∞–Ω–Ω—ã–º–∏ –≤ /opt/vless/data/
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
     * –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è UUID
     * –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ Short ID (8 hex —Å–∏–º–≤–æ–ª–æ–≤)
   - –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - –≠–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
     * vless:// —Å—Å—ã–ª–∫–∞
     * JSON –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
     * QR-–∫–æ–¥ 640x640 –ø–∏–∫—Å–µ–ª–µ–π (PNG —Ñ–æ—Ä–º–∞—Ç)
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ config.json

3. **update.sh** - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Xray
   - –†–∞–±–æ—Ç–∞–µ—Ç —Å /opt/vless/ –∫–∞–∫ –±–∞–∑–æ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–µ–π
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏
   - –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–µ—Ä–µ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π

4. **backup.sh** - –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
   - –°–æ–∑–¥–∞–Ω–∏–µ timestamped –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –≤ /opt/vless/backups/
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ /opt/vless/config/
   - –≠–∫—Å–ø–æ—Ä—Ç —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ /opt/vless/data/
   - –ê—Ä—Ö–∏–≤–∞—Ü–∏—è –∫–ª—é—á–µ–π –∏–∑ /opt/vless/data/keys/
   - –†–æ—Ç–∞—Ü–∏—è —Å—Ç–∞—Ä—ã—Ö –±—ç–∫–∞–ø–æ–≤ (—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 30)

5. **logs.sh** - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
   - –ß—Ç–µ–Ω–∏–µ –ª–æ–≥–æ–≤ –∏–∑ /opt/vless/logs/
   - –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
   - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —É—Ä–æ–≤–Ω—é –≤–∞–∂–Ω–æ—Å—Ç–∏
   - –≠–∫—Å–ø–æ—Ä—Ç –ª–æ–≥–æ–≤ —Å –∞—Ä—Ö–∏–≤–∞—Ü–∏–µ–π
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å docker logs –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

6. **monitor-security.sh** - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
   - –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π –≤ —Ç—Ä–∞—Ñ–∏–∫–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö IP —á–µ—Ä–µ–∑ UFW
   - –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
   - –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ brute-force –∞—Ç–∞–∫
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö security —Å–æ–±—ã—Ç–∏–π

7. **security-metrics.sh** - –û—Ç—á–µ—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö security –æ—Ç—á–µ—Ç–æ–≤
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö IP
   - –ê–Ω–∞–ª–∏–∑ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å cron –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

8. **rotate-keys.sh** - –†–æ—Ç–∞—Ü–∏—è –∫–ª—é—á–µ–π
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö X25519 –∫–ª—é—á–µ–π
   - –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ config.json –∏ .env —Ñ–∞–π–ª–æ–≤
   - –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Ä–æ—Ç–∞—Ü–∏–∏
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–ª–∞–Ω–æ–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —á–µ—Ä–µ–∑ cron

9. **check-user-limits.sh** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–≤–æ—Ç–∞–º–∏
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ bandwidth –∫–≤–æ—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –ö–æ–Ω—Ç—Ä–æ–ª—å —Å—Ä–æ–∫–æ–≤ –¥–µ–π—Å—Ç–≤–∏—è –∞–∫–∫–∞—É–Ω—Ç–æ–≤ (expiry date)
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–æ–≤
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ Xray API
   - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–∏ –∫ –ª–∏–º–∏—Ç–∞–º

#### 6.2 –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è REALITY

##### –°–µ—Ä–≤–µ—Ä–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (config.json):
```json
{
  "log": {
    "loglevel": "warning"
  },
  "inbounds": [
    {
      "port": 443,
      "protocol": "vless",
      "settings": {
        "clients": [
          {
            "id": "{{ UUID }}",
            "flow": "xtls-rprx-vision"
          }
        ],
        "decryption": "none"
      },
      "streamSettings": {
        "network": "tcp",
        "security": "reality",
        "realitySettings": {
          "dest": "{{ REALITY_DEST }}",
          "serverNames": [
            "{{ REALITY_SERVER_NAME }}",
            "www.microsoft.com",
            "www.apple.com",
            "www.cloudflare.com"
          ],
          "privateKey": "{{ PRIVATE_KEY }}",
          "shortIds": [
            "",
            "{{ SHORT_ID }}"
          ],
          "minClientVer": "1.8.0",
          "maxTimeDiff": 90
        }
      },
      "sniffing": {
        "enabled": true,
        "destOverride": [
          "http",
          "tls"
        ]
      }
    }
  ],
  "outbounds": [
    {
      "protocol": "freedom",
      "tag": "direct"
    },
    {
      "protocol": "blackhole",
      "tag": "block"
    }
  ]
}
```

##### –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–ø—Ä–∏–º–µ—Ä –¥–ª—è v2rayNG/Nekobox):
```json
{
  "log": {
    "loglevel": "warning"
  },
  "inbounds": [
    {
      "port": 10808,
      "listen": "127.0.0.1",
      "protocol": "socks",
      "settings": {
        "udp": true
      }
    }
  ],
  "outbounds": [
    {
      "protocol": "vless",
      "settings": {
        "vnext": [
          {
            "address": "{{ SERVER_IP }}",
            "port": 443,
            "users": [
              {
                "id": "{{ UUID }}",
                "encryption": "none",
                "flow": "xtls-rprx-vision"
              }
            ]
          }
        ]
      },
      "streamSettings": {
        "network": "tcp",
        "security": "reality",
        "realitySettings": {
          "fingerprint": "chrome",
          "serverName": "{{ REALITY_SERVER_NAME }}",
          "publicKey": "{{ PUBLIC_KEY }}",
          "shortId": "{{ SHORT_ID }}",
          "spiderX": ""
        }
      }
    }
  ]
}
```

##### –ö–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
- **flow: "xtls-rprx-vision"** - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –¥–ª—è REALITY, –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **decryption: "none"** - –¥–ª—è VLESS –≤—Å–µ–≥–¥–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å "none"
- **sniffing** - –≤–∫–ª—é—á–µ–Ω–æ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–∞ —Ç—Ä–∞—Ñ–∏–∫–∞ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏
- **fingerprint: "chrome"** - —ç–º—É–ª—è—Ü–∏—è TLS –æ—Ç–ø–µ—á–∞—Ç–∫–∞ –±—Ä–∞—É–∑–µ—Ä–∞ Chrome (–º–æ–∂–Ω–æ —Ç–∞–∫–∂–µ firefox, safari, ios, android)
- **shortIds** - –º–∞—Å—Å–∏–≤ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤, –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ "" –æ–∑–Ω–∞—á–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –±–µ–∑ shortId
- **spiderX** - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

##### –§–æ—Ä–º–∞—Ç vless:// —Å—Å—ã–ª–∫–∏ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤:
```
vless://{{ UUID }}@{{ SERVER_IP }}:443?encryption=none&flow=xtls-rprx-vision&security=reality&sni={{ REALITY_SERVER_NAME }}&fp=chrome&pbk={{ PUBLIC_KEY }}&sid={{ SHORT_ID }}&type=tcp&headerType=none#VLESS-REALITY
```

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Å—ã–ª–∫–∏:
- **encryption=none** - –±–µ–∑ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è VLESS)
- **flow=xtls-rprx-vision** - —Ç–∏–ø –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- **security=reality** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ REALITY
- **sni** - –∏–º—è —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è SNI
- **fp** - fingerprint –±—Ä–∞—É–∑–µ—Ä–∞
- **pbk** - –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á —Å–µ—Ä–≤–µ—Ä–∞ (base64)
- **sid** - short ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **type=tcp** - —Ç–∏–ø —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
- **#VLESS-REALITY** - –∏–º—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –∫–ª–∏–µ–Ω—Ç–µ

#### 6.3 –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)

##### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
```bash
# –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞
SERVER_IP=          # –í–Ω–µ—à–Ω–∏–π IP –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞ (–∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º)
SERVER_PORT=443     # –ü–æ—Ä—Ç –¥–ª—è –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 443)

# REALITY –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
REALITY_DEST=speed.cloudflare.com:443    # –¶–µ–ª–µ–≤–æ–π —Å–∞–π—Ç –¥–ª—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏
REALITY_SERVER_NAME=speed.cloudflare.com # –ò–º—è —Å–µ—Ä–≤–µ—Ä–∞ –∏–∑ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

# –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
ADMIN_SHORT_ID=     # –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
ADMIN_EMAIL=        # Email –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

# –°–∏—Å—Ç–µ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
COMPOSE_PROJECT_NAME=vless-reality
TZ=UTC              # –í—Ä–µ–º–µ–Ω–Ω–∞—è –∑–æ–Ω–∞
```

##### –ü—Ä–æ—Ü–µ—Å—Å –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ:
1. **SERVER_IP** - –∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ curl ifconfig.me, –∑–∞—Ç–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∏–ª–∏ —Ä—É—á–Ω–æ–π –≤–≤–æ–¥
2. **SERVER_PORT** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ (1-65535) –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
3. **REALITY_DEST** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ü–µ–ª–µ–≤–æ–≥–æ —Å–∞–π—Ç–∞ —á–µ—Ä–µ–∑ curl
4. **ADMIN_SHORT_ID** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è 8 hex —Å–∏–º–≤–æ–ª–æ–≤ —á–µ—Ä–µ–∑ openssl rand -hex 4
5. **ADMIN_EMAIL** - –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ email —á–µ—Ä–µ–∑ regex (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω)

##### –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤–≤–æ–¥:
```bash
# –ü—Ä–∏–º–µ—Ä –¥–∏–∞–ª–æ–≥–∞ —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞
========================================
VLESS + REALITY Configuration
========================================

[1/4] Detecting server IP address...
‚Üí Detected IP: 192.168.1.100
Is this correct? [Y/n]: Y
‚úì IP address confirmed

[2/4] Enter target domain for REALITY [speed.cloudflare.com]:
> (–Ω–∞–∂–∞—Ç–∏–µ Enter –¥–ª—è –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
‚úì Using default: speed.cloudflare.com
‚úì Domain is accessible

[3/4] Generating admin Short ID...
‚Üí Generated ID: a1b2c3d4
‚úì Admin Short ID created

[4/4] Enter admin email (optional, press Enter to skip):
> admin@example.com
‚úì Valid email format

Confirm configuration:
----------------------------------------
Server IP:        192.168.1.100
Server Port:      443
REALITY Target:   speed.cloudflare.com
Admin Short ID:   a1b2c3d4 (–∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω)
Admin Email:      admin@example.com
----------------------------------------
Is this correct? [Y/n]: Y

‚úì Configuration saved to /opt/vless/.env
‚úì File permissions set to 600
```

### 7. –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

#### –≠—Ç–∞–ø 1: –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (2-3 –¥–Ω—è) ‚úÖ **–í–´–ü–û–õ–ù–ï–ù**
- [x] –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- [x] –ù–∞–ø–∏—Å–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤ (docker-compose.yml.tpl, config.json.tpl, .env.example)
- [x] –°–∫—Ä–∏–ø—Ç install.sh —Å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º –≤–≤–æ–¥–æ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- [x] –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤–≤–æ–¥–∏–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- [x] –°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞–±–æ—á–∏—Ö –∫–∞—Ç–∞–ª–æ–≥–æ–≤ –≤ /opt/vless/
- [x] –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –≤ /opt/vless/
- [x] –ì–µ–Ω–µ—Ä–∞—Ü–∏—è .env —Ñ–∞–π–ª–∞ —Å –≤–≤–µ–¥–µ–Ω–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
- [x] –ì–µ–Ω–µ—Ä–∞—Ü–∏—è X25519 –∫–ª—é—á–µ–π
- [x] –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
- [x] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

#### –≠—Ç–∞–ø 2: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (2-3 –¥–Ω—è) ‚úÖ **–í–´–ü–û–õ–ù–ï–ù**
- [x] –°–∫—Ä–∏–ø—Ç user-manager.sh
- [x] –§—É–Ω–∫—Ü–∏–∏ CRUD –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- [x] –ì–µ–Ω–µ—Ä–∞—Ü–∏—è UUID
- [x] –°–æ–∑–¥–∞–Ω–∏–µ vless:// —Å—Å—ã–ª–æ–∫
- [x] –ì–µ–Ω–µ—Ä–∞—Ü–∏—è QR-–∫–æ–¥–æ–≤ 640x640 –ø–∏–∫—Å–µ–ª–µ–π
- [x] –°–∏—Å—Ç–µ–º–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ users.json

#### –≠—Ç–∞–ø 3: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è (2 –¥–Ω—è) ‚úÖ **–í–´–ü–û–õ–ù–ï–ù**
- [x] –°–∫—Ä–∏–ø—Ç update.sh
- [x] –°–∫—Ä–∏–ø—Ç backup.sh
- [x] –°–∫—Ä–∏–ø—Ç logs.sh
- [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ cron –∑–∞–¥–∞—á (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ –∂–µ–ª–∞–Ω–∏—é –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞)
- [x] –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

#### –≠—Ç–∞–ø 4: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (1-2 –¥–Ω—è) ‚úÖ **–í–´–ü–û–õ–ù–ï–ù**
- [x] README.md —Å –±—ã—Å—Ç—Ä—ã–º —Å—Ç–∞—Ä—Ç–æ–º
- [x] ADMIN_GUIDE.md
- [x] TROUBLESHOOTING.md
- [x] –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (–≤–∫–ª—é—á–µ–Ω—ã –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é)
- [x] FAQ (–≤–∫–ª—é—á–µ–Ω –≤ TROUBLESHOOTING.md)

#### –≠—Ç–∞–ø 5: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (3-5 –¥–Ω–µ–π) üü° **–ü–õ–ê–ù–ò–†–£–ï–¢–°–Ø**
- [ ] –£—Å–∏–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ REALITY:
  - [ ] –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö serverNames –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
  - [ ] –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ shortIds –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  - [ ] –î–æ–±–∞–≤–ª–µ–Ω–∏–µ minClientVer –∏ maxTimeDiff –≤ realitySettings
  - [ ] –°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ destination —Å–µ—Ä–≤–µ—Ä–æ–≤ (check-destination.sh)
- [ ] –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞:
  - [ ] –°–æ–∑–¥–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞ routing_rules.json —Å –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏
  - [ ] –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ BitTorrent, —Ä–µ–∫–ª–∞–º—ã, Win telemetry
  - [ ] –ì–µ–æ–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –æ–ø–∞—Å–Ω—ã—Ö —Å—Ç—Ä–∞–Ω –∏ private —Å–µ—Ç–µ–π
  - [ ] –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –æ–ø–∞—Å–Ω—ã—Ö –ø–æ—Ä—Ç–æ–≤ (25, 110, 135, 139, 445)
- [ ] –ó–∞—â–∏—Ç–∞ –æ—Ç DNS —É—Ç–µ—á–µ–∫:
  - [ ] –°–æ–∑–¥–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞ dns_config.json
  - [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ DNS —Å expectIPs –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
  - [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ config_with_dns.json.tpl
- [ ] Fallback –º–µ—Ö–∞–Ω–∏–∑–º—ã:
  - [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã—Ö fallbacks –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
  - [ ] –°–∫—Ä–∏–ø—Ç setup-fake-site.sh –¥–ª—è fake –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞
  - [ ] Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è nginx fake-site

#### –≠—Ç–∞–ø 6: –í–∞–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (3-4 –¥–Ω—è) üü° **–ü–õ–ê–ù–ò–†–£–ï–¢–°–Ø**
- [ ] –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:
  - [ ] –°–∫—Ä–∏–ø—Ç anomaly-detection.sh –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π
  - [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —á–µ—Ä–µ–∑ UFW –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ø–æ—Ä–æ–≥–∞
  - [ ] –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ port scanning –∏ brute-force
  - [ ] –°–∫—Ä–∏–ø—Ç security-metrics.sh –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –æ—Ç—á–µ—Ç–æ–≤
  - [ ] –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π, —Ç–æ–ø IP, –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–æ—Ç–∞—Ü–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤:
  - [ ] –°–∫—Ä–∏–ø—Ç rotate-all-keys.sh –¥–ª—è –ø–æ–ª–Ω–æ–π —Ä–æ—Ç–∞—Ü–∏–∏ X25519
  - [ ] –§—É–Ω–∫—Ü–∏—è rotate_shortids() –¥–ª—è —Ä–æ—Ç–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö shortIds
  - [ ] –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ backup –ø–µ—Ä–µ–¥ —Ä–æ—Ç–∞—Ü–∏–µ–π
  - [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ cron –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –µ–∂–µ–º–µ—Å—è—á–Ω–æ–π —Ä–æ—Ç–∞—Ü–∏–∏
- [ ] –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–≤–æ—Ç–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
  - [ ] –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ users.json —Å –ø–æ–ª—è–º–∏ bandwidth_limit_gb, expiry_date, blocked
  - [ ] –§—É–Ω–∫—Ü–∏—è create_user_advanced() —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∫–≤–æ—Ç
  - [ ] –°–∫—Ä–∏–ø—Ç check-user-limits.sh –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
  - [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Xray Stats API –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞
  - [ ] –§—É–Ω–∫—Ü–∏—è block_user() –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

#### –≠—Ç–∞–ø 7: –ñ–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, 2-3 –¥–Ω—è) üü¢ **–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û**
- [ ] –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:
  - [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ sockopt (tcpFastOpen, tcpNoDelay, tcpKeepAlive)
  - [ ] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è policy —Å buffer —Ä–∞–∑–º–µ—Ä–∞–º–∏ –∏ –ª–∏–º–∏—Ç–∞–º–∏
  - [ ] –í–∫–ª—é—á–µ–Ω–∏–µ statsUser –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏:
  - [ ] –°–∫—Ä–∏–ø—Ç webhook-notifications.sh –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
  - [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ security alerts
  - [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ WEBHOOK_URL –≤ .env —Ñ–∞–π–ª–µ
- [ ] –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
  - [ ] –°–æ–∑–¥–∞–Ω–∏–µ SECURITY_GUIDE.md —Å —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ–º –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
  - [ ] –ß–µ–∫-–ª–∏—Å—Ç –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –ø–æ —Ñ–∞–∑–∞–º
  - [ ] –ü—Ä–æ—Ü–µ–¥—É—Ä—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã

### 8. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

#### 8.1 –ë–∞–∑–æ–≤—ã–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ REALITY –¥–ª—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏ —Ç—Ä–∞—Ñ–∏–∫–∞
- –•—Ä–∞–Ω–µ–Ω–∏–µ –∫–ª—é—á–µ–π —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏ (600)
- Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤ host network mode (–¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ —Å–µ—Ç–∏)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ firewall –ø—Ä–∞–≤–∏–ª
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ—Ä—Ç–æ–≤ –∫—Ä–æ–º–µ 443
- –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ Xray-core
- –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö volumes –≤ —Ä–µ–∂–∏–º–µ read-only (:ro)
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏
- –í—Å–µ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ /opt/vless —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º –¥–æ—Å—Ç—É–ø–æ–º

#### 8.2 –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ üî¥

##### 8.2.1 –£—Å–∏–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ REALITY
**–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ destination —Å–µ—Ä–≤–µ—Ä—ã:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö serverNames –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç–∏ —Ç—Ä–∞—Ñ–∏–∫–∞
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –¥–æ–º–µ–Ω—ã: microsoft.com, apple.com, cloudflare.com, github.com
- –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≤—ã–±–æ—Ä–∞: TLSv1.3, HTTP/2, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤, —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å 24/7

**–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ shortIds:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö shortIds –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è —Ä–æ—Ç–∞—Ü–∏—è shortIds (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –µ–∂–µ–º–µ—Å—è—á–Ω–æ)
- –§—É–Ω–∫—Ü–∏—è `generate_user_shortid()` –≤ scripts/lib/security.sh
- –°–æ–∑–¥–∞–Ω–∏–µ –≤–∞—Ä–∏–∞—Ü–∏–π shortIds —Ä–∞–∑–Ω–æ–π –¥–ª–∏–Ω—ã (2, 4, 6, 8 —Å–∏–º–≤–æ–ª–æ–≤)

**–ö–æ–Ω—Ç—Ä–æ–ª—å –≤–µ—Ä—Å–∏–π –∫–ª–∏–µ–Ω—Ç–æ–≤:**
- –ü–∞—Ä–∞–º–µ—Ç—Ä `minClientVer: "1.8.0"` - –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è Xray –∫–ª–∏–µ–Ω—Ç–∞
- –ü–∞—Ä–∞–º–µ—Ç—Ä `maxTimeDiff: 90` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ –≤—Ä–µ–º–µ–Ω–∏ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å –∏–∑–≤–µ—Å—Ç–Ω—ã–º–∏ —É—è–∑–≤–∏–º–æ—Å—Ç—è–º–∏

##### 8.2.2 –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞
**–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏:**
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ BitTorrent
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ä–µ–∫–ª–∞–º—ã (geosite:category-ads-all)
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ Windows telemetry (geosite:win-spy, win-update)
- –ì–µ–æ–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –æ–ø–∞—Å–Ω—ã—Ö IP –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ (geoip:private, geoip:cn, geoip:ru, –∏ –¥—Ä.)
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –æ–ø–∞—Å–Ω—ã—Ö –ø–æ—Ä—Ç–æ–≤: 25 (SMTP), 110 (POP3), 135 (RPC), 139/445 (SMB)

**–ó–∞—â–∏—Ç–∞ –æ—Ç DNS —É—Ç–µ—á–µ–∫:**
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è DNS —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π —á–µ—Ä–µ–∑ expectIPs
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–∞–¥–µ–∂–Ω—ã—Ö DNS: Cloudflare (1.1.1.1), Google (8.8.8.8)
- –ü–∞—Ä–∞–º–µ—Ç—Ä `queryStrategy: "UseIPv4"` –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è IPv6 —É—Ç–µ—á–µ–∫
- –û—Ç–∫–ª—é—á–µ–Ω–∏–µ fallback –Ω–∞ —Å–∏—Å—Ç–µ–º–Ω—ã–π DNS

##### 8.2.3 Fallback –º–µ—Ö–∞–Ω–∏–∑–º—ã –∑–∞—â–∏—Ç—ã
**–ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π fallback:**
- Fallback –Ω–∞ —Ü–µ–ª–µ–≤–æ–π REALITY –¥–æ–º–µ–Ω –ø—Ä–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö
- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π fallback –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π fake –≤–µ–±-—Å–µ—Ä–≤–µ—Ä
- WebSocket fallback –¥–ª—è –æ–±—Ö–æ–¥–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤

**Fake –≤–µ–±-—Å–µ—Ä–≤–µ—Ä:**
- Nginx –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–∞ –ø–æ—Ä—Ç—É 127.0.0.1:8080
- –ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ "Under Construction"
- –ò–º–∏—Ç–∞—Ü–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö endpoints (/api/, /static/)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ docker-compose.fake.yml

#### 8.3 –í–∞–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ üü°

##### 8.3.1 –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
**–°–∏—Å—Ç–µ–º–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π:**
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤ Xray –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ (tail -F)
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ port scanning –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ø–æ—Ä–æ–≥–∞ –ø–æ–ø—ã—Ç–æ–∫ (>10 –∑–∞ 5 –º–∏–Ω—É—Ç)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö IP —á–µ—Ä–µ–∑ UFW
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ brute-force –∞—Ç–∞–∫ –ø–æ authentication failures
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö user-agents (bot, crawler, scanner, nmap, nikto)

**–ú–µ—Ç—Ä–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
- –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ security –æ—Ç—á–µ—Ç—ã (security-report-YYYYMMDD.txt)
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π: –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ, —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ IP, —Ç–æ–ø-10 IP –∞–¥—Ä–µ—Å–æ–≤
- –ê–Ω–∞–ª–∏–∑ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π (rejected connections)
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ UFW firewall –ø—Ä–∞–≤–∏–ª
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ (md5sum)

##### 8.3.2 –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–æ—Ç–∞—Ü–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤
**–ü–æ–ª–Ω–∞—è —Ä–æ—Ç–∞—Ü–∏—è –∫–ª—é—á–µ–π:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö X25519 –∫–ª—é—á–µ–π
- –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥ —Ä–æ—Ç–∞—Ü–∏–µ–π (backup —Å timestamp)
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ config.json –∏ .env —Ñ–∞–π–ª–æ–≤
- –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞ —á–µ—Ä–µ–∑ docker-compose
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Ä–æ—Ç–∞—Ü–∏–∏

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ä–æ—Ç–∞—Ü–∏–∏:**
- Cron job –¥–ª—è –µ–∂–µ–º–µ—Å—è—á–Ω–æ–π —Ä–æ—Ç–∞—Ü–∏–∏: `0 3 1 * *`
- –§—É–Ω–∫—Ü–∏—è `setup_auto_rotation()` –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ notify-users.sh

##### 8.3.3 –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º –∏ –∫–≤–æ—Ç–∞–º–∏
**–†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏:**
- –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞: admin, moderator, user
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ bandwidth –ª–∏–º–∏—Ç–æ–≤ –≤ GB –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è –∞–∫–∫–∞—É–Ω—Ç–æ–≤ (expiry_date)
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ —á–µ—Ä–µ–∑ Xray Stats API

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–≤–æ—Ç –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ bandwidth_limit_gb
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∏—Å—Ç–µ–∫—à–∏—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ (–ø—Ä–æ–≤–µ—Ä–∫–∞ expiry_date)
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏: bandwidth_used_gb, last_seen, total_connections
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ cron (–∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –∫–≤–æ—Ç–∞–º–∏:**
```json
{
  "name": "username",
  "uuid": "uuid-here",
  "short_ids": ["a1b2c3d4", "a1b2c3", "a1b2"],
  "access_level": "user",
  "bandwidth_limit_gb": 100,
  "bandwidth_used_gb": 0,
  "expiry_date": "2025-10-29",
  "created_at": "2025-09-29T12:00:00Z",
  "last_seen": null,
  "total_connections": 0,
  "blocked": false
}
```

#### 8.4 –ñ–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ üü¢

##### 8.4.1 –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
**–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ–∫–µ—Ç–æ–≤:**
- `tcpFastOpen: true` - —É—Å–∫–æ—Ä–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ TCP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- `tcpNoDelay: true` - –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ Nagle –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è –∑–∞–¥–µ—Ä–∂–µ–∫
- `tcpKeepAliveInterval: 30` - –∏–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- `tcpKeepAliveIdle: 30` - –≤—Ä–µ–º—è –¥–æ –Ω–∞—á–∞–ª–∞ keepalive –ø—Ä–æ–≤–µ—Ä–æ–∫

**–ë—É—Ñ–µ—Ä—ã –∏ –ª–∏–º–∏—Ç—ã –ø–æ–ª–∏—Ç–∏–∫:**
- `handshake: 4` —Å–µ–∫—É–Ω–¥—ã - —Ç–∞–π–º–∞—É—Ç —Ä—É–∫–æ–ø–æ–∂–∞—Ç–∏—è
- `connIdle: 300` —Å–µ–∫—É–Ω–¥ - —Ç–∞–π–º–∞—É—Ç idle —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- `bufferSize: 512` KB - —Ä–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞ –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –í–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏: `statsUserUplink/Downlink: true`

##### 8.4.2 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏
**Webhook —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:**
- –û—Ç–ø—Ä–∞–≤–∫–∞ security alerts –Ω–∞ –≤–Ω–µ—à–Ω–∏–π webhook (Discord, Slack, Telegram)
- –¢–∏–ø—ã —Å–æ–±—ã—Ç–∏–π: security_alert, user_blocked, key_rotation
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ WEBHOOK_URL –≤ .env —Ñ–∞–π–ª–µ
- –°–∫—Ä–∏–ø—Ç webhook-notifications.sh –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏

**–§–æ—Ä–º–∞—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:**
```json
{
  "event": "security_alert",
  "message": "Multiple failed authentication attempts detected",
  "timestamp": "2025-09-29T12:00:00Z",
  "server": "hostname",
  "service": "vless-reality"
}
```

#### 8.5 –ß–µ–∫-–ª–∏—Å—Ç –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

**–§–∞–∑–∞ 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è (–î–µ–Ω—å 1)**
- [ ] –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- [ ] –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö serverNames –≤ config.json
- [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ minClientVer –∏ maxTimeDiff –≤ realitySettings
- [ ] –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –ø—Ä–∞–≤–∏–ª –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (BitTorrent, ads)
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

**–§–∞–∑–∞ 2: –í–∞–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (–î–µ–Ω—å 2-3)**
- [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ (routing_rules.json)
- [ ] –í–Ω–µ–¥—Ä–µ–Ω–∏–µ DNS –∑–∞—â–∏—Ç—ã (dns_config.json)
- [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ fallback –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤
- [ ] –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (anomaly-detection.sh –≤ —Ñ–æ–Ω–µ)
- [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö security –æ—Ç—á–µ—Ç–æ–≤

**–§–∞–∑–∞ 3: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è (–î–µ–Ω—å 4-5)**
- [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ä–æ—Ç–∞—Ü–∏–∏ –∫–ª—é—á–µ–π (cron)
- [ ] –í–Ω–µ–¥—Ä–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∫–≤–æ—Ç (—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ users.json)
- [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (webhook –µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è)
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–π

**–§–∞–∑–∞ 4: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–î–µ–Ω—å 6-7)**
- [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ TCP –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π (sockopt)
- [ ] –¢—é–Ω–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (policy buffers)
- [ ] –§–∏–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- [ ] –û–±—É—á–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

#### 8.6 –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
- –í—ã–±–æ—Ä —Ü–µ–ª–µ–≤–æ–≥–æ —Å–∞–π—Ç–∞ –≤–Ω–µ —é—Ä–∏—Å–¥–∏–∫—Ü–∏–∏ —Å—Ç—Ä–∞–Ω—ã
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–ª–æ–∂–Ω—ã—Ö shortIds —Å —Ä–æ—Ç–∞—Ü–∏–µ–π
- –†–µ–≥—É–ª—è—Ä–Ω–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —á–µ—Ä–µ–∑ cron)
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –∞–Ω–æ–º–∞–ª–∏–π (–µ–∂–µ–¥–Ω–µ–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—á–µ—Ç–æ–≤)
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Xray-core –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏–π
- –†–µ–≥—É–ª—è—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª firewall –∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö IP
- –ê—É–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ –∫–≤–æ—Ç (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤)

### 9. –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

1. **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
   - –£—Å–ø–µ—à–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞ –æ–¥–∏–Ω –∑–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞
   - –†–∞–±–æ—Ç–∞—é—â–µ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤
   - –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –ø—Ä–∏ 50 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö

2. **–£–¥–æ–±—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
   - –ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ–µ CLI –º–µ–Ω—é
   - –í—Ä–µ–º—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è < 1 –º–∏–Ω—É—Ç—ã
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤—Å–µ—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π

3. **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ —Å–±–æ–µ–≤
   - –£—Å–ø–µ—à–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
   - –†–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω—ã–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏

4. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (–Ω–æ–≤–æ–µ):**
   - –£—Å–ø–µ—à–Ω–∞—è —Ä–æ—Ç–∞—Ü–∏—è –∫–ª—é—á–µ–π –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∞–Ω–æ–º–∞–ª—å–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ (>90% —Ç–æ—á–Ω–æ—Å—Ç—å detection)
   - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å–∏—Å—Ç–µ–º—ã –∫–≤–æ—Ç (–ø—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤ –∏ –∞–≤—Ç–æ–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞)
   - –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ security –æ—Ç—á–µ—Ç—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–æ–±—ã—Ç–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

5. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (–Ω–æ–≤–æ–µ):**
   - Anomaly detection —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ñ–æ–Ω–µ –±–µ–∑ —Å–±–æ–µ–≤
   - Security metrics –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 00:00 UTC
   - Webhook —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è < 5 —Å–µ–∫—É–Ω–¥ (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã)
   - –û—Ç—á–µ—Ç—ã —Å–æ–¥–µ—Ä–∂–∞—Ç –ø–æ–ª–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É (connections, IPs, blocks)

### 10. –†–∏—Å–∫–∏ –∏ –º–∏—Ç–∏–≥–∞—Ü–∏—è

| –†–∏—Å–∫ | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –í–ª–∏—è–Ω–∏–µ | –ú–∏—Ç–∏–≥–∞—Ü–∏—è |
|------|-------------|---------|-----------|
| –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ü–µ–ª–µ–≤–æ–≥–æ —Å–∞–π—Ç–∞ | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–æ–µ | –°–ø–∏—Å–æ–∫ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö —Å–∞–π—Ç–æ–≤, –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ serverNames |
| –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ VPN —Ç—Ä–∞—Ñ–∏–∫–∞ | –ù–∏–∑–∫–∞—è | –í—ã—Å–æ–∫–æ–µ | –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ Xray, REALITY –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞, —Ä–æ—Ç–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ |
| –ü–æ—Ç–µ—Ä—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ | –ù–∏–∑–∫–∞—è | –°—Ä–µ–¥–Ω–µ–µ | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã, backup –ø–µ—Ä–µ–¥ —Ä–æ—Ç–∞—Ü–∏–µ–π –∫–ª—é—á–µ–π |
| –°–ª–æ–∂–Ω–æ—Å—Ç—å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | –°—Ä–µ–¥–Ω—è—è | –ù–∏–∑–∫–æ–µ | –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è, SECURITY_GUIDE.md |
| –õ–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è anomaly detection | –°—Ä–µ–¥–Ω—è—è | –°—Ä–µ–¥–Ω–µ–µ | –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Ä–æ–≥–æ–≤ (threshold), whitelist –¥–ª—è –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö IP |
| –í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –æ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ | –ù–∏–∑–∫–∞—è | –°—Ä–µ–¥–Ω–µ–µ | –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–∫—Ä–∏–ø—Ç–æ–≤, tail -F –≤–º–µ—Å—Ç–æ polling, –ª–æ–≥—Ä–æ—Ç–∞—Ü–∏—è |
| –ü–æ—Ç–µ—Ä—è –¥–æ—Å—Ç—É–ø–∞ –ø–æ—Å–ª–µ —Ä–æ—Ç–∞—Ü–∏–∏ –∫–ª—é—á–µ–π | –ù–∏–∑–∫–∞—è | –í—ã—Å–æ–∫–æ–µ | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ staging, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, rollback –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ |
| –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ª–µ–≥–∏—Ç–∏–º–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –∫–≤–æ—Ç–∞–º | –ù–∏–∑–∫–∞—è | –°—Ä–µ–¥–Ω–µ–µ | –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–∏ –∫ –ª–∏–º–∏—Ç–∞–º, —Ä—É—á–Ω–æ–π override –¥–ª—è –∞–¥–º–∏–Ω–∞ |

### 11. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ

#### 11.1 –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ
- –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π Xray-core
- –ï–∂–µ–º–µ—Å—è—á–Ω–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —á–µ—Ä–µ–∑ cron)
- –ï–∂–µ–º–µ—Å—è—á–Ω–∞—è —Ä–æ—Ç–∞—Ü–∏—è –∫–ª—é—á–µ–π (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —á–µ—Ä–µ–∑ cron: 0 3 1 * *)
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤ –Ω–∞ –æ—à–∏–±–∫–∏ –∏ –∞–Ω–æ–º–∞–ª–∏–∏
- –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ security –æ—Ç—á–µ—Ç–æ–≤
- –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –∞—É–¥–∏—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö IP —á–µ—Ä–µ–∑ UFW
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–≤–æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤ —á–µ—Ä–µ–∑ cron)

#### 11.2 –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏
- –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (SECURITY_GUIDE.md)
- –ß–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—â–∏–µ—Å—è –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è
- –ü—Ä–æ—Ü–µ–¥—É—Ä—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- –ü—Ä–æ—Ü–µ–¥—É—Ä—ã —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ security –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã
- –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ security –æ—Ç—á–µ—Ç–æ–≤

### 12. –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è (–≤–Ω–µ —Ç–µ–∫—É—â–µ–≥–æ scope)

–í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –≤ –±—É–¥—É—â–µ–º:
- –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å dashboard –º–µ—Ç—Ä–∏–∫–∞–º–∏
- REST API –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram –±–æ—Ç–æ–º –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ —Å –≥—Ä–∞—Ñ–∏–∫–∞–º–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤ —Å load balancing
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π failover –º–µ–∂–¥—É —Å–µ—Ä–≤–µ—Ä–∞–º–∏
- –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å SIEM —Å–∏—Å—Ç–µ–º–∞–º–∏ (Splunk, ELK)
- Machine learning –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è anomaly detection
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ (VMess, Trojan)
- –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–î–∞–Ω–Ω—ã–π PRD –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ VPN —Å–µ—Ä–≤–∏—Å–∞ –Ω–∞ –±–∞–∑–µ VLESS + REALITY —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞:
- **–ü—Ä–æ—Å—Ç–æ—Ç—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è** —á–µ—Ä–µ–∑ CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã** —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** —Å –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–º–∏ —É–ª—É—á—à–µ–Ω–∏—è–º–∏ (–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, —Ä–æ—Ç–∞—Ü–∏—è –∫–ª—é—á–µ–π, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–≤–æ—Ç–∞–º–∏)
- **–õ–µ–≥–∫–æ—Å—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è** —Å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–µ–π –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

–†–µ—à–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –ª–∏—á–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –¥–æ 50 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –ë–∞–∑–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ —Ç—Ä–µ–±—É—é—Ç –≥–ª—É–±–æ–∫–∏—Ö —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∑–Ω–∞–Ω–∏–π, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ security features –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –∑–∞—â–∏—Ç—ã.

**–°—Ç–∞—Ç—É—Å –¥–æ–∫—É–º–µ–Ω—Ç–∞:** –£—Ç–≤–µ—Ä–∂–¥–µ–Ω
**–í–µ—Ä—Å–∏—è:** 1.4
**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** –î–∞
**–û—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω—ã–µ —Å—Ä–æ–∫–∏:**
- –ë–∞–∑–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª (–≠—Ç–∞–ø—ã 1-4): 7-10 –¥–Ω–µ–π ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ security —É–ª—É—á—à–µ–Ω–∏—è (–≠—Ç–∞–ø 5): 3-5 –¥–Ω–µ–π üü° –ü–õ–ê–ù–ò–†–£–ï–¢–°–Ø
- –í–∞–∂–Ω—ã–µ security —É–ª—É—á—à–µ–Ω–∏—è (–≠—Ç–∞–ø 6): 3-4 –¥–Ω—è üü° –ü–õ–ê–ù–ò–†–£–ï–¢–°–Ø
- –ñ–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (–≠—Ç–∞–ø 7): 2-3 –¥–Ω—è üü¢ –û–ü–¶–ò–û–ù–ê–õ–¨–ù–û
**–û–±—â–∏–π —Å—Ä–æ–∫ —Å security improvements:** 15-22 –¥–Ω—è

### 13. –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

#### 13.1 –ü—Ä–æ–±–ª–µ–º–∞: "REALITY: processed invalid connection" - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ö–ª–∏–µ–Ω—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "Connected", –Ω–æ —Å–∞–π—Ç—ã –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è
- –í –ª–æ–≥–∞—Ö —Å–µ—Ä–≤–µ—Ä–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏: `REALITY: processed invalid connection`
- Access log –ø—É—Å—Ç–æ–π (–Ω–µ—Ç —É—Å–ø–µ—à–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π)

**Root Cause:**
–ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∏–ª–∏ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–µ X25519 –∫–ª—é—á–µ–π (privateKey –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ / publicKey –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ). REALITY protocol —Ç—Ä–µ–±—É–µ—Ç —Ç–æ—á–Ω–æ–≥–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è cryptographic key pair.

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏ REALITY
sudo tail -50 /opt/vless/logs/error.log | grep "invalid connection"

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å privateKey –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
docker exec xray-server cat /etc/xray/config.json | jq '.inbounds[0].streamSettings.realitySettings.privateKey'

# 3. –í—ã—á–∏—Å–ª–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π publicKey
docker run --rm teddysun/xray:24.11.30 xray x25519 -i <PRIVATE_KEY>

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∫–ª—é—á–µ–π –≤ .env
cat /opt/vless/.env | grep -E "(PRIVATE_KEY|PUBLIC_KEY)"
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –†–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä—É X25519 –∫–ª—é—á–µ–π:
```bash
docker run --rm teddysun/xray:24.11.30 xray x25519
# Output: Private key: xxx
#         Public key: yyy
```

2. –û–±–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:
```bash
# –û–±–Ω–æ–≤–∏—Ç—å privateKey –≤ config.json
sudo jq '.inbounds[0].streamSettings.realitySettings.privateKey = "NEW_PRIVATE_KEY"' \
  /opt/vless/config/config.json > /tmp/config_new.json
sudo mv /tmp/config_new.json /opt/vless/config/config.json
sudo chmod 600 /opt/vless/config/config.json

# –û–±–Ω–æ–≤–∏—Ç—å .env —Ñ–∞–π–ª
sudo sed -i 's/^PRIVATE_KEY=.*/PRIVATE_KEY=NEW_PRIVATE_KEY/' /opt/vless/.env
sudo sed -i 's/^PUBLIC_KEY=.*/PUBLIC_KEY=NEW_PUBLIC_KEY/' /opt/vless/.env
```

3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä:
```bash
cd /opt/vless && sudo docker-compose restart xray-server
```

4. –û–±–Ω–æ–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å **–Ω–æ–≤—ã–º PUBLIC_KEY**

**–ü—Ä–µ–≤–µ–Ω—Ç–∏–≤–Ω—ã–µ –º–µ—Ä—ã:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç `rotate-keys.sh` –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —Ä–æ—Ç–∞—Ü–∏–∏ –∫–ª—é—á–µ–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ backup –∫–ª—é—á–µ–π –ø–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏
- –•—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –≤ `/opt/vless/backups/`
- –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–ª—é—á–µ–π –ø–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

**–°—Å—ã–ª–∫–∏:**
- TROUBLESHOOTING.md: –†–∞–∑–¥–µ–ª "REALITY Connection Issues"
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Xray REALITY: https://xtls.github.io/

#### 13.2 –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –≤–µ—Ä—Å–∏–π Xray –∫–ª–∏–µ–Ω—Ç–∞ –∏ —Å–µ—Ä–≤–µ—Ä–∞

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞ –∫–ª–∏–µ–Ω—Ç—ã –Ω–µ –º–æ–≥—É—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è
- –ò–ª–∏ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è
- –û—à–∏–±–∫–∏ –æ –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

**Root Cause:**
Breaking changes –º–µ–∂–¥—É major versions Xray-core (–æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ —Å v1.x –Ω–∞ v24.x+).

**–†–µ—à–µ–Ω–∏–µ:**
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º—É—é –≤–µ—Ä—Å–∏—é –≤ docker-compose.yml:
```yaml
services:
  xray-server:
    image: teddysun/xray:24.11.30  # –ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å :latest
```

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –≤–µ—Ä—Å–∏–∏:**
- **–°–µ—Ä–≤–µ—Ä:** teddysun/xray:24.11.30
- **–ö–ª–∏–µ–Ω—Ç iOS (v2RayTun):** Xray 24.11.30+
- **–ö–ª–∏–µ–Ω—Ç Android:** v2rayNG —Å Xray-core 24.11+

**–ü—Ä–µ–≤–µ–Ω—Ç–∏–≤–Ω—ã–µ –º–µ—Ä—ã:**
- –ó–∞–∫—Ä–µ–ø–∏—Ç—å –≤–µ—Ä—Å–∏—é –≤ templates/docker-compose.yml.tpl
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞ staging –æ–∫—Ä—É–∂–µ–Ω–∏–∏
- –û–±–Ω–æ–≤–ª—è—Ç—å —Å–µ—Ä–≤–µ—Ä –∏ –∫–ª–∏–µ–Ω—Ç—ã —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä `minClientVer` –≤ realitySettings

#### 13.3 –ü—Ä–æ–±–ª–µ–º–∞: Geosite –ø—Ä–∞–≤–∏–ª–∞ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –≤ —Å—Ç–∞—Ä—ã—Ö –≤–µ—Ä—Å–∏—è—Ö

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å –æ—à–∏–±–∫–æ–π:
```
failed to load geosite: WIN-SPY
list not found in geosite.dat: WIN-SPY
```

**Root Cause:**
–í–µ—Ä—Å–∏—è Xray 24.11.30 –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ geosite –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (win-spy, win-update), –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –±–æ–ª–µ–µ –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏—è—Ö.

**–†–µ—à–µ–Ω–∏–µ:**
–£–±—Ä–∞—Ç—å –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ routing rules –∏–∑ config templates:
```bash
# –£–¥–∞–ª–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
sudo jq 'del(.routing.rules[] | select(.domain[]? | contains("win-spy") or contains("win-update")))' \
  /opt/vless/config/config.json > /tmp/config_fixed.json
sudo mv /tmp/config_fixed.json /opt/vless/config/config.json
```

**–°–ø–∏—Å–æ–∫ –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö geosite –ø—Ä–∞–≤–∏–ª –¥–ª—è v24.11:**
- ‚úÖ `geosite:category-ads-all` - –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ä–µ–∫–ª–∞–º—ã
- ‚úÖ `geosite:cn` - –∫–∏—Ç–∞–π—Å–∫–∏–µ —Å–∞–π—Ç—ã
- ‚úÖ `geosite:geolocation-!cn` - –Ω–µ –∫–∏—Ç–∞–π—Å–∫–∏–µ —Å–∞–π—Ç—ã
- ‚ùå `geosite:win-spy` - –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤ 24.11
- ‚ùå `geosite:win-update` - –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤ 24.11

#### 13.4 –ü—Ä–æ–±–ª–µ–º–∞: Destination —Å–∞–π—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –æ–±—Ä—ã–≤—ã —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- –û—à–∏–±–∫–∏ –≤ –ª–æ–≥–∞—Ö –æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ destination

**Root Cause:**
–¶–µ–ª–µ–≤–æ–π REALITY —Å–∞–π—Ç (dest) –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω, –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω –∏–ª–∏ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω.

**–†–µ—à–µ–Ω–∏–µ:**
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞–¥–µ–∂–Ω—ã–µ destination —Å–µ—Ä–≤–µ—Ä—ã:

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ (–ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ):**
- ‚úÖ `www.microsoft.com:443` - —Å—Ç–∞–±–∏–ª—å–Ω—ã–π, TLS 1.3, HTTP/2
- ‚úÖ `www.apple.com:443` - –≤—ã—Å–æ–∫–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
- ‚úÖ `github.com:443` - –æ—Ç–ª–∏—á–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- ‚ö†Ô∏è `speed.cloudflare.com:443` - –∏–Ω–æ–≥–¥–∞ –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏:**
```bash
# –¢–µ—Å—Ç destination
openssl s_client -connect www.microsoft.com:443 -servername www.microsoft.com < /dev/null

# –ü—Ä–æ–≤–µ—Ä–∫–∞ TLS –≤–µ—Ä—Å–∏–∏ (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å 1.3)
openssl s_client -connect www.microsoft.com:443 -servername www.microsoft.com < /dev/null 2>&1 | grep "Protocol"
```

**–°–º–µ–Ω–∞ destination:**
```bash
sudo jq '.inbounds[0].streamSettings.realitySettings.dest = "www.microsoft.com:443"' \
  /opt/vless/config/config.json > /tmp/config_new.json
sudo mv /tmp/config_new.json /opt/vless/config/config.json
cd /opt/vless && sudo docker-compose restart xray-server
```

**–ü—Ä–µ–≤–µ–Ω—Ç–∏–≤–Ω—ã–µ –º–µ—Ä—ã:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ serverNames –¥–ª—è fallback
- –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å destination —á–µ—Ä–µ–∑ cron
- –°–∫—Ä–∏–ø—Ç `check-destination.sh` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏