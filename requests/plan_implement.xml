<?xml version="1.0" encoding="UTF-8"?>
<implementation_plan>
    <project>VLESS+Reality VPN</project>
    <date>2025-09-27</date>
    <total_tasks>3</total_tasks>

    <task id="1" priority="high">
        <name>Улучшение проверки работоспособности сервиса</name>
        <description>
            Добавить комплексную проверку работоспособности Xray после установки
        </description>
        <steps>
            <step order="1">
                <action>Создать функцию check_xray_health() в utils.sh</action>
                <details>
                    - Проверка статуса контейнера (running, не restarting)
                    - Проверка отсутствия ошибок в логах
                    - Проверка доступности порта 443
                    - Валидация конфигурации через xray test
                </details>
            </step>
            <step order="2">
                <action>Обновить функцию start_service() в install.sh</action>
                <details>
                    - Использовать новую функцию check_xray_health()
                    - Добавить более информативные сообщения об ошибках
                    - Предложить действия при неудачном запуске
                </details>
            </step>
            <step order="3">
                <action>Тестировать новую проверку</action>
                <details>
                    - Проверить с корректной конфигурацией
                    - Проверить с некорректной конфигурацией
                    - Проверить с занятым портом
                </details>
            </step>
        </steps>
        <files_affected>
            <file>/scripts/lib/utils.sh</file>
            <file>/scripts/install.sh</file>
        </files_affected>
        <estimated_time>30 минут</estimated_time>
    </task>

    <task id="2" priority="high">
        <name>Создание руководства администратора</name>
        <description>
            Создать полное руководство администратора ADMIN_GUIDE.md
        </description>
        <steps>
            <step order="1">
                <action>Создать структуру документа</action>
                <sections>
                    - Введение и обзор системы
                    - Управление пользователями
                    - Мониторинг и логи
                    - Резервное копирование
                    - Обновление системы
                    - Управление сервисом
                    - Автоматизация задач
                    - Безопасность
                </sections>
            </step>
            <step order="2">
                <action>Написать детальное содержание каждого раздела</action>
                <details>
                    - Пошаговые инструкции с примерами команд
                    - Скриншоты вывода команд где необходимо
                    - Советы и лучшие практики
                    - Предупреждения о возможных проблемах
                </details>
            </step>
            <step order="3">
                <action>Добавить примеры использования</action>
                <details>
                    - Реальные сценарии использования
                    - Команды с параметрами
                    - Ожидаемый результат выполнения
                </details>
            </step>
        </steps>
        <files_affected>
            <file>/docs/ADMIN_GUIDE.md</file>
        </files_affected>
        <estimated_time>45 минут</estimated_time>
    </task>

    <task id="3" priority="high">
        <name>Создание документа по решению проблем</name>
        <description>
            Создать документ TROUBLESHOOTING.md с решениями частых проблем
        </description>
        <steps>
            <step order="1">
                <action>Создать структуру документа</action>
                <sections>
                    - Проблемы при установке
                    - Проблемы с Docker
                    - Ошибки подключения клиентов
                    - Сетевые проблемы
                    - Ошибки конфигурации
                    - Проблемы производительности
                    - Диагностика и отладка
                    - Восстановление системы
                </sections>
            </step>
            <step order="2">
                <action>Документировать типичные проблемы и решения</action>
                <details>
                    - Описание симптомов проблемы
                    - Команды для диагностики
                    - Пошаговое решение
                    - Превентивные меры
                </details>
            </step>
            <step order="3">
                <action>Добавить раздел FAQ</action>
                <details>
                    - Часто задаваемые вопросы
                    - Быстрые решения
                    - Ссылки на соответствующие разделы
                </details>
            </step>
        </steps>
        <files_affected>
            <file>/docs/TROUBLESHOOTING.md</file>
        </files_affected>
        <estimated_time>45 минут</estimated_time>
    </task>

    <execution_order>
        <phase number="1" name="Улучшение функциональности">
            <task_ref>1</task_ref>
            <reason>Сначала улучшаем код, чтобы документация описывала актуальную версию</reason>
        </phase>
        <phase number="2" name="Документирование">
            <task_ref>2</task_ref>
            <task_ref>3</task_ref>
            <reason>Создаем документацию параллельно после улучшения кода</reason>
        </phase>
    </execution_order>

    <success_criteria>
        <criterion>Install.sh успешно проверяет работоспособность Xray после установки</criterion>
        <criterion>ADMIN_GUIDE.md содержит полное руководство администратора</criterion>
        <criterion>TROUBLESHOOTING.md содержит решения основных проблем</criterion>
        <criterion>Вся документация на русском языке и легко читается</criterion>
        <criterion>Все изменения протестированы</criterion>
    </success_criteria>

    <notes>
        - Требование по символическим ссылкам исключено, так как уже реализовано
        - Приоритет на создание документации, так как это критично для использования
        - Улучшение проверки работоспособности повысит надежность установки
    </notes>
</implementation_plan>