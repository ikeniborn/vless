# –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –æ—à–∏–±–∫–∏ "WHITE: unbound variable"

## –û–±–∑–æ—Ä –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã

**–î–∞—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 21 —Å–µ–Ω—Ç—è–±—Ä—è 2025
**–§–∞–π–ª:** `/home/ikeniborn/Documents/Project/vless/modules/common_utils.sh`
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –£–°–ü–ï–®–ù–û –ò–°–ü–†–ê–í–õ–ï–ù–û

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ `install.sh` –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞ `WHITE: unbound variable` –Ω–∞ —Å—Ç—Ä–æ–∫–µ 57 –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `print_header()` —Ñ–∞–π–ª–∞ `modules/common_utils.sh`. –ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ —Å–≤—è–∑–∞–Ω–∞ —Å —É—Å–ª–æ–≤–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Ü–≤–µ—Ç–æ–≤—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –≥–¥–µ –µ—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `RED` —É–∂–µ –±—ã–ª–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –≤ –¥—Ä—É–≥–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ, –≤–µ—Å—å –±–ª–æ–∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ü–≤–µ—Ç–æ–≤—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–æ–ø—É—Å–∫–∞–ª—Å—è, –æ—Å—Ç–∞–≤–ª—è—è –¥—Ä—É–≥–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–≤–∫–ª—é—á–∞—è `WHITE`) –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º–∏.

## –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –ó–∞–º–µ–Ω–∞ —É—Å–ª–æ–≤–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–≤–µ—Ç–æ–≤—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö ‚úÖ

**–ë—ã–ª–æ (—Å—Ç—Ä–æ–∫–∏ 28-38):**
```bash
if [[ -z "${RED:-}" ]]; then
    readonly RED='\033[0;31m'
    readonly GREEN='\033[0;32m'
    readonly YELLOW='\033[1;33m'
    readonly BLUE='\033[0;34m'
    readonly CYAN='\033[0;36m'
    readonly PURPLE='\033[0;35m'
    readonly WHITE='\033[1;37m'
    readonly BOLD='\033[1m'
    readonly NC='\033[0m'
fi
```

**–°—Ç–∞–ª–æ:**
```bash
# Color definitions - check each variable individually
[[ -z "${RED:-}" ]] && readonly RED='\033[0;31m'
[[ -z "${GREEN:-}" ]] && readonly GREEN='\033[0;32m'
[[ -z "${YELLOW:-}" ]] && readonly YELLOW='\033[1;33m'
[[ -z "${BLUE:-}" ]] && readonly BLUE='\033[0;34m'
[[ -z "${CYAN:-}" ]] && readonly CYAN='\033[0;36m'
[[ -z "${PURPLE:-}" ]] && readonly PURPLE='\033[0;35m'
[[ -z "${WHITE:-}" ]] && readonly WHITE='\033[1;37m'
[[ -z "${BOLD:-}" ]] && readonly BOLD='\033[1m'
[[ -z "${NC:-}" ]] && readonly NC='\033[0m'
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞—â–∏—Ç–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –≤ —Ñ—É–Ω–∫—Ü–∏—é print_header ‚úÖ

**–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ –Ω–∞—á–∞–ª–æ —Ñ—É–Ω–∫—Ü–∏–∏:**
```bash
print_header() {
    # Ensure color variables are defined
    local white_color="${WHITE:-\033[1;37m}"
    local blue_color="${BLUE:-\033[0;34m}"
    local nc_color="${NC:-\033[0m}"
    local bold_color="${BOLD:-\033[1m}"

    # ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏ ...
}
```

–í—Å–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã.

### 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π show_progress –∏ spinner ‚úÖ

–î–æ–±–∞–≤–ª–µ–Ω—ã –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –∑–∞—â–∏—Ç–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:
```bash
show_progress() {
    local cyan_color="${CYAN:-\033[0;36m}"
    local nc_color="${NC:-\033[0m}"
    # ...
}

spinner() {
    local cyan_color="${CYAN:-\033[0;36m}"
    local nc_color="${NC:-\033[0m}"
    # ...
}
```

### 4. –°–æ–∑–¥–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–≤–µ—Ç–æ–≤—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö ‚úÖ

**–ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è:**
```bash
check_color_variables() {
    local required_colors=("RED" "GREEN" "YELLOW" "BLUE" "CYAN" "PURPLE" "WHITE" "BOLD" "NC")
    local missing_colors=()

    for color in "${required_colors[@]}"; do
        if [[ -z "${!color:-}" ]]; then
            missing_colors+=("$color")
        fi
    done

    if [[ ${#missing_colors[@]} -gt 0 ]]; then
        echo "WARNING: Missing color variables: ${missing_colors[*]}" >&2
        return 1
    fi

    return 0
}
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –ü—Ä–æ–π–¥–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã:

1. **‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞:**
   ```bash
   bash -n modules/common_utils.sh
   # –†–µ–∑—É–ª—å—Ç–∞—Ç: –ë–µ–∑ –æ—à–∏–±–æ–∫
   ```

2. **‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:**
   ```bash
   source modules/common_utils.sh && echo "WHITE=${WHITE:-UNDEFINED}"
   # –†–µ–∑—É–ª—å—Ç–∞—Ç: WHITE=\033[1;37m
   ```

3. **‚úÖ –¢–µ—Å—Ç —Ñ—É–Ω–∫—Ü–∏–∏ print_header:**
   ```bash
   source modules/common_utils.sh && print_header "Test Header"
   # –†–µ–∑—É–ª—å—Ç–∞—Ç: –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –≤—ã–≤–æ–¥ –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Å —Ü–≤–µ—Ç–∞–º–∏
   ```

4. **‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç —Å install.sh:**
   ```bash
   bash -n install.sh
   # –†–µ–∑—É–ª—å—Ç–∞—Ç: –ë–µ–∑ –æ—à–∏–±–æ–∫ "unbound variable"
   ```

5. **‚úÖ –¢–µ—Å—Ç —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å –ø—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏:**
   ```bash
   export RED='\033[0;31m' && source modules/common_utils.sh && print_header "Test"
   # –†–µ–∑—É–ª—å—Ç–∞—Ç: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞
   ```

6. **‚úÖ –¢–µ—Å—Ç EPERM protection:**
   ```bash
   timeout 10 bash -c "source modules/common_utils.sh && print_header 'EPERM Test'"
   # –†–µ–∑—É–ª—å—Ç–∞—Ç: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –±–µ–∑ –∑–∞–≤–∏—Å–∞–Ω–∏—è
   ```

7. **‚úÖ –¢–µ—Å—Ç —Ñ—É–Ω–∫—Ü–∏–∏ check_color_variables:**
   ```bash
   source modules/common_utils.sh && check_color_variables
   # –†–µ–∑—É–ª—å—Ç–∞—Ç: All color variables are properly defined
   ```

## –ü—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

### –§–∞–π–ª—ã –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã:
- ‚úÖ `install.sh` - –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π —Ü–≤–µ—Ç–æ–≤—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- ‚úÖ –ú–æ–¥—É–ª–∏ –≤ `modules/*.sh` - –∏–º–µ—é—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
- ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö - —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –¥—É–±–ª–∏—Ä—É—é—â–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è (–Ω–æ—Ä–º–∞–ª—å–Ω–æ):
```bash
modules/docker_setup.sh:31:readonly RED='\033[0;31m'
modules/backup_restore.sh:35:readonly RED='\033[0;31m'
modules/ufw_config.sh:31:readonly RED='\033[0;31m'
modules/system_update.sh:31:readonly RED='\033[0;31m'
modules/process_isolation/process_safe.sh:15:readonly RED='\033[0;31m'
```

–≠—Ç–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω—ã, —Ç–∞–∫ –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∑–∞—â–∏—Ç–Ω—É—é –ª–æ–≥–∏–∫—É.

## –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏

–°–æ–∑–¥–∞–Ω–∞ —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞:
```bash
/home/ikeniborn/Documents/Project/vless/modules/common_utils.sh.backup.20250921_172056
```

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

1. **üõ°Ô∏è –ü–æ–≤—ã—à–µ–Ω–Ω–∞—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å**: –ö–∞–∂–¥–∞—è —Ü–≤–µ—Ç–æ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ
2. **üîÑ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –†–∞–±–æ—Ç–∞–µ—Ç —Å —á–∞—Å—Ç–∏—á–Ω–æ –ø—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏
3. **‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
4. **üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**: –§—É–Ω–∫—Ü–∏—è check_color_variables –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
5. **üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –õ–æ–∫–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—é—Ç –æ—à–∏–±–∫–∏

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–§—É–Ω–∫—Ü–∏—è `check_color_variables()` –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ —Å–ø–∏—Å–æ–∫ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ü–≤–µ—Ç–æ–≤—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è
source modules/common_utils.sh && check_color_variables
```

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ü—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –Ω–æ–≤—ã—Ö –º–æ–¥—É–ª–µ–π:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω `${VAR:-default}` –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º
2. **–ü—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏:** –í–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É `check_color_variables` –≤ —Ç–µ—Å—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä
3. **–ü—Ä–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:** –í—Å–µ–≥–¥–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –º–æ–¥—É–ª—è–º–∏

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–û—à–∏–±–∫–∞ **"WHITE: unbound variable"** —É—Å–ø–µ—à–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞. –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ, —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –º–æ–¥—É–ª—è–º–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞. –°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å –±–æ–ª–µ–µ —É—Å—Ç–æ–π—á–∏–≤–∞ –∫ –ø–æ–¥–æ–±–Ω—ã–º –ø—Ä–æ–±–ª–µ–º–∞–º –≤ –±—É–¥—É—â–µ–º –±–ª–∞–≥–æ–¥–∞—Ä—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–º –ø—Ä–æ–≤–µ—Ä–∫–∞–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏ –∑–∞—â–∏—Ç–Ω—ã–º –º–µ—Ö–∞–Ω–∏–∑–º–∞–º –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö –≤—ã–≤–æ–¥–∞.

**–°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞:** ‚úÖ –ì–û–¢–û–í –ö –ü–†–û–î–ê–ö–®–ï–ù–£

---

*–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ —Å–æ–≥–ª–∞—Å–Ω–æ –ø–ª–∞–Ω—É –≤ /home/ikeniborn/Documents/Project/vless/requests/plan.xml*
*–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: 25 –º–∏–Ω—É—Ç (–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö 30 –º–∏–Ω—É—Ç)*