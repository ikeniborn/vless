# VLESS Telegram Bot Configuration
# Template file - Configure with actual values before deployment

# =================================================================
# CRITICAL: This file contains sensitive information!
# - Set proper file permissions: chmod 600 bot_config.env
# - Never commit this file with real credentials to version control
# - Use environment variables or secure configuration management in production
# =================================================================

# Bot Authentication (REQUIRED)
# Get your bot token from @BotFather on Telegram
# Format: 123456789:ABCdefGHIjklMNOpqrsTUVwxyz
TELEGRAM_BOT_TOKEN=""

# Admin Chat ID (REQUIRED for initial setup)
# Your Telegram chat ID - send /start to @userinfobot to get it
# Format: 123456789 (positive number for users, negative for groups)
TELEGRAM_ADMIN_CHAT_ID=""

# =================================================================
# Bot Settings
# =================================================================

# Bot Identity
BOT_NAME="VLESS VPN Manager"
BOT_DESCRIPTION="Remote management bot for VLESS VPN"
BOT_TIMEZONE="UTC"

# =================================================================
# Security Settings
# =================================================================

# Authentication & Session Management
MAX_FAILED_ATTEMPTS=3
LOCKOUT_DURATION=300          # 5 minutes in seconds
SESSION_TIMEOUT=3600          # 1 hour in seconds

# Command Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS=10        # Max requests per window
RATE_LIMIT_WINDOW=60          # Window duration in seconds

# Security Features
ENABLE_AUDIT_LOGGING=true
REQUIRE_CONFIRMATION=true     # Require confirmation for destructive operations
ENABLE_IP_WHITELIST=false     # Enable IP-based access control
ALLOWED_IPS=""               # Comma-separated list of allowed IPs

# =================================================================
# Feature Toggles
# =================================================================

# Core Features
ENABLE_USER_MANAGEMENT=true      # Allow user CRUD operations
ENABLE_CONFIG_GENERATION=true    # Allow configuration generation and QR codes
ENABLE_MONITORING=true           # Allow system monitoring access
ENABLE_BACKUP_MANAGEMENT=true    # Allow backup operations
ENABLE_LOG_ACCESS=true           # Allow log file access
ENABLE_MAINTENANCE=true          # Allow maintenance operations

# Advanced Features
ENABLE_SYSTEM_COMMANDS=false     # Allow direct system commands (admin only)
ENABLE_FILE_UPLOAD=false         # Allow file uploads
ENABLE_REMOTE_SHELL=false        # Allow remote shell access (DANGEROUS)

# =================================================================
# Logging Configuration
# =================================================================

# Log Levels: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL="INFO"
LOG_FILE="/opt/vless/logs/telegram_bot.log"
AUDIT_LOG_FILE="/opt/vless/logs/telegram_bot_audit.log"

# Log Rotation
ENABLE_LOG_ROTATION=true
MAX_LOG_SIZE="10M"              # Maximum log file size
LOG_BACKUP_COUNT=5              # Number of backup log files to keep

# =================================================================
# Notification Settings
# =================================================================

# System Alerts
ENABLE_SYSTEM_ALERTS=true       # Send alerts for system issues
ALERT_THRESHOLD_CPU=80          # CPU usage alert threshold (%)
ALERT_THRESHOLD_MEMORY=80       # Memory usage alert threshold (%)
ALERT_THRESHOLD_DISK=85         # Disk usage alert threshold (%)

# Security Alerts
ENABLE_SECURITY_ALERTS=true     # Send alerts for security events
ALERT_FAILED_LOGINS=true        # Alert on failed login attempts
ALERT_CONFIG_CHANGES=true       # Alert on configuration changes
ALERT_USER_CHANGES=true         # Alert on user management operations

# =================================================================
# Webhook Configuration (Optional)
# =================================================================

# Webhook Mode (Alternative to polling)
WEBHOOK_ENABLED=false
WEBHOOK_URL=""                  # Your webhook URL (https required)
WEBHOOK_SECRET=""               # Secret for webhook validation
WEBHOOK_PORT=8443               # Port for webhook server
WEBHOOK_CERT_PATH=""            # Path to SSL certificate (optional)
WEBHOOK_KEY_PATH=""             # Path to SSL private key (optional)

# =================================================================
# Integration Settings
# =================================================================

# External Services
ENABLE_EXTERNAL_MONITORING=false # Enable external monitoring service integration
MONITORING_WEBHOOK_URL=""        # Webhook URL for monitoring alerts
MONITORING_API_KEY=""            # API key for monitoring service

# Backup Integration
ENABLE_REMOTE_BACKUP_ALERTS=false # Send alerts for remote backup operations
BACKUP_WEBHOOK_URL=""             # Webhook URL for backup notifications

# =================================================================
# Performance Settings
# =================================================================

# Bot Performance
MAX_CONCURRENT_OPERATIONS=5      # Maximum concurrent bot operations
OPERATION_TIMEOUT=300            # Operation timeout in seconds (5 minutes)
MAX_MESSAGE_LENGTH=4096          # Maximum message length (Telegram limit)

# Cache Settings
ENABLE_RESPONSE_CACHE=true       # Cache responses for better performance
CACHE_TTL=300                    # Cache time-to-live in seconds
MAX_CACHE_SIZE=100               # Maximum number of cached items

# =================================================================
# UI/UX Settings
# =================================================================

# Message Formatting
USE_MARKDOWN=true               # Use Markdown formatting
ENABLE_EMOJIS=true              # Use emojis in messages
ENABLE_INLINE_KEYBOARDS=true    # Use inline keyboards for interactions

# Language & Localization
BOT_LANGUAGE="en"               # Bot language (en, es, fr, de, etc.)
TIMEZONE_DISPLAY="local"        # Timezone for timestamps (local, utc)
DATE_FORMAT="%Y-%m-%d %H:%M:%S" # Date format for timestamps

# =================================================================
# Development & Debug Settings
# =================================================================

# Debug Features (Disable in production)
DEBUG_MODE=false                # Enable debug mode
ENABLE_TEST_COMMANDS=false      # Enable test commands
LOG_API_CALLS=false             # Log Telegram API calls
VERBOSE_LOGGING=false           # Enable verbose logging

# Performance Monitoring
ENABLE_METRICS=false            # Enable performance metrics collection
METRICS_FILE="/opt/vless/logs/bot_metrics.log"

# =================================================================
# Environment-Specific Settings
# =================================================================

# Environment (development, staging, production)
ENVIRONMENT="production"

# Development overrides
if [ "$ENVIRONMENT" = "development" ]; then
    LOG_LEVEL="DEBUG"
    DEBUG_MODE=true
    ENABLE_TEST_COMMANDS=true
    VERBOSE_LOGGING=true
fi

# =================================================================
# Security Hardening Notes
# =================================================================

# 1. File Permissions:
#    chmod 600 /opt/vless/config/bot_config.env
#    chown vless:vless /opt/vless/config/bot_config.env

# 2. Environment Variables:
#    Consider using systemd environment files or docker secrets
#    instead of this file for sensitive values

# 3. Network Security:
#    - Use HTTPS webhooks only
#    - Implement IP whitelisting if possible
#    - Use strong, unique secrets

# 4. Monitoring:
#    - Monitor bot logs for suspicious activity
#    - Set up alerts for security events
#    - Regularly review authorized users

# 5. Updates:
#    - Keep bot dependencies updated
#    - Monitor Telegram Bot API changes
#    - Test bot functionality after updates

# =================================================================
# Configuration Validation
# =================================================================

# Required variables that must be set:
# - TELEGRAM_BOT_TOKEN
# - TELEGRAM_ADMIN_CHAT_ID (for initial setup)

# Optional but recommended:
# - LOG_LEVEL
# - MAX_FAILED_ATTEMPTS
# - SESSION_TIMEOUT

# =================================================================
# Usage Instructions
# =================================================================

# 1. Set your bot token and admin chat ID above
# 2. Adjust feature toggles based on your security requirements
# 3. Configure logging and notification settings
# 4. Set proper file permissions
# 5. Test the configuration with: telegram_bot_manager.sh validate
# 6. Deploy with: telegram_bot_manager.sh configure <token> <chat_id>

# =================================================================
# Support Information
# =================================================================

# For help with bot configuration:
# - Check logs: tail -f /opt/vless/logs/telegram_bot.log
# - Test bot: telegram_bot_manager.sh test
# - View status: telegram_bot_manager.sh status
# - Documentation: /opt/vless/docs/telegram_bot.md