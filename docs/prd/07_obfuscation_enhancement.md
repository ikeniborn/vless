# PRD v5.24 ‚Äî Obfuscation Enhancement: Traffic Availability Analysis

**–ù–∞–≤–∏–≥–∞—Ü–∏—è:** [–û–±–∑–æ—Ä](01_overview.md) | [–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è](02_functional_requirements.md) | [NFR](03_nfr.md) | [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](04_architecture.md) | [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](05_testing.md) | [–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è](06_appendix.md) | [–û–±—Ñ—É—Å–∫–∞—Ü–∏—è](07_obfuscation_enhancement.md)

---

## –û–ì–õ–ê–í–õ–ï–ù–ò–ï

1. [Executive Summary](#1-executive-summary)
2. [–¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: VLESS + Reality](#2-—Ç–µ–∫—É—â–∞—è-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-vless--reality)
3. [–ê–Ω–∞–ª–∏–∑ –æ–±—Ñ—É—Å–∫–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π](#3-–∞–Ω–∞–ª–∏–∑-–æ–±—Ñ—É—Å–∫–∞—Ü–∏–æ–Ω–Ω—ã—Ö-—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π)
   - 3.1 [XTLS Vision (—É–ª—É—á—à–µ–Ω–∏–µ Reality)](#31-xtls-vision-—É–ª—É—á—à–µ–Ω–∏–µ-reality)
   - 3.2 [WebSocket + TLS](#32-websocket--tls)
   - 3.3 [gRPC Transport](#33-grpc-transport)
   - 3.4 [XHTTP / SplitHTTP](#34-xhttp--splithttp)
   - 3.5 [Hysteria2 (QUIC-based)](#35-hysteria2-quic-based)
   - 3.6 [TUIC v5](#36-tuic-v5)
   - 3.7 [SingBox Runtime](#37-singbox-runtime)
   - 3.8 [Trojan Protocol](#38-trojan-protocol)
   - 3.9 [Shadowsocks 2022](#39-shadowsocks-2022)
4. [–°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑](#4-—Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π-–∞–Ω–∞–ª–∏–∑)
5. [Gap-–∞–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã](#5-gap-–∞–Ω–∞–ª–∏–∑-—Ç–µ–∫—É—â–µ–π-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã)
6. [–†–∏—Å–∫–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è](#6-—Ä–∏—Å–∫–∏-–∏-–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è)
7. [–ß–µ—Ç—ã—Ä—ë—Ö—É—Ä–æ–≤–Ω–µ–≤—ã–π –ø–ª–∞–Ω –¥–æ—Ä–∞–±–æ—Ç–∫–∏](#7-—á–µ—Ç—ã—Ä—ë—Ö—É—Ä–æ–≤–Ω–µ–≤—ã–π-–ø–ª–∞–Ω-–¥–æ—Ä–∞–±–æ—Ç–∫–∏)
   - 7.1 [Tier 1: –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (XTLS Vision)](#71-tier-1-–Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ-—É–ª—É—á—à–µ–Ω–∏—è-xtls-vision)
   - 7.2 [Tier 2: –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–æ–≤ (WS, gRPC, XHTTP)](#72-tier-2-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ-—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–æ–≤-ws-grpc-xhttp)
   - 7.3 [Tier 3: UDP-–ø—Ä–æ—Ç–æ–∫–æ–ª—ã –∫–∞–∫ opt-in (Hysteria2, TUIC)](#73-tier-3-udp-–ø—Ä–æ—Ç–æ–∫–æ–ª—ã-–∫–∞–∫-opt-in-hysteria2-tuic)
   - 7.4 [Tier 4: SingBox –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è](#74-tier-4-singbox-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)
8. [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ Tier 1-2](#8-—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ-—Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏-tier-1-2)
9. [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è](#9-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ-–∏-–≤–∞–ª–∏–¥–∞—Ü–∏—è)
10. [Roadmap –∏ –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è](#10-roadmap-–∏-–ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è)

---

## 1. Executive Summary

### –¶–µ–ª—å –¥–æ–∫—É–º–µ–Ω—Ç–∞

–î–∞–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —Ç–µ–∫—É—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã VLESS+Reality VPN (v5.24) —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –∫ DPI (Deep Packet Inspection) –∏ –º–µ—Ç–æ–¥–∞–º –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Ç—Ä–∞—Ñ–∏–∫–∞, –∞ —Ç–∞–∫–∂–µ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–ª–∞–Ω —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–±—Ñ—É—Å–∫–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π.

### –ö–æ–Ω—Ç–µ–∫—Å—Ç

–°–∏—Å—Ç–µ–º—ã —Ü–µ–Ω–∑—É—Ä—ã –≤ —Ä—è–¥–µ —Å—Ç—Ä–∞–Ω (–ö–∏—Ç–∞–π ‚Äî GFW, –ò—Ä–∞–Ω, –†–æ—Å—Å–∏—è ‚Äî –¢–°–ü–£) –∞–∫—Ç–∏–≤–Ω–æ —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä—É—é—Ç. –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ DPI-—Å–∏—Å—Ç–µ–º—ã —Å–ø–æ—Å–æ–±–Ω—ã –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å VPN-—Ç—Ä–∞—Ñ–∏–∫ –ø–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–º –ø—Ä–∏–∑–Ω–∞–∫–∞–º, –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º —Ä—É–∫–æ–ø–æ–∂–∞—Ç–∏—è (handshake timing), –∏ —ç–Ω—Ç—Ä–æ–ø–∏–∏ –ø–∞–∫–µ—Ç–æ–≤. –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç (TCP + Reality) —Å–æ–∑–¥–∞—ë—Ç –µ–¥–∏–Ω—É—é —Ç–æ—á–∫—É –æ—Ç–∫–∞–∑–∞ –ø—Ä–∏ –∏–∑–±–∏—Ä–∞—Ç–µ–ª—å–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ.

### –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã

| –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è | –£—Å–∏–ª–∏—è | DPI-—Å—Ç–æ–π–∫–æ—Å—Ç—å | –°—Ç–∞—Ç—É—Å |
|-----------|-----------|--------|---------------|--------|
| ~~**–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ**~~ | ~~XTLS Vision~~ | ~~–ù–∏–∑–∫–∏–µ~~ | ~~–í—ã—Å–æ–∫–∞—è~~ | ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û** ‚Äî –≤—Å–µ 7 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, v5.24+ (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ SSH 2026-02-23) |
| **–°–ª–µ–¥—É—é—â–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç** | XHTTP/SplitHTTP | –°—Ä–µ–¥–Ω–∏–µ | –í—ã—Å–æ–∫–∞—è (CDN) | –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω (Tier 2, v5.3x) |
| **–°–ª–µ–¥—É—é—â–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç** | WebSocket + TLS | –°—Ä–µ–¥–Ω–∏–µ | –°—Ä–µ–¥–Ω—è—è | –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω (Tier 2, v5.3x) |
| **–°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω–æ** | gRPC Transport | –°—Ä–µ–¥–Ω–∏–µ | –°—Ä–µ–¥–Ω—è—è | –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω (Tier 2, v5.3x) |
| **–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ** | Hysteria2 | –í—ã—Å–æ–∫–∏–µ | –í—ã—Å–æ–∫–∞—è | UDP, –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (Tier 3) |
| **–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ** | TUIC v5 | –í—ã—Å–æ–∫–∏–µ | –í—ã—Å–æ–∫–∞—è | UDP, –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (Tier 3) |
| **–°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏** | SingBox | –í—ã—Å–æ–∫–∏–µ | –ü—Ä–æ—Ç–æ–∫–æ–ª-–∑–∞–≤–∏—Å–∏–º–æ | –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π —Ä–∞–Ω—Ç–∞–π–º (Tier 4) |

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å **—á–µ—Ç—ã—Ä—ë—Ö—É—Ä–æ–≤–Ω–µ–≤—ã–π –ø–æ–¥—Ö–æ–¥**:
1. ‚úÖ **Tier 1 (v5.25): XTLS Vision** ‚Äî –†–ï–ê–õ–ò–ó–û–í–ê–ù–û. `flow: "xtls-rprx-vision"` –∞–∫—Ç–∏–≤–µ–Ω —É –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ SSH –Ω–∞ ikenibornvpn, 2026-02-23)
2. **Tier 2 (v5.3x):** WebSocket+TLS, gRPC, XHTTP –∫–∞–∫ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ inbound-—ã ‚Äî **–¢–ï–ö–£–©–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢**
3. **Tier 3 (v6.x):** Hysteria2 + TUIC –∫–∞–∫ opt-in –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (–ø–æ –æ–±—Ä–∞–∑—Ü—É MTProxy)
4. **Tier 4 (v7.x):** SingBox –∫–∞–∫ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π —Ä–∞–Ω—Ç–∞–π–º

---

## 2. –¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: VLESS + Reality

### 2.1 –û–±–∑–æ—Ä —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–í–µ—Ä—Å–∏—è:** v5.24
**–ü—Ä–æ—Ç–æ–∫–æ–ª:** VLESS + Reality (Xray-core 24.11.30)
**–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç:** TCP only
**–ü–æ—Ä—Ç:** 443 (—á–µ—Ä–µ–∑ HAProxy SNI passthrough)

```
–ö–ª–∏–µ–Ω—Ç (Reality Client)
    ‚îÇ
    ‚îÇ TCP:443 ‚Üí ClientHello (–º–∞—Å–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–¥ HTTPS –∫ dest-–¥–æ–º–µ–Ω—É)
    ‚ñº
HAProxy (familytraffic)
    ‚îÇ SNI passthrough (NO TLS termination –¥–ª—è Reality)
    ‚îÇ ACL: req_ssl_sni -i vless.example.com ‚Üí backend xray_vless
    ‚ñº
Xray (familytraffic, port 8443)
    ‚îÇ Reality handshake: X25519 ECDH + uTLS fingerprint
    ‚îÇ Decrypts VLESS payload
    ‚ñº
Internet
```

### 2.2 Reality Protocol: —Ç–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–µ–π `generate_xray_config_json()` –≤ `lib/orchestrator.sh`:

```json
{
  "inbounds": [{
    "port": 8443,
    "protocol": "vless",
    "tag": "vless-reality",
    "settings": {
      "clients": [],
      "decryption": "none",
      "fallbacks": [{ "dest": "familytraffic:80" }]
    },
    "streamSettings": {
      "network": "tcp",
      "security": "reality",
      "realitySettings": {
        "show": false,
        "dest": "${REALITY_DEST}:${REALITY_DEST_PORT}",
        "xver": 0,
        "serverNames": [
          "${REALITY_DEST}",
          "www.google.com",
          "www.microsoft.com",
          "www.apple.com"
        ],
        "privateKey": "${PRIVATE_KEY}",
        "shortIds": ["${SHORT_ID}", ""]
      }
    }
  }]
}
```

### 2.3 –ß—Ç–æ –¥–µ–ª–∞–µ—Ç Reality DPI-—Å—Ç–æ–π–∫–∏–º

Reality ‚Äî —ç—Ç–æ —ç–≤–æ–ª—é—Ü–∏—è TLS-–∫–∞–º—É—Ñ–ª—è–∂–∞, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –ø—Ä–æ—Ç–∏–≤ GFW:

1. **–ü–æ–¥–ª–∏–Ω–Ω—ã–π TLS 1.3 —Ä—É–∫–æ–ø–æ–∂–∞—Ç–∏–µ**: Reality –Ω–µ —ç–º—É–ª–∏—Ä—É–µ—Ç TLS ‚Äî –æ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –µ–≥–æ —Ü–µ–ª–∏–∫–æ–º. –°–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –Ω–∞—Å—Ç–æ—è—â–∏–π TLS-endpoint –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –¥–æ–º–µ–Ω–∞ (`dest`), –∏ —Ç–æ–ª—å–∫–æ –∫–ª–∏–µ–Ω—Ç—ã, –∑–Ω–∞—é—â–∏–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á X25519 –∏ shortId, –ø–æ–ª—É—á–∞—é—Ç VPN-—Ç—Ä–∞—Ñ–∏–∫.

2. **uTLS Fingerprinting**: –ö–ª–∏–µ–Ω—Ç –∏–º–∏—Ç–∏—Ä—É–µ—Ç TLS fingerprint –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤ (Chrome, Firefox, Safari). DPI –≤–∏–¥–∏—Ç `ClientHello` –Ω–µ–æ—Ç–ª–∏—á–∏–º—ã–π –æ—Ç –±—Ä–∞—É–∑–µ—Ä–Ω–æ–≥–æ.

3. **Active Probing Defense**: –õ—é–±–æ–π —Å–∫–∞–Ω–µ—Ä/–∑–æ–Ω–¥ –ø–æ–ª—É—á–∞–µ—Ç –ª–µ–≥–∏—Ç–∏–º–Ω—ã–π HTTPS-–æ—Ç–≤–µ—Ç –æ—Ç `dest` (–Ω–∞–ø—Ä–∏–º–µ—Ä, google.com). Impossible to distinguish from real HTTPS traffic by external observation.

4. **X25519 ECDH + shortId**: –¢–æ–ª—å–∫–æ –∫–ª–∏–µ–Ω—Ç —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ `publicKey` –∏ `shortId` –º–æ–∂–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å VPN-—Å–µ—Å—Å–∏—é.

### 2.4 –¢–µ–∫—É—â–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

> **–ê–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å:** –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ SSH –Ω–∞ –∂–∏–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ `ikenibornvpn` 2026-02-23. Xray `teddysun/xray:24.11.30`, HAProxy v4.3 (2025-10-31). 7 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

| –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å | –°—Ç–∞—Ç—É—Å |
|-------------|---------|-------------|--------|
| TCP-only transport | `streamSettings.network` = "tcp" ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç Reality | –°—Ä–µ–¥–Ω—è—è | üî¥ –ê–∫—Ç—É–∞–ª—å–Ω–æ (Tier 2) |
| ~~XTLS Vision –Ω–µ –≤–∫–ª—é—á—ë–Ω~~ | ~~`flow: "xtls-rprx-vision"` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —É –∫–ª–∏–µ–Ω—Ç–æ–≤~~ | ~~–ù–∏–∑–∫–∞—è~~ | ‚úÖ **–ó–ê–ö–†–´–¢–û** ‚Äî `flow: "xtls-rprx-vision"` –∞–∫—Ç–∏–≤–µ–Ω —É –í–°–ï–• 7 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| –ù–µ—Ç CDN-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ | Reality –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ Cloudflare –∏ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ CDN | –°—Ä–µ–¥–Ω—è—è | üî¥ –ê–∫—Ç—É–∞–ª—å–Ω–æ (Tier 2) |
| UDP –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è | HAProxy –∏ —Ç–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ ‚Äî TCP only | –í—ã—Å–æ–∫–∞—è | üî¥ –ê–∫—Ç—É–∞–ª—å–Ω–æ (Tier 3) |
| –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π inbound | –û–¥–∏–Ω —Ä–µ–∂–∏–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è ‚Äî —Ç–æ—á–∫–∞ –æ—Ç–∫–∞–∑–∞ –ø—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ Reality | –°—Ä–µ–¥–Ω—è—è | üî¥ –ê–∫—Ç—É–∞–ª—å–Ω–æ (Tier 2) |
| –ù–µ—Ç Nginx-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ | `familytraffic-nginx` –Ω–µ –∑–∞–¥–µ–ø–ª–æ–µ–Ω (reverse proxy –æ—Ç–∫–ª—é—á—ë–Ω) | –°—Ä–µ–¥–Ω—è—è | üî¥ –ê–∫—Ç—É–∞–ª—å–Ω–æ ‚Äî –Ω—É–∂–µ–Ω `familytraffic-nginx_tier2` –¥–ª—è Tier 2 |

---

## 3. –ê–Ω–∞–ª–∏–∑ –æ–±—Ñ—É—Å–∫–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

### 3.1 XTLS Vision (—É–ª—É—á—à–µ–Ω–∏–µ Reality)

**–ß—Ç–æ —ç—Ç–æ:** XTLS Vision ‚Äî —ç—Ç–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –≤ Xray-core, –∫–æ—Ç–æ—Ä–æ–µ —É–º–µ–Ω—å—à–∞–µ—Ç —ç–Ω—Ç—Ä–æ–ø–∏–π–Ω—ã–µ –∞–Ω–æ–º–∞–ª–∏–∏ –≤ –ø–µ—Ä–≤—ã—Ö –ø–∞–∫–µ—Ç–∞—Ö TLS-—Å–µ—Å—Å–∏–∏. –ë–µ–∑ Vision: –ø–µ—Ä–≤—ã–µ –±–∞–π—Ç—ã –ø–æ—Å–ª–µ TLS handshake —Å–æ–¥–µ—Ä–∂–∞—Ç –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π VLESS-–∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω–æ–π —ç–Ω—Ç—Ä–æ–ø–∏–µ–π. –° Vision: —ç—Ç–∏ –±–∞–π—Ç—ã –±—É—Ñ–µ—Ä–∏–∑–∏—Ä—É—é—Ç—Å—è –∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å –ø–µ—Ä–≤—ã–º –¥–∞–Ω–Ω—ã–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —É—Å—Ç—Ä–∞–Ω—è—è –ø–∞—Ç—Ç–µ—Ä–Ω.

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
```
–ë–µ–∑ Vision:
  TLS handshake ‚Üí VLESS header (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω, entropy ~= random) ‚Üí –¥–∞–Ω–Ω—ã–µ

–° Vision:
  TLS handshake ‚Üí [VLESS header + –ø–µ—Ä–≤—ã–µ –¥–∞–Ω–Ω—ã–µ] ‚Üí –æ—Å—Ç–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                   (—Å–∫–ª–µ–µ–Ω—ã, –Ω–µ–æ—Ç–ª–∏—á–∏–º—ã —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏)
```

**–ü–æ–¥–¥–µ—Ä–∂–∫–∞:** Xray-core 1.8.0+, —Ç–µ–∫—É—â–∏–π –æ–±—Ä–∞–∑ `teddysun/xray:24.11.30` –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç.

**DPI-—Å—Ç–æ–π–∫–æ—Å—Ç—å:** –í—ã—Å–æ–∫–∞—è. –£—Å—Ç—Ä–∞–Ω—è–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω, —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π –¥–ª—è VLESS-—Ç—Ä–∞—Ñ–∏–∫–∞. –û—Å–æ–±–µ–Ω–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –ø—Ä–æ—Ç–∏–≤ GFW Machine Learning –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤.

**CDN-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** –ù–µ—Ç (Reality –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ CDN).

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ `xray_config.json` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—è `flow` –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤.

---

### 3.2 WebSocket + TLS

**–ß—Ç–æ —ç—Ç–æ:** VLESS –∏–ª–∏ VMess —á–µ—Ä–µ–∑ WebSocket + TLS. –ö–ª–∏–µ–Ω—Ç —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç HTTP/1.1 —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ, –≤—ã–ø–æ–ª–Ω—è–µ—Ç `Upgrade: websocket`, –∏ —Ç—É–Ω–Ω–µ–ª–∏—Ä—É–µ—Ç —Ç—Ä–∞—Ñ–∏–∫ —á–µ—Ä–µ–∑ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ WebSocket-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ–≤–µ—Ä—Ö TLS.

**–°—Ö–µ–º–∞ —Ç—Ä–∞—Ñ–∏–∫–∞:**
```
–ö–ª–∏–µ–Ω—Ç
    ‚îÇ TLS ClientHello (SNI = domain.com)
    ‚ñº
HAProxy / Nginx (TLS termination)
    ‚îÇ HTTP GET /ws-path
    ‚îÇ Upgrade: websocket
    ‚ñº
Xray WebSocket inbound
    ‚îÇ WS ‚Üí VLESS payload
    ‚ñº
Internet
```

**DPI-—Å—Ç–æ–π–∫–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è. –¢—Ä–∞—Ñ–∏–∫ –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ HTTPS WebSocket (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ video streaming, gaming, real-time apps). –ù–æ —Ç–∞–π–º–∏–Ω–≥ –∏ –æ–±—ä—ë–º –ø–∞–∫–µ—Ç–æ–≤ –º–æ–≥—É—Ç –≤—ã–¥–∞–≤–∞—Ç—å VPN.

**CDN-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** –í—ã—Å–æ–∫–∞—è. –†–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ Cloudflare, AWS CloudFront, –∏ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ CDN. –≠—Ç–æ –∫–ª—é—á–µ–≤–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –ø–µ—Ä–µ–¥ Reality.

**–ü—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å –∫ —Ç–µ–∫—É—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ:**
- HAProxy –Ω—É–∂–µ–Ω –Ω–æ–≤—ã–π frontend/backend –¥–ª—è WebSocket inbound
- WebSocket inbound –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ä—Ç–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 8444) –∏–ª–∏ —á–µ—Ä–µ–∑ SNI –Ω–∞ —Ç–æ–º –∂–µ 443
- Nginx reverse proxy –º–æ–∂–µ—Ç –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞—Ç—å WebSocket –±–µ–∑ HAProxy –∏–∑–º–µ–Ω–µ–Ω–∏–π (—á–µ—Ä–µ–∑ `proxy_pass` —Å `Upgrade`)

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- WS —á–µ—Ä–µ–∑ CDN —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç CDN IP (–Ω–µ —Å–µ—Ä–≤–µ—Ä), –Ω–æ CDN –∑–Ω–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π IP —Å–µ—Ä–≤–µ—Ä–∞
- WebSocket keepalive –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω (ping/pong –∫–∞–∂–¥—ã–µ ~30—Å)

---

### 3.3 gRPC Transport

**–ß—Ç–æ —ç—Ç–æ:** VLESS —á–µ—Ä–µ–∑ gRPC (HTTP/2 binary framing). gRPC ‚Äî —ç—Ç–æ –ª–µ–≥–∏—Ç–∏–º–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª –¥–ª—è API-–≤—ã–∑–æ–≤–æ–≤ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏ Google, AWS –∏ —Ç.–¥. VPN-—Ç—Ä–∞—Ñ–∏–∫ –∑–∞–º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ gRPC API-–≤—ã–∑–æ–≤—ã.

**–°—Ö–µ–º–∞ —Ç—Ä–∞—Ñ–∏–∫–∞:**
```
–ö–ª–∏–µ–Ω—Ç
    ‚îÇ HTTP/2 POST /GunService/Gun (gRPC)
    ‚îÇ Content-Type: application/grpc
    ‚ñº
HAProxy (TLS termination, h2 mode)
    ‚ñº
Xray gRPC inbound
    ‚îÇ gRPC framing ‚Üí VLESS payload
    ‚ñº
Internet
```

**DPI-—Å—Ç–æ–π–∫–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è. gRPC —Ç—Ä–∞—Ñ–∏–∫ —à–∏—Ä–æ–∫–æ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω –≤ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Å–µ—Ç—è—Ö. –°–ª–æ–∂–Ω–µ–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å, —á–µ–º WebSocket.

**CDN-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** –í—ã—Å–æ–∫–∞—è (—á–µ—Ä–µ–∑ Cloudflare gRPC proxy). Cloudflare –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç gRPC —Å 2020 –≥–æ–¥–∞.

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ:**
- HAProxy –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –≤ `mode http` (–Ω–µ `mode tcp`) –¥–ª—è gRPC frontend
- –ò–ª–∏: TLS termination Nginx ‚Üí plaintext gRPC ‚Üí Xray
- –¢—Ä–µ–±—É–µ—Ç—Å—è HTTP/2 (`h2` –≤ ALPN)
- –ö–æ–Ω—Ñ–ª–∏–∫—Ç —Å —Ç–µ–∫—É—â–∏–º Reality SNI passthrough –Ω–∞ –ø–æ—Ä—Ç—É 443 (—Ä–∞–∑–Ω—ã–µ —Ä–µ–∂–∏–º—ã HAProxy)

**Xray –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
```json
{
  "streamSettings": {
    "network": "grpc",
    "grpcSettings": {
      "serviceName": "GunService",
      "multiMode": false
    },
    "security": "tls",
    "tlsSettings": {
      "alpn": ["h2"]
    }
  }
}
```

---

### 3.4 XHTTP / SplitHTTP

**–ß—Ç–æ —ç—Ç–æ:** –ù–æ–≤—ã–π transport –æ—Ç Xray-core (>= 24.9), —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è CDN-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏. –†–∞–∑–¥–µ–ª—è–µ—Ç upload –∏ download –ø–æ—Ç–æ–∫–∏ –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ HTTP-–∑–∞–ø—Ä–æ—Å—ã:
- **Upload:** HTTP POST —Å —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º body (chunked transfer)
- **Download:** HTTP GET —Å `Transfer-Encoding: chunked` (long-polling)

**–ó–∞—á–µ–º –Ω—É–∂–µ–Ω:** –ù–µ–∫–æ—Ç–æ—Ä—ã–µ CDN –±–ª–æ–∫–∏—Ä—É—é—Ç WebSocket –∏ gRPC, –Ω–æ –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ HTTP POST/GET. XHTTP —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–∞–º, –≥–¥–µ WS/gRPC –Ω–µ –ø—Ä–æ—Ö–æ–¥—è—Ç.

**DPI-—Å—Ç–æ–π–∫–æ—Å—Ç—å:** –í—ã—Å–æ–∫–∞—è –¥–ª—è CDN-—Å—Ä–µ–¥—ã. –¢—Ä–∞—Ñ–∏–∫ –Ω–µ–æ—Ç–ª–∏—á–∏–º –æ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö HTTP API-–≤—ã–∑–æ–≤–æ–≤ (HTTP chunked upload/download –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ñ–∞–π–ª–æ–≤—ã—Ö —Ö—Ä–∞–Ω–∏–ª–∏—â–∞—Ö, —Å—Ç—Ä–∏–º–∏–Ω–≥–µ).

**CDN-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** –ù–∞–∏–≤—ã—Å—à–∞—è —Å—Ä–µ–¥–∏ –≤—Å–µ—Ö —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–æ–≤. –†–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ Cloudflare Workers, –ª—é–±—ã–µ HTTP-–ø—Ä–æ–∫—Å–∏.

**Xray –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
```json
{
  "streamSettings": {
    "network": "splithttp",
    "splithttpSettings": {
      "path": "/api/v1/data",
      "host": "cdn-host.example.com",
      "maxUploadSize": 1000000,
      "maxConcurrentUploads": 10
    }
  }
}
```

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:** –í—ã—à–µ latency (HTTP round-trip –Ω–∞ –∫–∞–∂–¥—ã–π upload chunk). –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è real-time –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.

---

### 3.5 Hysteria2 (QUIC-based)

**–ß—Ç–æ —ç—Ç–æ:** –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª –Ω–∞ –±–∞–∑–µ QUIC (HTTP/3), –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–ª—è –≤—ã—Å–æ–∫–∏—Ö –∑–∞–¥–µ—Ä–∂–µ–∫ –∏ –ø–æ—Ç–µ—Ä—å –ø–∞–∫–µ—Ç–æ–≤. Hysteria2 –º–∞—Å–∫–∏—Ä—É–µ—Ç —Ç—Ä–∞—Ñ–∏–∫ –ø–æ–¥ HTTPS/3.

**–ö–ª—é—á–µ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|---------|
| –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç | QUIC (UDP) |
| –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ | TLS 1.3 |
| Congestion control | BBR (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –ø–æ—Ç–µ—Ä—å) |
| –ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ | HTTPS/3 –º–∞—Åquerading |
| Latency | –ù–∏–∂–µ —á–µ–º TCP (0-RTT reconnect) |
| Packet loss tolerance | –î–æ 50% (BBR) |

**DPI-—Å—Ç–æ–π–∫–æ—Å—Ç—å:** –í—ã—Å–æ–∫–∞—è. QUIC/HTTPS/3 —è–≤–ª—è–µ—Ç—Å—è –ª–µ–≥–∏—Ç–∏–º–Ω—ã–º –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–º (YouTube, Google, Cloudflare –∏—Å–ø–æ–ª—å–∑—É—é—Ç HTTPS/3). Entropy —Ç—Ä–∞—Ñ–∏–∫–∞ –±–ª–∏–∑–∫–∞ –∫ –ª–µ–≥–∏—Ç–∏–º–Ω–æ–º—É QUIC.

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:**
- **HAProxy –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç UDP** ‚Äî Hysteria2 –Ω–µ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ–∫—É—â—É—é HAProxy-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É
- –¢—Ä–µ–±—É–µ—Ç—Å—è **–ø—Ä—è–º–æ–π UDP port** –≤ `docker-compose.yml`: `- "443:443/udp"`
- UFW –ø—Ä–∞–≤–∏–ª–æ: `ufw allow 443/udp`
- Hysteria2 —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ **–æ—Ç–¥–µ–ª—å–Ω–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ** (–Ω–µ —á–µ—Ä–µ–∑ Xray)
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç Xray JSON

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (opt-in, –ø–æ –æ–±—Ä–∞–∑—Ü—É MTProxy):**
```
–ö–ª–∏–µ–Ω—Ç (Hysteria2 client)
    ‚îÇ UDP:443
    ‚îÇ QUIC + TLS 1.3
    ‚ñº
familytraffic (–æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä)
    ‚îÇ –î–µ–∫–æ–¥–∏—Ä—É–µ—Ç Hysteria2
    ‚ñº
Internet
```

---

### 3.6 TUIC v5

**–ß—Ç–æ —ç—Ç–æ:** TLS-over-QUIC Intra Connectivity ‚Äî –ø—Ä–æ—Ç–æ–∫–æ–ª 5-–≥–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è —Å —É–ª—É—á—à–µ–Ω–Ω—ã–º –º—É–ª—å—Ç–∏–ø–ª–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ 0-RTT —Ä—É–∫–æ–ø–æ–∂–∞—Ç–∏–µ–º. –†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –∫–∞–∫ –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ Hysteria2.

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å Hysteria2:**

| –ü–∞—Ä–∞–º–µ—Ç—Ä | Hysteria2 | TUIC v5 |
|----------|-----------|---------|
| Congestion control | BBR | Cubic/BBR |
| Multiplexing | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ | –ü–æ–ª–Ω–æ–µ (QUIC streams) |
| 0-RTT | –ù–µ—Ç | –î–∞ |
| UDP relay | –ù–µ—Ç | –î–∞ (UDP over QUIC) |
| –†–µ–∞–ª–∏–∑–∞—Ü–∏—è | –û—Ç–¥–µ–ª—å–Ω—ã–π binary | SingBox –∏–ª–∏ tuic-server |
| CPU usage | –°—Ä–µ–¥–Ω–∏–π | –ù–∏–∑–∫–∏–π |

**DPI-—Å—Ç–æ–π–∫–æ—Å—Ç—å:** –í—ã—Å–æ–∫–∞—è ‚Äî –ø–æ–¥–ª–∏–Ω–Ω—ã–π QUIC —Ç—Ä–∞—Ñ–∏–∫ —Å TLS 1.3.

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:** –ò–¥–µ–Ω—Ç–∏—á–Ω—ã Hysteria2 (UDP, –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, bypass HAProxy).

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –†–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å –≤–º–µ—Å—Ç–µ —Å Hysteria2 –∏–ª–∏ —á–µ—Ä–µ–∑ SingBox (–∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–±–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞).

---

### 3.7 SingBox Runtime

**–ß—Ç–æ —ç—Ç–æ:** SingBox ‚Äî —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –ø—Ä–æ–∫—Å–∏-–ø–ª–∞—Ç—Ñ–æ—Ä–º–∞, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∞—è 15+ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ –≤ –æ–¥–Ω–æ–º —Ä–∞–Ω—Ç–∞–π–º–µ: VLESS, VMess, Trojan, Hysteria2, TUIC, Shadowsocks, Na√ØveProxy, –∏ –¥—Ä—É–≥–∏–µ.

**–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ï–¥–∏–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–º–µ–Ω—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö (Hysteria2 + TUIC + –∏ —Ç.–¥.)
- –ê–∫—Ç–∏–≤–Ω–æ —Ä–∞–∑–≤–∏–≤–∞–µ—Ç—Å—è (—Ä–µ–ª–∏–∑—ã –∫–∞–∂–¥—ã–µ 1-2 –Ω–µ–¥–µ–ª–∏)
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç—ã: WebSocket, gRPC, XHTTP, HTTP/3
- –ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è –≤—Å–µ—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:**
- –§–æ—Ä–º–∞—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ **–ø—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è** –æ—Ç Xray JSON ‚Äî –Ω–µ–ª—å–∑—è –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ `generate_xray_config_json()`
- –ü–æ—Ç—Ä–µ–±—É–µ—Ç **–Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏** (–æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å `lib/singbox_config_generator.sh`)
- –ù–µ –∑–∞–º–µ–Ω–∞ Xray ‚Äî –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π runtime –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä):**
```
HAProxy (familytraffic)
    ‚îú‚îÄ SNI: vless.domain ‚Üí Xray (Reality)
    ‚îú‚îÄ SNI: singbox.domain ‚Üí SingBox VLESS/Trojan/etc.
    ‚îî‚îÄ SNI: *.domain ‚Üí Nginx (reverse proxy)

familytraffic (–Ω–æ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä)
    ‚îú‚îÄ VLESS over WebSocket (port 8444)
    ‚îú‚îÄ Trojan (port 8445)
    ‚îî‚îÄ Hysteria2 (UDP:8443 ‚Äî –ø—Ä—è–º–æ–π exposure)
```

---

### 3.8 Trojan Protocol

**–ß—Ç–æ —ç—Ç–æ:** Trojan –º–∞—Å–∫–∏—Ä—É–µ—Ç —Ç—Ä–∞—Ñ–∏–∫ –ø–æ–¥ HTTPS –ø—É—Ç—ë–º –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∞—Ä–æ–ª—è –∫–∞–∫ –ø–µ—Ä–≤—ã—Ö –±–∞–π—Ç TLS-—Å–µ—Å—Å–∏–∏. –° —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è DPI ‚Äî –æ–±—ã—á–Ω—ã–π HTTPS-—Ç—Ä–∞—Ñ–∏–∫ –Ω–∞ –ø–æ—Ä—Ç—É 443.

**–°—Ö–µ–º–∞:**
```
–ö–ª–∏–µ–Ω—Ç ‚Üí TLS:443 ‚Üí –ø–µ—Ä–≤—ã–µ –±–∞–π—Ç—ã: sha256(password) + CRLF + CONNECT payload
```

**–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤ Xray:** –ù–∞—Ç–∏–≤–Ω–∞—è (`protocol: "trojan"`). –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∫–∞–∫ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π inbound.

**DPI-—Å—Ç–æ–π–∫–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω–µ-–≤—ã—Å–æ–∫–∞—è. –ü–æ–¥–ª–∏–Ω–Ω—ã–π TLS, –Ω–æ –±–æ–ª–µ–µ —Å–ª–∞–±–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç active probing —á–µ–º Reality (–Ω–µ—Ç uTLS fingerprinting).

**CDN-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è. –ß–µ—Ä–µ–∑ CDN —Ç—Ä–µ–±—É–µ—Ç WebSocket transport (Trojan over WS+TLS).

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** –ù–∏–∑–∫–∏–µ —É—Å–∏–ª–∏—è ‚Äî –Ω–æ–≤—ã–π `protocol: "trojan"` inbound –≤ Xray, SNI routing —á–µ—Ä–µ–∑ HAProxy.

---

### 3.9 Shadowsocks 2022

**–ß—Ç–æ —ç—Ç–æ:** –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π Shadowsocks —Å AEAD-2022 —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º (AES-128-GCM, AES-256-GCM, ChaCha20-Poly1305). –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–æ—Ç–æ–∫–æ–ª —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑ –∫–∞–º—É—Ñ–ª—è–∂–∞.

**DPI-—Å—Ç–æ–π–∫–æ—Å—Ç—å:** –ù–∏–∑–∫–∞—è. –í –ö–∏—Ç–∞–µ Shadowsocks –∞–∫—Ç–∏–≤–Ω–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –Ω–∞—á–∏–Ω–∞—è —Å 2019 –≥–æ–¥–∞ —á–µ—Ä–µ–∑ replay detection –∏ entropy analysis. –í –†–æ—Å—Å–∏–∏ –∏ –ò—Ä–∞–Ω–µ ‚Äî –º–µ–Ω–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞.

**–ü—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å:** –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∞. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–∞–∫ —Ñ–æ–ª–±—ç–∫ –¥–ª—è —Ä–µ–≥–∏–æ–Ω–æ–≤ –±–µ–∑ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–≥–æ DPI. –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ç–æ–∫–æ–ª –¥–ª—è —Ä–µ–≥–∏–æ–Ω–æ–≤ —Å –≤—ã—Å–æ–∫–∏–º —É—Ä–æ–≤–Ω–µ–º —Ü–µ–Ω–∑—É—Ä—ã.

**–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤ Xray:** –ù–∞—Ç–∏–≤–Ω–∞—è (`protocol: "shadowsocks"`).

---

## 4. –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑

### 4.1 –ú–∞—Ç—Ä–∏—Ü–∞ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫

| –ü—Ä–æ—Ç–æ–∫–æ–ª/Transport | DPI-—Å—Ç–æ–π–∫–æ—Å—Ç—å | CDN-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å | UDP | –£—Å–∏–ª–∏—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ | –°—Ç–∞—Ç—É—Å –≤ –ø—Ä–æ–µ–∫—Ç–µ |
|-------------------|--------------|------------------|-----|------------------|-----------------|
| **VLESS+Reality (—Ç–µ–∫—É—â–∏–π)** | ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ | ‚úó | ‚úó | ‚Äî | –†–ï–ê–õ–ò–ó–û–í–ê–ù |
| **XTLS Vision** | ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ | ‚úó | ‚úó | ‚Äî | ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù** (–≤—Å–µ 7 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, v5.24+) |
| **VLESS+WebSocket+TLS** | ‚òÖ‚òÖ‚òÖ | ‚úì | ‚úó | –°—Ä–µ–¥–Ω–∏–µ | –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω |
| **VLESS+gRPC** | ‚òÖ‚òÖ‚òÖ‚òÖ | ‚úì | ‚úó | –°—Ä–µ–¥–Ω–∏–µ | –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω |
| **VLESS+XHTTP/SplitHTTP** | ‚òÖ‚òÖ‚òÖ‚òÖ | ‚úì‚úì | ‚úó | –°—Ä–µ–¥–Ω–∏–µ | –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω |
| **Hysteria2** | ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ | ‚úó | ‚úì | –í—ã—Å–æ–∫–∏–µ | –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω |
| **TUIC v5** | ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ | ‚úó | ‚úì | –í—ã—Å–æ–∫–∏–µ | –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω |
| **Trojan** | ‚òÖ‚òÖ‚òÖ | –ß–∞—Å—Ç–∏—á–Ω–æ | ‚úó | –ù–∏–∑–∫–∏–µ | –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω |
| **Shadowsocks 2022** | ‚òÖ‚òÖ | ‚úó | ‚úó | –ù–∏–∑–∫–∏–µ | –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω |
| **SingBox (–ø–ª–∞—Ç—Ñ–æ—Ä–º–∞)** | –ó–∞–≤–∏—Å–∏—Ç | ‚úì | ‚úì | –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∏–µ | –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω |

### 4.2 –ü—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å –ø–æ —Å—Ü–µ–Ω–∞—Ä–∏—è–º

| –°—Ü–µ–Ω–∞—Ä–∏–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è | –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª | –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ |
|------------------------|-------------------------|-------------|
| –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è DPI-—Å—Ç–æ–π–∫–æ—Å—Ç—å (–ö–∏—Ç–∞–π, GFW) | VLESS+Reality+XTLS Vision | Hysteria2 |
| CDN –∑–∞ Cloudflare | VLESS+XHTTP/SplitHTTP | VLESS+WebSocket+TLS |
| –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Å–µ—Ç—å (–º–æ–±–∏–ª—å–Ω—ã–π, Wi-Fi) | Hysteria2 (BBR) | TUIC v5 |
| –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è —Å—Ä–µ–¥–∞ (gRPC —Ä–∞–∑—Ä–µ—à—ë–Ω) | VLESS+gRPC | VLESS+WebSocket |
| –ù–∏–∑–∫–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞, 0-RTT reconnect | TUIC v5 | Hysteria2 |
| –ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è | VLESS+Reality (—Ç–µ–∫—É—â–∏–π) | Trojan |
| –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –∫–ª–∏–µ–Ω—Ç—ã/—Ä–µ–≥–∏–æ–Ω—ã | Shadowsocks 2022 | VLESS+WebSocket |

### 4.3 –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Ä–µ—à–µ–Ω–∏—è

–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è VLESS+Reality —è–≤–ª—è–µ—Ç—Å—è **–ª—É—á—à–∏–º —Ä–µ—à–µ–Ω–∏–µ–º –¥–ª—è –ø—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏—è GFW** –ø—Ä–∏ –ø—Ä—è–º–æ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –±–µ–∑ CDN. –°–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:
1. –ù–µ—Ç CDN-–ø—É—Ç–∏ (–¥–ª—è —Å–ª—É—á–∞–µ–≤, –∫–æ–≥–¥–∞ –ø—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ)
2. –ù–µ—Ç UDP-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–ª—è –ø–ª–æ—Ö–∏—Ö —Å–µ—Ç–µ–π
3. –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç —Å–æ–∑–¥–∞—ë—Ç —Ä–∏—Å–∫ –ø—Ä–∏ —Ç–æ—á–µ—á–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ Reality

---

## 5. Gap-–∞–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### 5.1 –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–π gap

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** –í —Ñ—É–Ω–∫—Ü–∏–∏ `generate_xray_config_json()` (—Ñ–∞–π–ª `lib/orchestrator.sh:627`):

```json
"streamSettings": {
  "network": "tcp",   // ‚Üê –∂—ë—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–æ, –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç
  "security": "reality"
}
```

**–ß—Ç–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç:**
- WebSocket transport (`network: "ws"`)
- gRPC transport (`network: "grpc"`)
- XHTTP transport (`network: "splithttp"`)
- –ú–µ—Ö–∞–Ω–∏–∑–º –≤—ã–±–æ—Ä–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º

### 5.2 XTLS Vision gap ‚Äî ‚úÖ –ó–ê–ö–†–´–¢

> **–°—Ç–∞—Ç—É—Å –Ω–∞ 2026-02-23:** –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ SSH. –í—Å–µ 7 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ `xray_config.json` –∏–º–µ—é—Ç `flow: "xtls-rprx-vision"`. GAP –£–°–¢–†–ê–ù–Å–ù.

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ** (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ SSH ikenibornvpn, 2026-02-23):
```json
"clients": [
  { "id": "uuid-1", "email": "ikeniborn@vless.local",  "flow": "xtls-rprx-vision" },
  { "id": "uuid-2", "email": "feanor666@vless.local",  "flow": "xtls-rprx-vision" },
  { "id": "uuid-3", "email": "oksigen86@vless.local",  "flow": "xtls-rprx-vision" },
  { "id": "uuid-4", "email": "sevruka@vless.local",    "flow": "xtls-rprx-vision" },
  { "id": "uuid-5", "email": "sevrukn@vless.local",    "flow": "xtls-rprx-vision" },
  { "id": "uuid-6", "email": "sevrukm@vless.local",    "flow": "xtls-rprx-vision" },
  { "id": "uuid-7", "email": "torrih@vless.local",     "flow": "xtls-rprx-vision" }
]
```

**–ö–∞–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ –∫–æ–¥–µ (`lib/user_management.sh`):**
```bash
# add_user_to_json() —Å—Ç—Ä–æ–∫–∞ 521-525 ‚Äî –Ω–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:
jq ".inbounds[0].settings.clients += [{
    \"id\": \"$uuid\",
    \"email\": \"${username}@vless.local\",
    \"flow\": \"xtls-rprx-vision\"   # ‚Üê –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
}]" "$XRAY_CONFIG" > "$temp_file"

# generate_vless_uri() —Å—Ç—Ä–æ–∫–∞ 834 ‚Äî URI –≤–∫–ª—é—á–∞–µ—Ç flow:
uri+="&flow=xtls-rprx-vision"
```

**–û—Å—Ç–∞—Ç–æ–∫:**  `validate_vless_uri()` –≤ `lib/qr_generator.sh` (—Å—Ç—Ä–æ–∫–∞ 95) –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É —Ç—Ä–µ–±—É–µ—Ç `flow` –∫–∞–∫ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –¥–ª—è –í–°–ï–• URI ‚Äî —ç—Ç–æ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø–µ—Ä–µ–¥ Tier 2 (Tier 2 URI –Ω–µ –∏–º–µ—é—Ç `flow`).

### 5.3 UDP/QUIC gap

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** –í—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç TCP. `docker-compose.yml` –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç UDP port mapping. HAProxy —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ `mode tcp` (TCP-level LB).

**–ß—Ç–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è Hysteria2/TUIC:**
1. –ù–æ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä `familytraffic` (–∏–ª–∏ `familytraffic`)
2. UDP port mapping: `"443:443/udp"` –∏–ª–∏ `"8443:8443/udp"`
3. UFW –ø—Ä–∞–≤–∏–ª–∞: `ufw allow 8443/udp`
4. –û—Ç–¥–µ–ª—å–Ω—ã–π Docker network –∏–ª–∏ –ø—Ä—è–º–æ–π host binding
5. HAProxy –Ω–µ —É—á–∞—Å—Ç–≤—É–µ—Ç –≤ UDP routing

### 5.4 CDN-–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ gap

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** Reality –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ CDN (Cloudflare, etc.) –ø–æ—Ç–æ–º—É —á—Ç–æ CDN —Ç–µ—Ä–º–∏–Ω–∏—Ä—É–µ—Ç TLS –∏ –Ω–µ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç RAW TLS traffic.

**–ß—Ç–æ –Ω—É–∂–Ω–æ:** –•–æ—Ç—è –±—ã –æ–¥–∏–Ω CDN-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π transport (WebSocket, gRPC –∏–ª–∏ XHTTP) –∑–∞ Nginx/HAProxy, –∫–æ—Ç–æ—Ä—ã–π —Å–º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —á–µ—Ä–µ–∑ Cloudflare proxied DNS.

### 5.5 –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

```
–¢–ï–ö–£–©–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ HAProxy (TCP only, mode tcp)                            ‚îÇ
‚îÇ  Port 443: SNI passthrough ‚Üí Xray Reality (TCP:8443)   ‚îÇ
‚îÇ  Port 1080: TLS term ‚Üí Xray SOCKS5 (TCP:10800)         ‚îÇ
‚îÇ  Port 8118: TLS term ‚Üí Xray HTTP (TCP:18118)           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø:
  ‚úó HAProxy –Ω–µ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É–µ—Ç UDP ‚Üí Hysteria2/TUIC –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω –±–µ–∑ bypass
  ‚úó mode tcp –Ω–∞ –ø–æ—Ä—Ç—É 443 –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É–µ—Ç —Å mode http (–Ω—É–∂–µ–Ω –¥–ª—è gRPC)
  ‚úó –í—Å–µ –∏–Ω–±–∞—É–Ω–¥—ã share –ø–æ—Ä—Ç 443 —á–µ—Ä–µ–∑ SNI ‚Üí –Ω–æ–≤—ã–µ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç—ã –Ω—É–∂–Ω—ã –Ω–∞ –Ω–æ–≤—ã—Ö –ø–æ—Ä—Ç–∞—Ö
     (–∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–µ subdomains —á–µ—Ä–µ–∑ SNI)
```

---

## 6. –†–∏—Å–∫–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### 6.1 –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–∏—Å–∫–∏

| ID | –†–∏—Å–∫ | Severity | Mitigation |
|----|------|----------|-----------|
| **R1** | –ù–æ–≤—ã–µ –∏–Ω–±–∞—É–Ω–¥—ã (WS, gRPC) —Ç—Ä–µ–±—É—é—Ç –Ω–æ–≤—ã—Ö Docker-–ø–æ—Ä—Ç–æ–≤ –∏ HAProxy –∏–∑–º–µ–Ω–µ–Ω–∏–π | Medium | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SNI-subdomain routing: `ws.domain ‚Üí Xray WebSocket backend`. –û–¥–∏–Ω HAProxy frontend –Ω–∞ –ø–æ—Ä—Ç—É 443 –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É–µ—Ç –ø–æ SNI –∫ —Ä–∞–∑–Ω—ã–º backends. |
| **R2** | Hysteria2/TUIC —Ç—Ä–µ–±—É—é—Ç UDP ‚Äî –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å HAProxy TCP-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π | High | –û—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –ø—Ä—è–º—ã–º UDP port exposure (bypass HAProxy). –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ MTProxy pattern (`lib/mtproxy_manager.sh`). |
| **R3** | SingBox –∫–∞–∫ –∑–∞–º–µ–Ω–∞ Xray –ø–æ—Ç—Ä–µ–±—É–µ—Ç –ø–æ–ª–Ω–æ–π –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –º–æ–¥—É–ª–µ–π | High | –†–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å SingBox –∫–∞–∫ **–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π** –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –Ω–µ –∑–∞–º–µ–Ω—É. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç: Xray (Reality) –ò–õ–ò SingBox (multi-protocol). |
| **R4** | WebSocket –Ω–∞ –ø–æ—Ä—Ç—É 443 –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É–µ—Ç —Å Reality SNI passthrough | Medium | Subdomain routing: `vless.domain ‚Üí Reality/Xray`, `ws.domain ‚Üí WebSocket/Xray`. –û–±–∞ —á–µ—Ä–µ–∑ HAProxy SNI ACL. |
| **R5** | gRPC —Ç—Ä–µ–±—É–µ—Ç HTTP/2 –∏ HAProxy `mode http`, –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ —Å —Ç–µ–∫—É—â–∏–º `mode tcp` –Ω–∞ –ø–æ—Ä—Ç—É 443 | Medium | gRPC inbound –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ä—Ç—É (8444) —Å –æ—Ç–¥–µ–ª—å–Ω—ã–º HAProxy frontend –≤ `mode http`. –ò–õ–ò gRPC —á–µ—Ä–µ–∑ Nginx reverse proxy (–¥–æ–±–∞–≤–∏—Ç—å backend –≤ `familytraffic-nginx`). |
| ~~**R6**~~ | ~~GFW –¥–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç VLESS+Reality –ø–æ timing analysis (–±–µ–∑ XTLS Vision)~~ | ~~Low~~ | ‚úÖ **–ó–ê–ö–†–´–¢** ‚Äî `flow: "xtls-rprx-vision"` –∞–∫—Ç–∏–≤–µ–Ω —É –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ SSH 2026-02-23) |

### 6.2 –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ä–∏—Å–∫–∏

| –†–∏—Å–∫ | Severity | Mitigation |
|------|----------|-----------|
| –°–ª–æ–∂–Ω–æ—Å—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞–º–∏ | Medium | CLI-–∫–æ–º–∞–Ω–¥–∞ `vless transport` –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –∏ —Å—Ç–∞—Ç—É—Å–∞ |
| –£–≤–µ–ª–∏—á–µ–Ω–∏–µ attack surface –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –ø–æ—Ä—Ç–æ–≤ | Medium | UFW rate-limiting + fail2ban –Ω–∞ –≤—Å–µ –Ω–æ–≤—ã–µ –ø–æ—Ä—Ç—ã |
| –†–∞–∑–ª–∏—á–Ω—ã–µ client apps –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ | Low | –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∫–ª–∏–µ–Ω—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ |
| Performance degradation –ø—Ä–∏ HTTP-—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞—Ö | Low | Benchmark —Ç–µ—Å—Ç—ã –ø–µ—Ä–µ–¥ production. Hysteria2/BBR ‚Äî –Ω–∞–æ–±–æ—Ä–æ—Ç, –ª—É—á—à–µ –ø—Ä–∏ packet loss |

### 6.3 –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤

| –ü—Ä–æ—Ç–æ–∫–æ–ª | iOS | Android | Windows | macOS | Linux |
|----------|-----|---------|---------|-------|-------|
| VLESS+Reality+Vision | **v2rayTun** ‚úÖ, Shadowrocket, Sing-Box | v2rayNG, Sing-Box | v2rayN, Xray | ClashX, Sing-Box | Xray CLI |
| VLESS+WebSocket | **v2rayTun** ‚úÖ, Shadowrocket, Sing-Box | v2rayNG, Sing-Box | v2rayN, Xray | ClashX, Sing-Box | Xray CLI |
| VLESS+gRPC | **v2rayTun** ‚úÖ, Shadowrocket, Sing-Box | v2rayNG, Sing-Box | v2rayN, Xray | ClashX, Sing-Box | Xray CLI |
| VLESS+XHTTP | **v2rayTun** ‚ö†Ô∏è (–≤–µ—Ä–æ—è—Ç–Ω–æ), Sing-Box | v2rayNG, Sing-Box | v2rayN, Xray | Sing-Box | Xray CLI |
| Hysteria2 | Sing-Box | Sing-Box, NekoBox | v2rayN, Hysteria | Sing-Box | Hysteria CLI |
| TUIC v5 | Sing-Box | Sing-Box | Sing-Box | Sing-Box | tuic-client |

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ iOS-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç **v2rayTun** (v2.4.4, —Ñ–µ–≤—Ä–∞–ª—å 2026). –ê–Ω–∞–ª–∏–∑ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ v2rayTun —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞–º–∏ —Å–º. –≤ —Ä–∞–∑–¥–µ–ª–µ **6.4**.

### 6.4 iOS v2rayTun ‚Äî –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

> **–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ:** App Store changelog + GitHub releases (DigneZzZ/v2raytun) + docs.v2raytun.com. –î–∞—Ç–∞: 2026-02-22.

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---|---|
| –¢–µ–∫—É—â–∞—è iOS –≤–µ—Ä—Å–∏—è | **2.4.4** (4 —Ñ–µ–≤—Ä–∞–ª—è 2026) |
| Bundled Xray-core | **25.10.15** (v2.4.1, –¥–µ–∫–∞–±—Ä—å 2025; v2.4.4 –≤–µ—Ä–æ—è—Ç–Ω–æ –Ω–æ–≤–µ–µ) |
| –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ | DATABRIDGES TECHNOLOGIES LTD |
| App Store ID | 6476628951 |
| –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è iOS | 16.0+ |

**–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –ø–ª–∞–Ω–∏—Ä—É–µ–º—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏:**

| –§—É–Ω–∫—Ü–∏—è | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ | –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å | –ò—Å—Ç–æ—á–Ω–∏–∫ |
|---------|-----------|-------------|---------|
| XTLS Vision (`flow=xtls-rprx-vision`) | ‚úÖ **–î–∞** | –í—ã—Å–æ–∫–∞—è | –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä URI –≤ docs.v2raytun.com |
| VLESS URI –∏–º–ø–æ—Ä—Ç (`flow=`, `fp=`, `pbk=`, `sid=`) | ‚úÖ **–î–∞** | –í—ã—Å–æ–∫–∞—è | –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π URI –ø—Ä–∏–º–µ—Ä + user guides |
| uTLS fingerprint: chrome, firefox, safari, ios, android, edge, 360, qq | ‚úÖ **–ü–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä** | –í—ã—Å–æ–∫–∞—è | –ù–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç Xray-core |
| uTLS fingerprint: random, randomized | ‚úÖ **–î–∞** | –í—ã—Å–æ–∫–∞—è | Xray-core uTLS |
| WebSocket transport | ‚úÖ **–î–∞** | –í—ã—Å–æ–∫–∞—è | App Store changelog v1.8.9 (—è–≤–Ω–æ–µ —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ) |
| gRPC transport | ‚úÖ **–î–∞** | –í—ã—Å–æ–∫–∞—è | App Store changelog v1.8.9 (—è–≤–Ω–æ–µ —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ) |
| XHTTP/SplitHTTP transport | ‚ö†Ô∏è **–í–µ—Ä–æ—è—Ç–Ω–æ** | –°—Ä–µ–¥–Ω—è—è | Android v3.9.34 (–∞–≤–≥—É—Å—Ç 2024) –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω; iOS ‚Äî –Ω–µ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω —è–≤–Ω–æ |
| HAProxy ‚Üí Nginx migration | ‚úÖ **–ù—É–ª–µ–≤–æ–π impact** | –í—ã—Å–æ–∫–∞—è | –ü—Ä–æ–∑—Ä–∞—á–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞ L4; –ø–æ—Ä—Ç/—Ö–æ—Å—Ç/cert –Ω–µ –º–µ–Ω—è—é—Ç—Å—è |

**XTLS Vision ‚Äî –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å v2rayTun:**

–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (docs.v2raytun.com) —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∏–º–µ—Ä URI –∏–º–µ–Ω–Ω–æ —Å XTLS Vision:
```
vless://<uuid>@<server>:443?type=tcp&security=reality&fp=chrome&pbk=<key>&sni=google.com&flow=xtls-rprx-vision#name
```
v2rayTun –ø–∞—Ä—Å–∏—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä `flow=xtls-rprx-vision` –∏–∑ URI –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –∏ –ø–µ—Ä–µ–¥–∞—ë—Ç –µ–≥–æ –≤ Xray-core. –ü–æ—Å–∫–æ–ª—å–∫—É Xray-core >= 1.8.0 –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç XTLS Vision, —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é.

**uTLS fingerprints –≤ v2rayTun:**

v2rayTun –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Xray-core uTLS ‚Äî –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä fingerprints –∏–¥–µ–Ω—Ç–∏—á–µ–Ω —ç—Ç–∞–ª–æ–Ω–Ω–æ–º—É:

| –ó–Ω–∞—á–µ–Ω–∏–µ | –ß—Ç–æ —ç–º—É–ª–∏—Ä—É–µ—Ç |
|---|---|
| `chrome` | Chrome (–∞–∫—Ç—É–∞–ª—å–Ω—ã–π) |
| `firefox` | Firefox |
| `safari` | Safari desktop |
| `ios` | iOS Safari |
| `android` | Android Chrome |
| `edge` | Microsoft Edge |
| `360` | 360 Browser (–ö–∏—Ç–∞–π) |
| `qq` | QQ Browser (–ö–∏—Ç–∞–π) |
| `random` | –°–ª—É—á–∞–π–Ω—ã–π –∏–∑ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã—Ö |
| `randomized` | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π (100% TLS 1.3 + X25519) |

**XHTTP –Ω–∞ iOS ‚Äî —Ä–∏—Å–∫ –∏ –º–∏—Ç–∏–≥–∞—Ü–∏—è:**

XHTTP –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω –Ω–∞ Android —Å –∞–≤–≥—É—Å—Ç–∞ 2024 (v3.9.34). iOS-–≤–µ—Ä—Å–∏—è –æ–±—ã—á–Ω–æ –≤—ã—Ö–æ–¥–∏—Ç —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π –≤ 1-4 –Ω–µ–¥–µ–ª–∏. –ü—Ä–∏ Tier 2 —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (v5.31):
- **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ —Ä—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** XHTTP –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º iOS-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ —Å v2rayTun
- –ï—Å–ª–∏ XHTTP –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ iOS –ø–µ—Ä–µ—Ö–æ–¥—è—Ç –Ω–∞ WebSocket (–ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞)
- Reality (–æ—Å–Ω–æ–≤–Ω–æ–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç) –Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç—Å—è –≤ –ª—é–±–æ–º —Å–ª—É—á–∞–µ

---

## 7. –ß–µ—Ç—ã—Ä—ë—Ö—É—Ä–æ–≤–Ω–µ–≤—ã–π –ø–ª–∞–Ω –¥–æ—Ä–∞–±–æ—Ç–∫–∏

### 7.1 Tier 1: –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (XTLS Vision) ‚Äî ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

**–í–µ—Ä—Å–∏—è:** v5.25 (—Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ v5.24+)
**–£—Å–∏–ª–∏—è:** ~~–ù–∏–∑–∫–∏–µ (1-2 –¥–Ω—è)~~ ‚Üí –í–´–ü–û–õ–ù–ï–ù–û
**–†–∏—Å–∫:** –ù–∏–∑–∫–∏–π ‚Üí –ó–ê–ö–†–´–¢
**–í–ª–∏—è–Ω–∏–µ:** –í—ã—Å–æ–∫–æ–µ (—É–ª—É—á—à–µ–Ω–∏–µ DPI-—Å—Ç–æ–π–∫–æ—Å—Ç–∏ –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π Reality) ‚Üí –î–û–°–¢–ò–ì–ù–£–¢–û

> **SSH-–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ (ikenibornvpn, 2026-02-23):** –í—Å–µ 7 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ xray_config.json –∏–º–µ—é—Ç `flow: "xtls-rprx-vision"`. Xray –æ–±—Ä–∞–∑ `teddysun/xray:24.11.30` –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω.

**–°—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω–µ–Ω–∏–π:**

| # | –ò–∑–º–µ–Ω–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|---|-----------|--------|
| 1 | `lib/orchestrator.sh` (create_xray_config): –Ω–∞—á–∞–ª—å–Ω—ã–π `clients: []` ‚Äî flow –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ create_user | ‚úÖ OK (flow –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ add_user_to_json, –Ω–µ —á–µ—Ä–µ–∑ —à–∞–±–ª–æ–Ω) |
| 2 | `lib/user_management.sh` (add_user_to_json, —Å—Ç—Ä–æ–∫–∞ 524): `"flow": "xtls-rprx-vision"` | ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û |
| 3 | `lib/user_management.sh` (generate_vless_uri, —Å—Ç—Ä–æ–∫–∞ 834): `uri+="&flow=xtls-rprx-vision"` | ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û |
| 4 | Xray `teddysun/xray:24.11.30` –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç XTLS Vision | ‚úÖ –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–û (Xray-core >= 1.8.0) |

**–û—Å—Ç–∞—Ç–æ–∫ Tier 1 (–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ –Ω–µ–∑–∞–∫—Ä—ã—Ç–æ–µ):**
- `lib/qr_generator.sh` —Å—Ç—Ä–æ–∫–∞ 95: `validate_vless_uri()` —Ç—Ä–µ–±—É–µ—Ç `flow` –∫–∞–∫ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä —É –í–°–ï–• URI ‚Üí –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –¥–æ Tier 2 (WS/XHTTP/gRPC URI –Ω–µ –∏–º–µ—é—Ç `flow`)

---

### 7.2 Tier 2: –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–æ–≤ (WS, gRPC, XHTTP)

**–í–µ—Ä—Å–∏—è:** v5.3x
**–£—Å–∏–ª–∏—è:** –°—Ä–µ–¥–Ω–∏–µ (2-4 –Ω–µ–¥–µ–ª–∏)
**–†–∏—Å–∫:** –°—Ä–µ–¥–Ω–∏–π (–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è HAProxy)
**–í–ª–∏—è–Ω–∏–µ:** –í—ã—Å–æ–∫–æ–µ (CDN-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)

> **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ —É—Ç–æ—á–Ω–µ–Ω–∏–µ (–Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –∂–∏–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞):**
> HAProxy –Ω–∞ –ø–æ—Ä—Ç—É 443 —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ `mode tcp` (SNI passthrough). TLS-—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏—è –¥–ª—è Tier 2 —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–æ–≤ **–Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞ –≤ HAProxy –Ω–∞ –ø–æ—Ä—Ç—É 443** –±–µ–∑ –Ω–∞—Ä—É—à–µ–Ω–∏—è Reality. –†–µ—à–µ–Ω–∏–µ: –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä **`familytraffic-nginx_tier2`** –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç—Ä–∞—Ñ–∏–∫ –æ—Ç HAProxy –∏ —Ç–µ—Ä–º–∏–Ω–∏—Ä—É–µ—Ç TLS –¥–ª—è WS/XHTTP/gRPC.
>
> –ù–∞ –∂–∏–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ **–Ω–µ—Ç –Ω–∏ –æ–¥–Ω–æ–≥–æ Nginx-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞** (reverse proxy –±—ã–ª –æ—Ç–∫–ª—é—á—ë–Ω –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ) ‚Äî `familytraffic-nginx_tier2` –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Å –Ω—É–ª—è.

**–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Tier 2:**
```
HAProxy :443 (mode tcp, SNI routing)
  ‚îú‚îÄ‚îÄ SNI ws.domain    ‚Üí backend nginx_tier2:8448
  ‚îú‚îÄ‚îÄ SNI xhttp.domain ‚Üí backend nginx_tier2:8448
  ‚îú‚îÄ‚îÄ SNI grpc.domain  ‚Üí backend nginx_tier2:8448
  ‚îî‚îÄ‚îÄ (default)        ‚Üí backend xray_vless:8443 (Reality ‚Äî –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)

familytraffic-nginx_tier2 (–ù–û–í–´–ô –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, listen 8448 ssl http2)
  ‚îú‚îÄ‚îÄ server_name ws.domain    ‚Üí proxy_pass http://familytraffic:8444
  ‚îú‚îÄ‚îÄ server_name xhttp.domain ‚Üí proxy_pass http://familytraffic:8445
  ‚îî‚îÄ‚îÄ server_name grpc.domain  ‚Üí grpc_pass grpc://familytraffic:8446

familytraffic (plaintext inbounds ‚Äî –±–µ–∑ TLS, Nginx —Ç–µ—Ä–º–∏–Ω–∏—Ä—É–µ—Ç)
  ‚îú‚îÄ‚îÄ :8443 Reality (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π)
  ‚îú‚îÄ‚îÄ :8444 VLESS WS plaintext (–Ω–æ–≤—ã–π)
  ‚îú‚îÄ‚îÄ :8445 VLESS XHTTP plaintext (–Ω–æ–≤—ã–π)
  ‚îî‚îÄ‚îÄ :8446 VLESS gRPC plaintext (–Ω–æ–≤—ã–π)
```

**–ü–æ–¥—ç—Ç–∞–ø 2a: WebSocket + TLS (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)**

1. –ù–æ–≤—ã–π Xray inbound –Ω–∞ –ø–æ—Ä—Ç—É 8444 —Å `network: "ws"`, **–±–µ–∑ TLS** (Nginx —Ç–µ—Ä–º–∏–Ω–∏—Ä—É–µ—Ç)
2. HAProxy SNI routing: `ws.example.com ‚Üí nginx_tier2 backend (:8448)`
3. Nginx `server_name ws.example.com` ‚Üí `proxy_pass http://familytraffic:8444` + WebSocket upgrade headers
4. –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –∫–æ–Ω—Ñ–∏–≥–æ–≤ –¥–ª—è WS transport (`generate_transport_uri ws`)
5. CLI –∫–æ–º–∞–Ω–¥–∞: `vless add-transport ws <subdomain>`

**–ü–æ–¥—ç—Ç–∞–ø 2b: XHTTP/SplitHTTP (–≤—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)**

1. –ù–æ–≤—ã–π Xray inbound –Ω–∞ –ø–æ—Ä—Ç—É 8445 —Å `network: "splithttp"` (Xray >= 24.9 ‚Äî —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è 24.11.30 ‚úì)
2. HAProxy SNI routing: `xhttp.example.com ‚Üí nginx_tier2 backend`
3. Nginx `server_name xhttp.example.com` ‚Üí `proxy_pass http://familytraffic:8445` + chunked streaming
4. CDN-–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Cloudflare –¥–ª—è XHTTP

**–ü–æ–¥—ç—Ç–∞–ø 2c: gRPC (—Å—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)**

1. –ù–æ–≤—ã–π Xray inbound –Ω–∞ –ø–æ—Ä—Ç—É 8446 —Å `network: "grpc"`, **–±–µ–∑ TLS** (Nginx —Ç–µ—Ä–º–∏–Ω–∏—Ä—É–µ—Ç)
2. HAProxy SNI routing: `grpc.example.com ‚Üí nginx_tier2 backend`
3. Nginx `server_name grpc.example.com` ‚Üí `grpc_pass grpc://familytraffic:8446` (http2 required)

**–ù–æ–≤—ã–µ CLI-–∫–æ–º–∞–Ω–¥—ã:**
```bash
sudo familytraffic add-transport ws subdomain.example.com
sudo familytraffic add-transport xhttp subdomain.example.com
sudo familytraffic add-transport grpc subdomain.example.com
sudo familytraffic list-transports
sudo familytraffic remove-transport ws
```

---

### 7.3 Tier 3: UDP-–ø—Ä–æ—Ç–æ–∫–æ–ª—ã –∫–∞–∫ opt-in (Hysteria2, TUIC)

**–í–µ—Ä—Å–∏—è:** v6.x
**–£—Å–∏–ª–∏—è:** –í—ã—Å–æ–∫–∏–µ (4-6 –Ω–µ–¥–µ–ª—å)
**–†–∏—Å–∫:** –í—ã—Å–æ–∫–∏–π (–Ω–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, UDP exposure)
**–í–ª–∏—è–Ω–∏–µ:** –û—á–µ–Ω—å –≤—ã—Å–æ–∫–æ–µ (–ø–ª–æ—Ö–∏–µ —Å–µ—Ç–∏, –ö–∏—Ç–∞–π)

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** –ü–æ –æ–±—Ä–∞–∑—Ü—É MTProxy (`lib/mtproxy_manager.sh` + `docker/mtproxy/`):

```
–ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:
  lib/hysteria2_manager.sh        # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Hysteria2 –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º
  lib/tuic_manager.sh             # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ TUIC –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º
  docker/hysteria2/               # Dockerfile + entrypoint
  docker/tuic/                    # Dockerfile + entrypoint
  scripts/vless-hysteria2         # CLI –¥–ª—è Hysteria2
  scripts/vless-tuic              # CLI –¥–ª—è TUIC

–ò–∑–º–µ–Ω–µ–Ω–∏—è docker-compose.yml:
  familytraffic:
    image: tobyxdd/hysteria:latest
    ports:
      - "8443:8443/udp"  # –ü—Ä—è–º–æ–π UDP, bypass HAProxy
    profiles: ["hysteria2"]  # Opt-in, –Ω–µ —Å—Ç–∞—Ä—Ç—É–µ—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

UFW –ø—Ä–∞–≤–∏–ª–∞:
  ufw allow 8443/udp comment 'Hysteria2'
```

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞ (opt-in wizard):**
```bash
sudo familytraffic install-hysteria2
# Wizard: –≤—ã–±–æ—Ä –ø–æ—Ä—Ç–∞, SSL cert, bandwidth limits
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –∫–æ–Ω—Ñ–∏–≥–æ–≤ (Sing-Box format)
```

---

### 7.4 Tier 4: SingBox –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

**–í–µ—Ä—Å–∏—è:** v7.x
**–£—Å–∏–ª–∏—è:** –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∏–µ (2-3 –º–µ—Å—è—Ü–∞)
**–†–∏—Å–∫:** –í—ã—Å–æ–∫–∏–π (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –∫–æ–¥–æ–≤–∞—è –±–∞–∑–∞)
**–í–ª–∏—è–Ω–∏–µ:** –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ (–≤—Å–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã –≤ –æ–¥–Ω–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ)

**–ü—Ä–∏–Ω—Ü–∏–ø:** SingBox –∫–∞–∫ **–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π —Ä–∞–Ω—Ç–∞–π–º**, –Ω–µ –∑–∞–º–µ–Ω–∞ Xray.

```
–ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:
  lib/singbox_config_generator.sh  # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è SingBox JSON (–æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç)
  lib/singbox_manager.sh           # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ SingBox –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º
  scripts/vless-singbox            # CLI

–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä familytraffic:
  - VLESS+Reality (–¥—É–±–ª–∏—Ä—É–µ—Ç Xray, –¥–ª—è A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
  - Hysteria2 (–∑–∞–º–µ–Ω—è–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π familytraffic)
  - TUIC v5 (–∑–∞–º–µ–Ω—è–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π familytraffic)
  - Trojan+WebSocket+TLS
```

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è:** SingBox –∞–∫—Ç–∏–≤–Ω–æ —Ä–∞–∑–≤–∏–≤–∞–µ—Ç—Å—è –∏ –≤ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–µ —Å—Ç–∞–Ω–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π –¥–ª—è –æ–±—Ö–æ–¥–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫. –†–∞–Ω–Ω—è—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∫–∞–∫ opt-in –æ–±–µ—Å–ø–µ—á–∏—Ç –ø–ª–∞–≤–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥.

---

## 8. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ Tier 1-2

### 8.1 XTLS Vision: –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ ‚Äî ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

> **–°—Ç–∞—Ç—É—Å:** –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ SSH –Ω–∞ ikenibornvpn. –í—Å–µ 7 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–º–µ—é—Ç `flow: "xtls-rprx-vision"`.

**–¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Xray inbound** (—Ä–µ–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞, 2026-02-23):

```json
{
  "inbounds": [{
    "port": 8443,
    "protocol": "vless",
    "tag": "vless-reality",
    "settings": {
      "clients": [
        { "id": "...", "email": "ikeniborn@vless.local",  "flow": "xtls-rprx-vision" },
        { "id": "...", "email": "feanor666@vless.local",  "flow": "xtls-rprx-vision" },
        { "id": "...", "email": "oksigen86@vless.local",  "flow": "xtls-rprx-vision" },
        { "id": "...", "email": "sevruka@vless.local",    "flow": "xtls-rprx-vision" },
        { "id": "...", "email": "sevrukn@vless.local",    "flow": "xtls-rprx-vision" },
        { "id": "...", "email": "sevrukm@vless.local",    "flow": "xtls-rprx-vision" },
        { "id": "...", "email": "torrih@vless.local",     "flow": "xtls-rprx-vision" }
      ],
      "decryption": "none",
      "fallbacks": [{ "dest": "familytraffic:80" }]
    },
    "streamSettings": {
      "network": "tcp",
      "security": "reality",
      "realitySettings": { "show": false, "...": "..." }
    }
  }]
}
```

**–¢–µ–∫—É—â–∏–π client URI** (`generate_vless_uri()` —Å—Ç—Ä–æ–∫–∞ 834 ‚Äî —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ):

```
# –§–æ—Ä–º–∞—Ç —Å Vision (–ê–ö–¢–ò–í–ù–´–ô ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ):
vless://${UUID}@${SERVER}:443?encryption=none&flow=xtls-rprx-vision&security=reality&sni=...&fp=chrome&pbk=...&sid=...&type=tcp#username
```

### 8.2 WebSocket Transport: –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Xray

**–ù–æ–≤—ã–π inbound –¥–ª—è WebSocket** (–¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –º–∞—Å—Å–∏–≤ inbounds):

```json
{
  "port": 8444,
  "protocol": "vless",
  "tag": "vless-websocket",
  "settings": {
    "clients": [],
    "decryption": "none"
  },
  "streamSettings": {
    "network": "ws",
    "wsSettings": {
      "path": "/vless-ws",
      "headers": {}
    }
  }
}
```

**HAProxy –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** (SNI routing ‚Üí `familytraffic-nginx_tier2`, –ù–ï –Ω–∞–ø—Ä—è–º—É—é –Ω–∞ Xray):

> **–£—Ç–æ—á–Ω–µ–Ω–∏–µ:** HAProxy –Ω–∞ –ø–æ—Ä—Ç—É 443 —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ `mode tcp`. TLS-—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏—é –¥–ª—è WebSocket –≤—ã–ø–æ–ª–Ω—è–µ—Ç `familytraffic-nginx_tier2` (–Ω–æ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä). HAProxy —Ç–æ–ª—å–∫–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É–µ—Ç –ø–æ SNI.

```haproxy
# –í frontend https_sni_router, –ü–ï–†–ï–î default_backend (R4 mitigation):
acl is_tier2_ws req_ssl_sni -i ws.example.com
use_backend nginx_tier2 if is_tier2_ws

# –ï–¥–∏–Ω—ã–π backend –¥–ª—è –≤—Å–µ—Ö Tier 2 —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–æ–≤:
backend nginx_tier2
    mode tcp
    server nginx familytraffic-nginx_tier2:8448 check inter 10s fall 3 rise 2
```

**Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** (TLS termination ‚Üí plaintext WebSocket –∫ Xray):
```nginx
server {
    listen 8448 ssl;
    http2 on;
    server_name ws.example.com;

    ssl_certificate /etc/letsencrypt/live/example.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/example.com/privkey.pem;

    location /vless-ws {
        proxy_pass http://familytraffic:8444;   # plaintext –∫ Xray
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_read_timeout 300s;
    }
}
```

**–ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π URI –¥–ª—è WebSocket:**
```
vless://${UUID}@ws.example.com:443?encryption=none&security=tls&sni=ws.example.com&fp=chrome&type=ws&path=%2Fvless-ws#username-ws
```

### 8.3 XHTTP/SplitHTTP Transport: –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Xray

**–ù–æ–≤—ã–π inbound –¥–ª—è SplitHTTP:**

```json
{
  "port": 8445,
  "protocol": "vless",
  "tag": "vless-xhttp",
  "settings": {
    "clients": [],
    "decryption": "none"
  },
  "streamSettings": {
    "network": "splithttp",
    "splithttpSettings": {
      "path": "/api/v2",
      "maxUploadSize": 1000000,
      "maxConcurrentUploads": 10,
      "minUploadIntervalMs": 0
    }
  }
}
```

**HAProxy –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** (–∫ —Ç–æ–º—É –∂–µ –µ–¥–∏–Ω–æ–º—É `nginx_tier2` backend):

```haproxy
acl is_tier2_xhttp req_ssl_sni -i xhttp.example.com
use_backend nginx_tier2 if is_tier2_xhttp
# backend nginx_tier2 —É–∂–µ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω –≤ —Å–µ–∫—Ü–∏–∏ 8.2 (shared —Å WS –∏ gRPC)
```

**Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** (TLS termination ‚Üí plaintext XHTTP –∫ Xray):
```nginx
server {
    listen 8448 ssl;
    http2 on;
    server_name xhttp.example.com;

    ssl_certificate /etc/letsencrypt/live/example.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/example.com/privkey.pem;

    location /api/v2 {
        proxy_pass http://familytraffic:8445;   # plaintext –∫ Xray
        proxy_http_version 1.1;
        proxy_set_header Connection "";
        proxy_buffering off;
        client_max_body_size 0;
        proxy_read_timeout 300s;
    }
}
```

### 8.4 gRPC Transport: –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

**–ù–æ–≤—ã–π inbound –¥–ª—è gRPC:**

```json
{
  "port": 8446,
  "protocol": "vless",
  "tag": "vless-grpc",
  "settings": {
    "clients": [],
    "decryption": "none"
  },
  "streamSettings": {
    "network": "grpc",
    "grpcSettings": {
      "serviceName": "GunService",
      "multiMode": false,
      "idle_timeout": 60,
      "health_check_timeout": 20
    },
    "security": "none"
  }
}
```

**HAProxy –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** (–∫ —Ç–æ–º—É –∂–µ `nginx_tier2` backend):

```haproxy
acl is_tier2_grpc req_ssl_sni -i grpc.example.com
use_backend nginx_tier2 if is_tier2_grpc
# backend nginx_tier2 —É–∂–µ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω –≤ —Å–µ–∫—Ü–∏–∏ 8.2 (shared —Å WS –∏ XHTTP)
```

**Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** (TLS termination + gRPC proxy ‚Üí plaintext –∫ Xray):

> **–í–∞–∂–Ω–æ:** Nginx —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 8448 (–æ–±—â–µ–º –¥–ª—è –≤—Å–µ—Ö Tier 2), —Ä–∞–∑–ª–∏—á–∞–µ—Ç —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç—ã –ø–æ `server_name`.

```nginx
server {
    listen 8448 ssl;
    http2 on;
    server_name grpc.example.com;

    ssl_certificate /etc/letsencrypt/live/example.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/example.com/privkey.pem;

    location /GunService/ {
        grpc_pass grpc://familytraffic:8446;   # plaintext gRPC –∫ Xray
        grpc_read_timeout 300s;
        grpc_send_timeout 300s;
        grpc_buffer_size 4k;
    }
}
```

---

## 9. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è

### 9.1 –¢–µ—Å—Ç-–º–∞—Ç—Ä–∏—Ü–∞ –ø–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞–º

| –¢–µ—Å—Ç-–∫–µ–π—Å | Reality+Vision | WebSocket | XHTTP | gRPC | Hysteria2 |
|-----------|---------------|-----------|-------|------|-----------|
| –ë–∞–∑–æ–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ | TC-01 | TC-10 | TC-20 | TC-30 | TC-40 |
| DPI-bypass (GFW simulation) | TC-02 | TC-11 | TC-21 | TC-31 | TC-41 |
| CDN routing | N/A | TC-12 | TC-22 | TC-32 | N/A |
| Fallback –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ –ø–∞–∫–µ—Ç–æ–≤ | TC-03 | TC-13 | TC-23 | TC-33 | TC-42 |
| Multi-user concurrency | TC-04 | TC-14 | TC-24 | TC-34 | TC-43 |
| Cert renewal –±–µ–∑ downtime | TC-05 | TC-15 | TC-25 | TC-35 | TC-44 |
| fail2ban integration | TC-06 | TC-16 | TC-26 | TC-36 | TC-45 |

### 9.2 DPI-bypass —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –∫ DPI –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ entropy –ø–µ—Ä–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ (XTLS Vision)
sudo tcpdump -i any -w /tmp/vless.pcap port 443 &
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫–ª–∏–µ–Ω—Ç–æ–º
kill %1
tshark -r /tmp/vless.pcap -Y "tls.handshake" -T fields -e tls.handshake.type

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ TLS fingerprint (uTLS)
# –°—Ä–∞–≤–Ω–∏—Ç—å JA3 hash —Å —ç—Ç–∞–ª–æ–Ω–Ω—ã–º –±—Ä–∞—É–∑–µ—Ä–Ω—ã–º fingerprint
tshark -r /tmp/vless.pcap -Y "tls.handshake.type==1" -T fields -e tls.handshake.ciphersuite

# 3. Active probing test (–ø—Ä–æ–≤–µ—Ä–∫–∞ fallback)
curl -v https://vless.example.com  # –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å fake-site –∫–æ–Ω—Ç–µ–Ω—Ç
```

### 9.3 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º —Ç–µ—Å—Ç-—Å—é–∏—Ç–æ–º

–†–∞—Å—à–∏—Ä–∏—Ç—å `tests/integration/test_security.sh`:

```bash
# –ù–æ–≤—ã–µ —Ç–µ—Å—Ç-–∫–µ–π—Å—ã –¥–ª—è –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏:
test_xtls_vision_enabled()        # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ flow field –≤ config
test_websocket_connectivity()     # WebSocket handshake —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–µ—Ä
test_xhttp_split_pattern()        # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å chunked upload/download
test_fallback_to_tcp()            # –ü—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ WebSocket ‚Üí fallback –Ω–∞ Reality
```

### 9.4 Performance benchmarks

```bash
# Latency —Ç–µ—Å—Ç –ø–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞–º
for transport in reality websocket xhttp grpc hysteria2; do
  echo "=== $transport ==="
  ping -c 10 -I proxy-$transport.example.com 8.8.8.8 2>/dev/null | tail -1
done

# Throughput —Ç–µ—Å—Ç
curl -o /dev/null -s -w "%{speed_download}" \
  --proxy "socks5://user:pass@server:1080" \
  https://speed.cloudflare.com/__down?bytes=10000000
```

---

## 10. Roadmap –∏ –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è

### 10.1 –í—Ä–µ–º–µ–Ω–Ω–∞—è —à–∫–∞–ª–∞

```
2026 Q1: Tier 1 ‚Äî XTLS Vision [‚úÖ –í–´–ü–û–õ–ù–ï–ù–û —Ä–∞–Ω—å—à–µ —Å—Ä–æ–∫–∞]
‚îú‚îÄ‚îÄ ‚úÖ v5.24+: flow=xtls-rprx-vision –¥–æ–±–∞–≤–ª–µ–Ω –≤ add_user_to_json() –∏ generate_vless_uri()
‚îú‚îÄ‚îÄ ‚úÖ v5.24+: –í—Å–µ 7 —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —É–∂–µ –∏–º–µ—é—Ç flow (–º–∏–≥—Ä–∞—Ü–∏—è –Ω–µ –ø–æ—Ç—Ä–µ–±–æ–≤–∞–ª–∞—Å—å)
‚îú‚îÄ‚îÄ ‚è≥ v5.25: –ò—Å–ø—Ä–∞–≤–∏—Ç—å validate_vless_uri() ‚Äî —É–±—Ä–∞—Ç—å flow –∏–∑ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö (–±–ª–æ–∫–∏—Ä—É–µ—Ç Tier 2)
‚îî‚îÄ‚îÄ ‚è≥ v5.25: –î–æ–±–∞–≤–∏—Ç—å test_xtls_vision_enabled() (TC-01) –≤ security_tests.sh

2026 Q2: Tier 2 ‚Äî WebSocket + XHTTP + gRPC [–¢–ï–ö–£–©–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢]
‚îú‚îÄ‚îÄ v5.30: familytraffic-nginx_tier2 –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä + WebSocket transport
‚îÇ          (lib/orchestrator.sh + haproxy_config_manager.sh + nginx_config_generator.sh)
‚îú‚îÄ‚îÄ v5.31: XHTTP/SplitHTTP transport
‚îú‚îÄ‚îÄ v5.32: gRPC transport
‚îî‚îÄ‚îÄ v5.33: CLI —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞–º–∏ (lib/transport_manager.sh) + –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

2026 Q3-Q4: Tier 3 ‚Äî UDP Protocols
‚îú‚îÄ‚îÄ v6.0: Hysteria2 opt-in –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
‚îú‚îÄ‚îÄ v6.1: TUIC v5 opt-in –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
‚îî‚îÄ‚îÄ v6.2: –ï–¥–∏–Ω—ã–π CLI –¥–ª—è transport selection

2027: Tier 4 ‚Äî SingBox
‚îú‚îÄ‚îÄ v7.0: SingBox parallel container (opt-in)
‚îú‚îÄ‚îÄ v7.1: SingBox config generator (lib/singbox_config_generator.sh)
‚îî‚îÄ‚îÄ v7.2: –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π multi-transport management
```

### 10.2 –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è –ø–æ impact/effort

```
                    HIGH IMPACT
                         ‚îÇ
  Hysteria2 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ XTLS Vision ‚Üê –ù–ê–ß–ê–¢–¨ –ó–î–ï–°–¨
  TUIC v5                ‚îÇ            XHTTP/SplitHTTP
                         ‚îÇ
–í–´–°–û–ö–ò–ï ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –ù–ò–ó–ö–ò–ï
–£–°–ò–õ–ò–Ø                   ‚îÇ                           –£–°–ò–õ–ò–Ø
                         ‚îÇ
  SingBox                ‚îÇ            WebSocket+TLS
                         ‚îÇ            gRPC
                         ‚îÇ            Trojan
                    LOW IMPACT
```

### 10.3 –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥–æ–≥–æ Tier

**Tier 1 (XTLS Vision) ‚Äî Definition of Done:**
- [x] ~~`flow: "xtls-rprx-vision"` –¥–æ–±–∞–≤–ª–µ–Ω –≤ `generate_xray_config_json()`~~ ‚Üí **–í–´–ü–û–õ–ù–ï–ù–û** (`add_user_to_json()` —Å—Ç—Ä–æ–∫–∞ 524)
- [x] ~~`flow` –¥–æ–±–∞–≤–ª–µ–Ω –≤ user management (`add_user()`)~~ ‚Üí **–í–´–ü–û–õ–ù–ï–ù–û** (—Å—Ç—Ä–æ–∫–∞ 524)
- [x] ~~VLESS URI –æ–±–Ω–æ–≤–ª—ë–Ω —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `flow=xtls-rprx-vision`~~ ‚Üí **–í–´–ü–û–õ–ù–ï–ù–û** (`generate_vless_uri()` —Å—Ç—Ä–æ–∫–∞ 834)
- [x] ~~–í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã~~ ‚Üí **–í–´–ü–û–õ–ù–ï–ù–û** (7/7 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω—ã SSH)
- [ ] `validate_vless_uri()` –∏—Å–ø—Ä–∞–≤–ª–µ–Ω ‚Äî `flow` conditional (—Ç–æ–ª—å–∫–æ –¥–ª—è `security=reality`) ‚Üê **–û–°–¢–ê–õ–û–°–¨**
- [ ] –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞: **v2rayTun** (iOS, –æ—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∏–µ–Ω—Ç), Shadowrocket, v2rayNG ‚Üê **–û–°–¢–ê–õ–û–°–¨**
- [ ] –¢–µ—Å—Ç TC-01 (`test_xtls_vision_enabled`) –¥–æ–±–∞–≤–ª–µ–Ω ‚Üê **–û–°–¢–ê–õ–û–°–¨**

**Tier 2 (–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç—ã) ‚Äî Definition of Done:**
- [ ] `familytraffic-nginx_tier2` –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ docker-compose.yml (–ù–û–í–û–ï ‚Äî –Ω–µ—Ç nginx –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)
- [ ] –ù–æ–≤—ã–µ inbound-—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `create_xray_config()` —Å —Ñ–ª–∞–≥–æ–º `enable_tier2` (plaintext, –±–µ–∑ TLS)
- [ ] `generate_tier2_nginx_config()` –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ nginx_config_generator.sh (WS + XHTTP + gRPC)
- [ ] HAProxy SNI routing ‚Üí `nginx_tier2` (–µ–¥–∏–Ω—ã–π backend –¥–ª—è –≤—Å–µ—Ö Tier 2)
- [ ] `generate_haproxy_config()` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç $6=ws, $7=xhttp, $8=grpc subdomains
- [ ] `generate_transport_uri()` –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º username ($6)
- [ ] CLI `vless add-transport` / `list-transports` / `remove-transport` —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] –¢–µ—Å—Ç TC-10 (WS), TC-20 (XHTTP), TC-30 (gRPC) –ø—Ä–æ–π–¥–µ–Ω—ã
- [ ] **iOS v2rayTun**: —Ç–µ—Å—Ç—ã iOS-10 (WS) –∏ iOS-30 (gRPC) –ø—Ä–æ–π–¥–µ–Ω—ã
- [ ] **iOS v2rayTun**: —Ç–µ—Å—Ç iOS-20 (XHTTP) –ø—Ä–æ–π–¥–µ–Ω –∏–ª–∏ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ (R11)
- [ ] Reality —Ç—Ä–∞—Ñ–∏–∫ –Ω–µ –Ω–∞—Ä—É—à–µ–Ω (—Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç)
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞: README.md, CHANGELOG.md + –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è v2rayTun

**Tier 3 (UDP) ‚Äî Definition of Done:**
- [ ] `vless install-hysteria2` wizard —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] UDP ports –±–µ–∑–æ–ø–∞—Å–Ω–æ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã (fail2ban, UFW)
- [ ] –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ SingBox format –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- [ ] –¢–µ—Å—Ç TC-40 –¥–æ TC-45 –ø—Ä–æ–π–¥–µ–Ω—ã

---

## –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ê: –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

| –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ | –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ | Reality+Vision | WS | gRPC | XHTTP | Hysteria2 | TUIC | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
|-----------|-----------|:-:|:-:|:-:|:-:|:-:|:-:|---|
| **iOS** | **v2rayTun 2.4.4** | ‚úÖ | ‚úÖ | ‚úÖ | ‚ö†Ô∏è | ‚úó | ‚úó | **–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –∫–ª–∏–µ–Ω—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—Ä–æ–µ–∫—Ç–∞**; Xray-core 25.10.15; XHTTP —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ |
| iOS | Shadowrocket | ‚úÖ | ‚úÖ | ‚úÖ | ‚ö†Ô∏è | ‚úó | ‚úó | –ü–ª–∞—Ç–Ω—ã–π ($2.99) |
| iOS | Sing-Box | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π, –≤—Å–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã |
| Android | v2rayNG | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úó | ‚úó | |
| Android | Sing-Box / NekoBox | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | |
| Windows | v2rayN | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úó | |
| macOS | ClashX Pro | ‚úÖ | ‚úÖ | ‚úÖ | ‚úó | ‚úó | ‚úó | |
| macOS/Linux | Sing-Box CLI | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | |
| Linux | Xray CLI | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úó | ‚úó | |

> ‚ö†Ô∏è **XHTTP –Ω–∞ iOS (v2rayTun):** –ü–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω –Ω–∞ Android v3.9.34 (–∞–≤–≥—É—Å—Ç 2024). iOS-–ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ —è–≤–Ω–æ ‚Äî —Ç—Ä–µ–±—É–µ—Ç —Ä—É—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ Tier 2.

## –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ë: –ü–æ–ª–µ–∑–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- **Xray-core –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** https://xtls.github.io/
- **SingBox –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** https://sing-box.sagernet.org/
- **Hysteria2 –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** https://v2.hysteria.network/
- **TUIC v5 —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** https://github.com/EAimTY/tuic
- **Reality Protocol:** https://github.com/XTLS/REALITY
- **GFW Report (–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è):** https://gfw.report/

---

**–ù–∞–≤–∏–≥–∞—Ü–∏—è:** [–û–±–∑–æ—Ä](01_overview.md) | [–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è](02_functional_requirements.md) | [NFR](03_nfr.md) | [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](04_architecture.md) | [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](05_testing.md) | [–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è](06_appendix.md) | [–û–±—Ñ—É—Å–∫–∞—Ü–∏—è](07_obfuscation_enhancement.md)

---

*–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω: 2026-02-20. –í–µ—Ä—Å–∏—è –ø—Ä–æ–µ–∫—Ç–∞: v5.24.*
*–û–±–Ω–æ–≤–ª—ë–Ω: 2026-02-23 ‚Äî SSH-–≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞ ikenibornvpn. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã: —Å—Ç–∞—Ç—É—Å Tier 1 (‚Üí –†–ï–ê–õ–ò–ó–û–í–ê–ù–û), –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Tier 2 (Nginx tier2 –≤–º–µ—Å—Ç–æ HAProxy TLS termination), gap-–∞–Ω–∞–ª–∏–∑ —Å–µ–∫—Ü–∏–∏ 5.2, —Ä–∏—Å–∫ R6 (‚Üí –∑–∞–∫—Ä—ã—Ç), timeline 10.1.*
*–û–±–Ω–æ–≤–ª—ë–Ω: 2026-02-22 ‚Äî –î–æ–±–∞–≤–ª–µ–Ω –∞–Ω–∞–ª–∏–∑ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ iOS –∫–ª–∏–µ–Ω—Ç–∞ v2rayTun (—Ä–∞–∑–¥–µ–ª 6.4 + –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ê). v2rayTun v2.4.4, Xray-core 25.10.15. XTLS Vision ‚úÖ, WS ‚úÖ, gRPC ‚úÖ, XHTTP ‚ö†Ô∏è.*
*–ê–≤—Ç–æ—Ä: Agent-Orchestrator Pipeline + live-server SSH verification.*
