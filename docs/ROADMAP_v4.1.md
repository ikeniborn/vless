# VLESS Reality VPN - Roadmap v4.1
## –î–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –¥–æ—Ä–∞–±–æ—Ç–æ–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ PRD v4.0

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-10-07
**–ë–∞–∑–æ–≤–∞—è –≤–µ—Ä—Å–∏—è:** v4.0 (stunnel integration)
**–¶–µ–ª–µ–≤–∞—è –≤–µ—Ä—Å–∏—è:** v4.1 (alignment + improvements)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** Documentation alignment + Optional code improvements

---

## üìã EXECUTIVE SUMMARY

**–í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**
- üî¥ 5 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π –º–µ–∂–¥—É PRD –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π
- üü° 3 —Å—Ä–µ–¥–Ω–∏—Ö –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- üü¢ 2 –∫–æ—Å–º–µ—Ç–∏—á–µ—Å–∫–∏—Ö —É–ª—É—á—à–µ–Ω–∏—è

**–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞:**
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** 10 –∑–∞–¥–∞—á (~8 —á–∞—Å–æ–≤)
- **–ö–æ–¥ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):** 3 –∑–∞–¥–∞—á–∏ (~12 —á–∞—Å–æ–≤)
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** 2 –∑–∞–¥–∞—á–∏ (~4 —á–∞—Å–∞)

**–û–±—â–∏–π –æ–±—ä–µ–º:** 15 –∑–∞–¥–∞—á, ~24 —á–∞—Å–∞ —Ä–∞–±–æ—Ç—ã

---

## üéØ –§–ê–ó–´ –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

### PHASE 1: Documentation Alignment (MANDATORY)
**–¶–µ–ª—å:** –ü—Ä–∏–≤–µ—Å—Ç–∏ PRD –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ CRITICAL
**–°—Ä–æ–∫:** 2-3 –¥–Ω—è
**–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã:** 6-8 —á–∞—Å–æ–≤

### PHASE 2: Code Improvements (OPTIONAL)
**–¶–µ–ª—å:** –ó–∞–≤–µ—Ä—à–∏—Ç—å template-based –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° MEDIUM
**–°—Ä–æ–∫:** 5-7 –¥–Ω–µ–π
**–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã:** 10-12 —á–∞—Å–æ–≤

### PHASE 3: Testing & Validation (MANDATORY)
**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∫–æ–¥–∞ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ HIGH
**–°—Ä–æ–∫:** 2 –¥–Ω—è
**–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã:** 3-4 —á–∞—Å–∞

---

## üìù PHASE 1: DOCUMENTATION ALIGNMENT

### EPIC-1: PRD Document Updates
**–û–ø–∏—Å–∞–Ω–∏–µ:** –û–±–Ω–æ–≤–∏—Ç—å PRD.md –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ä–µ–∞–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ v4.0
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ CRITICAL
**–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã:** 6-8 —á–∞—Å–æ–≤

---

#### TASK-1.1: –û–±–Ω–æ–≤–∏—Ç—å FR-TEMPLATE-001 (templates status)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ HIGH
**–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã:** 1 —á–∞—Å
**–§–∞–π–ª:** PRD.md (—Å—Ç—Ä–æ–∫–∏ 288-351)

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–û–±–Ω–æ–≤–∏—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ template-based –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è –æ—Ç—Ä–∞–∂–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (—Ç–æ–ª—å–∫–æ stunnel template).

**Acceptance Criteria:**
- [ ] –¢–∞–±–ª–∏—Ü–∞ "Required Templates" –æ–±–Ω–æ–≤–ª–µ–Ω–∞ (stunnel ‚úÖ, xray ‚ùå, docker-compose ‚ùå)
- [ ] –î–æ–±–∞–≤–ª–µ–Ω "Implementation Status" —Å—Ç–æ–ª–±–µ—Ü
- [ ] –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–µ–∫—Ü–∏—è "Rationale for partial implementation"
- [ ] –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
```markdown
### FR-TEMPLATE-001: Template-Based Configuration (PARTIAL)

**Implementation Status:** ‚ö†Ô∏è PARTIALLY IMPLEMENTED (stunnel only)

**Required Templates:**

| Template File | Purpose | Status | Rationale |
|---------------|---------|--------|-----------|
| `stunnel.conf.template` | stunnel TLS configuration | ‚úÖ IMPLEMENTED | Simple static config, ideal for templates |
| ~~`xray_config.json.template`~~ | ~~Xray configuration~~ | ‚ùå NOT IMPLEMENTED | Complex dynamic config with user arrays, heredoc more maintainable |
| ~~`docker-compose.yml.template`~~ | ~~Container orchestration~~ | ‚ùå NOT IMPLEMENTED | Conditional logic, heredoc easier than template engine |

**Rationale for Partial Implementation:**
- stunnel configuration is static and benefits from template approach
- Xray config requires dynamic user array generation (jq + heredoc more flexible)
- docker-compose has complex conditional logic (ENABLE_PUBLIC_PROXY, ENABLE_PROXY_TLS)
- Future: May migrate to templates when advanced template engine added (envsubst limitations)
```

**Dependencies:** None
**Risk Level:** LOW (documentation only)

---

#### TASK-1.2: –£–¥–∞–ª–∏—Ç—å FR-TLS-001 (deprecated v3.x section)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ HIGH
**–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã:** 30 –º–∏–Ω—É—Ç
**–§–∞–π–ª:** PRD.md (—Å—Ç—Ä–æ–∫–∏ 354-397)

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–£–¥–∞–ª–∏—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–π —Ä–∞–∑–¥–µ–ª FR-TLS-001 (Xray TLS streamSettings), –∫–æ—Ç–æ—Ä—ã–π deprecated –≤ v4.0.

**Acceptance Criteria:**
- [ ] –†–∞–∑–¥–µ–ª FR-TLS-001 –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–µ–Ω
- [ ] FR-TLS-002 (HTTP TLS) —Ç–æ–∂–µ —É–¥–∞–ª–µ–Ω (—Ç–∞–∫–∂–µ deprecated)
- [ ] –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Å—ã–ª–∫–∞ –Ω–∞ FR-STUNNEL-001 –≤ –º–µ—Å—Ç–∞—Ö –≥–¥–µ —É–ø–æ–º–∏–Ω–∞–ª—Å—è FR-TLS-001
- [ ] –û–±–Ω–æ–≤–ª–µ–Ω–∞ –Ω—É–º–µ—Ä–∞—Ü–∏—è –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö —Ä–∞–∑–¥–µ–ª–æ–≤

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω legacy reference):**
- –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤ "Appendix A: v3.x Legacy Configuration"
- –î–æ–±–∞–≤–∏—Ç—å WARNING banner: "‚ö†Ô∏è This configuration is deprecated in v4.0"

**Dependencies:** None
**Risk Level:** LOW

---

#### TASK-1.3: –û–±–Ω–æ–≤–∏—Ç—å File Structure (section 4.4)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ HIGH
**–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã:** 45 –º–∏–Ω—É—Ç
**–§–∞–π–ª:** PRD.md (—Å—Ç—Ä–æ–∫–∏ 1218-1264)

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–û–±–Ω–æ–≤–∏—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–ª—è v4.0 (stunnel.conf, plaintext Xray).

**Acceptance Criteria:**
- [ ] `xray_config.json` –æ–ø–∏—Å–∞–Ω –∫–∞–∫ "plaintext inbounds" (–Ω–µ TLS)
- [ ] `stunnel.conf` –¥–æ–±–∞–≤–ª–µ–Ω –≤ `/opt/vless/config/`
- [ ] –£–¥–∞–ª–µ–Ω–æ —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ `/etc/letsencrypt` –≤ Xray –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
- [ ] –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø—Ä–æ stunnel TLS termination

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
```markdown
/opt/vless/
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îú‚îÄ‚îÄ xray_config.json        # 3 inbounds: VLESS (Reality), SOCKS5 (plaintext), HTTP (plaintext)
‚îÇ   ‚îÇ                           # Proxy inbounds listen on 127.0.0.1:10800/18118 (stunnel handles TLS)
‚îÇ   ‚îú‚îÄ‚îÄ stunnel.conf            # NEW in v4.0: TLS termination for proxy ports
‚îÇ   ‚îî‚îÄ‚îÄ users.json              # v1.2 with proxy_password (32 chars) + allowed_ips (deprecated)
```

**Dependencies:** TASK-1.1, TASK-1.2
**Risk Level:** LOW

---

#### TASK-1.4: –û–±–Ω–æ–≤–∏—Ç—å Docker Compose example (section 4.5)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ HIGH
**–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã:** 1 —á–∞—Å
**–§–∞–π–ª:** PRD.md (—Å—Ç—Ä–æ–∫–∏ 1268-1313)

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–û–±–Ω–æ–≤–∏—Ç—å docker-compose.yml –ø—Ä–∏–º–µ—Ä –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è stunnel —Å–µ—Ä–≤–∏—Å–∞.

**Acceptance Criteria:**
- [ ] –î–æ–±–∞–≤–ª–µ–Ω `stunnel` —Å–µ—Ä–≤–∏—Å –≤ docker-compose –ø—Ä–∏–º–µ—Ä
- [ ] –£–¥–∞–ª–µ–Ω–æ `/etc/letsencrypt` –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑ Xray —Å–µ—Ä–≤–∏—Å–∞
- [ ] –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ—Ä—Ç—ã 1080/8118 –≤ stunnel
- [ ] –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–µ—Ç—å `vless_reality_net` (–≤–º–µ—Å—Ç–æ `network_mode: host`)
- [ ] –î–æ–±–∞–≤–ª–µ–Ω `depends_on: xray` –¥–ª—è stunnel

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
```yaml
version: '3.8'

services:
  stunnel:
    image: dweomer/stunnel:latest
    container_name: vless_stunnel
    restart: unless-stopped
    ports:
      - "1080:1080"   # SOCKS5 TLS termination
      - "8118:8118"   # HTTP TLS termination
    volumes:
      - ./config/stunnel.conf:/etc/stunnel/stunnel.conf:ro
      - ./certs:/certs:ro  # Let's Encrypt certificates
      - ./logs/stunnel:/var/log/stunnel
    networks:
      - vless_reality_net
    depends_on:
      - xray

  xray:
    image: teddysun/xray:24.11.30
    container_name: vless_xray
    restart: unless-stopped
    networks:
      - vless_reality_net
    ports:
      - "443:443"     # VLESS Reality
    volumes:
      - ./config:/etc/xray:ro
      # NOTE: Certificates mounted to stunnel, NOT Xray (v4.0 architecture)

networks:
  vless_reality_net:
    driver: bridge
```

**Dependencies:** TASK-1.3
**Risk Level:** LOW

---

#### TASK-1.5: –î–æ–±–∞–≤–∏—Ç—å plaintext inbound –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (FR-STUNNEL-001)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ MEDIUM
**–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã:** 15 –º–∏–Ω—É—Ç
**–§–∞–π–ª:** PRD.md (—Å—Ç—Ä–æ–∫–∏ 242-255)

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–î–æ–±–∞–≤–∏—Ç—å —è–≤–Ω—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –≤ Xray inbound example –ø—Ä–æ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ streamSettings.

**Acceptance Criteria:**
- [ ] –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–æ–±–∞–≤–ª–µ–Ω –ø–æ—Å–ª–µ `settings` –±–ª–æ–∫–∞
- [ ] –£–ø–æ–º–∏–Ω–∞–µ—Ç—Å—è —á—Ç–æ stunnel –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç TLS
- [ ] –£–ø–æ–º–∏–Ω–∞–µ—Ç—Å—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: stunnel (1080) ‚Üí Xray (10800 plaintext)

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
```json
{
  "tag": "socks5-plaintext",
  "listen": "127.0.0.1",
  "port": 10800,
  "protocol": "socks",
  "settings": {
    "auth": "password",
    "accounts": [{"user": "username", "pass": "password"}],
    "udp": false
  }
  // CRITICAL: NO streamSettings.security field - this is a PLAINTEXT inbound
  // TLS termination is handled by stunnel container on public port 1080
  // Architecture: Client ‚Üí stunnel (TLS on 1080) ‚Üí Xray (plaintext on 10800) ‚Üí Internet
}
```

**Dependencies:** TASK-1.2
**Risk Level:** LOW

---

#### TASK-1.6: –î–æ–±–∞–≤–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É SOCKS5 —Å—Ö–µ–º (–ø–æ—Å–ª–µ FR-CONFIG-001)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° MEDIUM
**–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã:** 30 –º–∏–Ω—É—Ç
**–§–∞–π–ª:** PRD.md (–ø–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ 650)

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–î–æ–±–∞–≤–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º —Ä–∞–∑–ª–∏—á–∏–π –º–µ–∂–¥—É socks5://, socks5s://, socks5h://.

**Acceptance Criteria:**
- [ ] –¢–∞–±–ª–∏—Ü–∞ –≤—Å—Ç–∞–≤–ª–µ–Ω–∞ –ø–æ—Å–ª–µ –æ–ø–∏—Å–∞–Ω–∏—è config files
- [ ] –û–±—ä—è—Å–Ω–µ–Ω—ã –≤—Å–µ 3 —Å—Ö–µ–º—ã
- [ ] –£–∫–∞–∑–∞–Ω–æ —á—Ç–æ socks5s:// PRIMARY –¥–ª—è v4.0
- [ ] –î–æ–±–∞–≤–ª–µ–Ω–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–æ socks5h:// (NO TLS)

**–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:**
```markdown
### SOCKS5 URI Schemes Explained

When configuring proxy clients, you may encounter different SOCKS5 URI schemes. Here's what they mean:

| Scheme | TLS Encryption | DNS Resolution | Description | v4.0 Usage |
|--------|----------------|----------------|-------------|------------|
| `socks5://` | ‚ùå None | Local | Plain SOCKS5 (no encryption) | ‚ùå NOT USED (deprecated, localhost-only in v3.1) |
| `socks5s://` | ‚úÖ TLS 1.3 | Local | SOCKS5 with TLS encryption | ‚úÖ **PRIMARY** - Use this for all v4.0 configs |
| `socks5h://` | ‚ùå None | Via Proxy | SOCKS5 with DNS resolution via proxy | ‚ö†Ô∏è **OPTIONAL** - Use ONLY for DNS privacy (does NOT provide TLS) |

**Key Points:**
- **`socks5s://`** - The "s" suffix means **SSL/TLS** encryption (like https://)
- **`socks5h://`** - The "h" suffix means **hostname** (DNS resolution via proxy, NOT TLS)
- **v4.0 Recommendation:** Always use `socks5s://` for public proxy connections
- **DNS Privacy:** If you need both TLS + DNS via proxy, Git does NOT support combined `socks5sh://` - use stunnel-based setup

**Example Confusion (Git config):**
```bash
# ‚úÖ CORRECT: TLS encryption
git config http.proxy socks5s://user:pass@server:1080

# ‚ö†Ô∏è WRONG: NO TLS (only DNS privacy)
git config http.proxy socks5h://user:pass@server:1080
# This is NOT secure for public proxies - credentials transmitted in plaintext!
```
```

**Dependencies:** None
**Risk Level:** LOW

---

#### TASK-1.7: –£—Ç–æ—á–Ω–∏—Ç—å Git config –ø—Ä–∏–º–µ—Ä (socks5h warning)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° MEDIUM
**–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã:** 15 –º–∏–Ω—É—Ç
**–§–∞–π–ª:** PRD.md (—Å—Ç—Ä–æ–∫–∏ 684, 764)

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –≤ Git config –ø—Ä–∏–º–µ—Ä—ã –ø—Ä–æ socks5h:// (NO TLS).

**Acceptance Criteria:**
- [ ] –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–æ–±–∞–≤–ª–µ–Ω –∫ socks5h:// –ø—Ä–∏–º–µ—Ä—É
- [ ] –û–±—ä—è—Å–Ω–µ–Ω–æ —á—Ç–æ socks5h –ù–ï –∑–∞–º–µ–Ω—è–µ—Ç TLS
- [ ] –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å socks5s:// –∫–∞–∫ primary

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
```diff
# Configure Git to use SOCKS5 with TLS (PRIMARY - RECOMMENDED)
git config --global http.proxy socks5s://alice:PASSWORD@server:1080

- # Alternative: Use socks5h:// for DNS resolution via proxy
+ # Alternative: DNS resolution via proxy (‚ö†Ô∏è NO TLS ENCRYPTION)
git config --global http.proxy socks5h://alice:PASSWORD@server:1080
+ # ‚ö†Ô∏è WARNING: socks5h:// does NOT provide TLS encryption!
+ # Use ONLY if:
+ #   - DNS privacy is required (prevent DNS leaks)
+ #   - You trust the network path between you and the proxy server
+ # For internet proxies, ALWAYS prefer socks5s:// (TLS encrypted)
```

**Dependencies:** TASK-1.6
**Risk Level:** LOW

---

#### TASK-1.8: –û–±–Ω–æ–≤–∏—Ç—å "What's New in v4.0" —Å—Ç–∞—Ç—É—Å—ã
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° LOW
**–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã:** 20 –º–∏–Ω—É—Ç
**–§–∞–π–ª:** PRD.md (—Å—Ç—Ä–æ–∫–∏ 47-97)

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–î–æ–±–∞–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (‚úÖ/‚ö†Ô∏è) –≤ —Ç–∞–±–ª–∏—Ü—É –∏–∑–º–µ–Ω–µ–Ω–∏–π v4.0.

**Acceptance Criteria:**
- [ ] –°—Ç–æ–ª–±–µ—Ü "Status" –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Ç–∞–±–ª–∏—Ü—É
- [ ] ‚úÖ –¥–ª—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø—É–Ω–∫—Ç–æ–≤
- [ ] ‚ö†Ô∏è –¥–ª—è —á–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö
- [ ] Footnote –æ–±—ä—è—Å–Ω—è–µ—Ç —á–∞—Å—Ç–∏—á–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é

**Dependencies:** TASK-1.1
**Risk Level:** LOW

---

#### TASK-1.9: –û–±–Ω–æ–≤–∏—Ç—å –≤–µ—Ä—Å–∏—é –¥–æ–∫—É–º–µ–Ω—Ç–∞
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ LOW
**–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã:** 5 –º–∏–Ω—É—Ç
**–§–∞–π–ª:** PRD.md (—Å—Ç—Ä–æ–∫–∏ 3-6)

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–û–±–Ω–æ–≤–∏—Ç—å –≤–µ—Ä—Å–∏—é PRD —Å 4.0 –Ω–∞ 4.1.

**Acceptance Criteria:**
- [ ] Version: 4.1
- [ ] Date: 2025-10-07
- [ ] Status: Partially Implemented (stunnel ‚úÖ, templates ‚ö†Ô∏è)

**Dependencies:** TASK-1.1 - TASK-1.8
**Risk Level:** NONE

---

#### TASK-1.10: –î–æ–±–∞–≤–∏—Ç—å Implementation Status —Å–µ–∫—Ü–∏—é
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ LOW
**–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã:** 30 –º–∏–Ω—É—Ç
**–§–∞–π–ª:** PRD.md (–ø–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ 23)

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–î–æ–±–∞–≤–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≤—Å–µ—Ö —Ñ–∏—á v4.0.

**Acceptance Criteria:**
- [ ] –¢–∞–±–ª–∏—Ü–∞ –≤—Å—Ç–∞–≤–ª–µ–Ω–∞ –ø–æ—Å–ª–µ Document Control
- [ ] –í—Å–µ —Ñ–∏—á–∏ v4.0 –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã
- [ ] –°—Ç–∞—Ç—É—Å—ã: ‚úÖ COMPLETE / ‚ö†Ô∏è PARTIAL / ‚ùå NOT IMPLEMENTED
- [ ] –°—Å—ã–ª–∫–∏ –Ω–∞ PRD —Ä–∞–∑–¥–µ–ª—ã
- [ ] –ü—Ä–æ—Ü–µ–Ω—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (Overall Status)

**–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:** —Å–º. docs/PRD_UPDATE_v4.1.md —Ä–∞–∑–¥–µ–ª "Implementation Status"

**Dependencies:** TASK-1.1 - TASK-1.9
**Risk Level:** LOW

---

## üîß PHASE 2: CODE IMPROVEMENTS (OPTIONAL)

### EPIC-2: Complete Template-Based Configuration
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–≤–µ—Ä—à–∏—Ç—å template-based –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (Xray + docker-compose)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° MEDIUM (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
**–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã:** 10-12 —á–∞—Å–æ–≤

**Rationale:**
- ‚úÖ PRO: Cleaner code, easier version control, separation of config and logic
- ‚ö†Ô∏è CON: Increased complexity, testing overhead, backward compatibility
- üí° DECISION: Optional improvement (current heredoc approach works fine)

---

#### TASK-2.1: Create xray_config.json.template
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° MEDIUM (optional)
**–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã:** 4 —á–∞—Å–∞
**–§–∞–π–ª—ã:** templates/xray_config.json.template, lib/orchestrator.sh

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–°–æ–∑–¥–∞—Ç—å template –¥–ª—è Xray –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ user array.

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:**

**–ü—Ä–æ–±–ª–µ–º–∞:**
- Xray config —Å–æ–¥–µ—Ä–∂–∏—Ç –º–∞—Å—Å–∏–≤ users (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π)
- envsubst –ù–ï –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ü–∏–∫–ª—ã/–º–∞—Å—Å–∏–≤—ã
- –ù—É–∂–µ–Ω –±–æ–ª–µ–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π template engine (j2cli, mustache, –∏–ª–∏ custom bash)

**–†–µ—à–µ–Ω–∏—è:**

**Option A: jinja2-cli (Python)**
```bash
pip install jinja2-cli

# Template: xray_config.json.j2
{
  "inbounds": [
    {
      "settings": {
        "clients": [
          {% for user in users %}
          {"id": "{{ user.uuid }}", "email": "{{ user.username }}@vless.local"}{% if not loop.last %},{% endif %}
          {% endfor %}
        ]
      }
    }
  ]
}

# Generation:
jinja2 xray_config.json.j2 -D users="$(jq '.users' users.json)" > xray_config.json
```

**Option B: Custom bash script**
```bash
# Generate clients array from users.json
CLIENTS=$(jq -r '.users[] | "{\\"id\\": \\"\(.uuid)\\", \\"email\\": \\"\(.username)@vless.local\\"}"' users.json | jq -s .)

# Substitute into template
export CLIENTS
envsubst '$CLIENTS' < xray_config.json.template > xray_config.json
```

**Acceptance Criteria:**
- [ ] `templates/xray_config.json.template` —Å–æ–∑–¥–∞–Ω
- [ ] Template –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: VLESS_PORT, DOMAIN, DEST_SITE
- [ ] Template –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π users array
- [ ] `lib/orchestrator.sh` –æ–±–Ω–æ–≤–ª–µ–Ω (heredoc –∑–∞–º–µ–Ω–µ–Ω –Ω–∞ template generation)
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: config –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –¥–ª—è 0, 1, 10 users
- [ ] Backward compatibility: —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∏–Ω—Å—Ç–∞–ª–ª—è—Ü–∏–∏ –º–∏–≥—Ä–∏—Ä—É—é—Ç –±–µ–∑ –æ—à–∏–±–æ–∫

**Dependencies:** None
**Risk Level:** MEDIUM (—Ç—Ä–µ–±—É–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
**Effort vs Benefit:** LOW (—Ç–µ–∫—É—â–∏–π –ø–æ–¥—Ö–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö–æ—Ä–æ—à–æ)

---

#### TASK-2.2: Create docker-compose.yml.template
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° LOW (optional)
**–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã:** 3 —á–∞—Å–∞
**–§–∞–π–ª—ã:** templates/docker-compose.yml.template, lib/orchestrator.sh

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–°–æ–∑–¥–∞—Ç—å template –¥–ª—è docker-compose —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —É—Å–ª–æ–≤–Ω–æ–π –ª–æ–≥–∏–∫–∏.

**–ü—Ä–æ–±–ª–µ–º–∞:**
- docker-compose —Å–æ–¥–µ—Ä–∂–∏—Ç —É—Å–ª–æ–≤–Ω—É—é –ª–æ–≥–∏–∫—É (ENABLE_PUBLIC_PROXY, ENABLE_PROXY_TLS)
- envsubst –ù–ï –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç if/else
- –ù—É–∂–µ–Ω –ª–∏–±–æ –±–æ–ª–µ–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π engine, –ª–∏–±–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ template –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤

**–†–µ—à–µ–Ω–∏—è:**

**Option A: Multiple templates**
```
templates/
‚îú‚îÄ‚îÄ docker-compose.base.yml.template        # –ë–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ docker-compose.proxy-public.yml.template  # –° public proxy
‚îî‚îÄ‚îÄ docker-compose.proxy-tls.yml.template     # –° TLS
```

**Option B: Comment-based conditional**
```yaml
# Template with commented sections
services:
  xray: ...

  # PROXY_ENABLED: Uncomment if ENABLE_PUBLIC_PROXY=true
  # stunnel:
  #   image: dweomer/stunnel:latest
  #   ...

# Generation script removes comment markers based on conditions
```

**Acceptance Criteria:**
- [ ] Template(s) —Å–æ–∑–¥–∞–Ω—ã
- [ ] –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: docker-compose up —É—Å–ø–µ—à–µ–Ω
- [ ] Migration path –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∏–Ω—Å—Ç–∞–ª–ª—è—Ü–∏–π

**Dependencies:** None
**Risk Level:** MEDIUM
**Effort vs Benefit:** VERY LOW (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)

---

#### TASK-2.3: Update orchestrator.sh –¥–ª—è template generation
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° LOW (optional)
**–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã:** 3-4 —á–∞—Å–∞
**–§–∞–π–ª—ã:** lib/orchestrator.sh

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–û–±–Ω–æ–≤–∏—Ç—å orchestrator.sh –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥–æ–≤ –∏–∑ templates.

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** TASK-2.1, TASK-2.2

**Acceptance Criteria:**
- [ ] –§—É–Ω–∫—Ü–∏—è `generate_xray_config_from_template()`
- [ ] –§—É–Ω–∫—Ü–∏—è `generate_docker_compose_from_template()`
- [ ] Fallback –Ω–∞ heredoc –µ—Å–ª–∏ template –Ω–µ –Ω–∞–π–¥–µ–Ω (backward compatibility)
- [ ] Unit —Ç–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç template generation
- [ ] Integration —Ç–µ—Å—Ç: –ø–æ–ª–Ω–∞—è –∏–Ω—Å—Ç–∞–ª–ª—è—Ü–∏—è —á–µ—Ä–µ–∑ templates

**Risk Level:** MEDIUM
**Effort vs Benefit:** LOW

**RECOMMENDATION:** ‚ùå **SKIP Phase 2** (current implementation sufficient)

---

## üß™ PHASE 3: TESTING & VALIDATION

### EPIC-3: Documentation & Code Alignment Tests
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∫–æ–¥–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ HIGH (mandatory after Phase 1)
**–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã:** 3-4 —á–∞—Å–∞

---

#### TASK-3.1: PRD Alignment Checklist
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ HIGH
**–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã:** 1 —á–∞—Å
**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:** Manual checklist

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ PRD —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ä–µ–∞–ª—å–Ω–æ–º—É –∫–æ–¥—É.

**Acceptance Criteria:**
- [ ] –í—Å–µ –ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞ –≤ PRD —Ä–∞–±–æ—Ç–∞—é—Ç (copy-paste test)
- [ ] –í—Å–µ file paths –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
- [ ] –í—Å–µ —É–ø–æ–º—è–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç
- [ ] –ù–µ—Ç —É–ø–æ–º–∏–Ω–∞–Ω–∏–π deprecated —Ñ–∏—á (v3.x TLS)
- [ ] –í—Å–µ URI schemes –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã (socks5s://, https://)

**–ß–µ–∫-–ª–∏—Å—Ç:**
```markdown
### PRD Section Validation

#### FR-STUNNEL-001 (stunnel TLS termination)
- [ ] stunnel.conf.template —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- [ ] –ü—Ä–∏–º–µ—Ä stunnel.conf —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–º—É —Ñ–∞–π–ª—É
- [ ] –ü–æ—Ä—Ç—ã 1080/8118 –æ–ø–∏—Å–∞–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (stunnel ‚Üí Xray) –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞

#### FR-CONFIG-001 (client configs)
- [ ] socks5_config.txt –∏—Å–ø–æ–ª—å–∑—É–µ—Ç socks5s:// (public mode)
- [ ] http_config.txt –∏—Å–ø–æ–ª—å–∑—É–µ—Ç https:// (public mode)
- [ ] –í—Å–µ 6 config —Ñ–∞–π–ª–æ–≤ –æ–ø–∏—Å–∞–Ω—ã
- [ ] SOCKS5 schemes —Ç–∞–±–ª–∏—Ü–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞

#### Docker Compose (section 4.5)
- [ ] stunnel —Å–µ—Ä–≤–∏—Å –¥–æ–±–∞–≤–ª–µ–Ω
- [ ] Xray –ù–ï –º–æ–Ω—Ç–∏—Ä—É–µ—Ç /etc/letsencrypt
- [ ] –°–µ—Ç—å vless_reality_net –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

#### File Structure (section 4.4)
- [ ] stunnel.conf —É–ø–æ–º—è–Ω—É—Ç
- [ ] xray_config.json –æ–ø–∏—Å–∞–Ω –∫–∞–∫ plaintext
- [ ] –ù–µ—Ç —É–ø–æ–º–∏–Ω–∞–Ω–∏–π TLS –≤ streamSettings
```

**Dependencies:** TASK-1.1 - TASK-1.10
**Risk Level:** LOW

---

#### TASK-3.2: End-to-End Config Generation Test
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ HIGH
**–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã:** 2-3 —á–∞—Å–∞
**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:** Automated test script

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ—Å—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤—Å–µ—Ö –∫–æ–Ω—Ñ–∏–≥–æ–≤ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ URI schemes.

**Test Script:** `tests/test_config_generation_e2e.sh`

**Scenarios:**

**Scenario 1: Localhost mode (ENABLE_PUBLIC_PROXY=false)**
```bash
ENABLE_PUBLIC_PROXY=false
DOMAIN=""

# Expected output:
socks5_config.txt: socks5://user:pass@127.0.0.1:1080
http_config.txt: http://user:pass@127.0.0.1:8118
```

**Scenario 2: Public mode with TLS (ENABLE_PUBLIC_PROXY=true, DOMAIN set)**
```bash
ENABLE_PUBLIC_PROXY=true
DOMAIN="vpn.example.com"

# Expected output:
socks5_config.txt: socks5s://user:pass@vpn.example.com:1080
http_config.txt: https://user:pass@vpn.example.com:8118
vscode_settings.json: "http.proxy": "https://vpn.example.com:8118"
```

**Acceptance Criteria:**
- [ ] Test script —Å–æ–∑–¥–∞–Ω –≤ `tests/`
- [ ] –í—Å–µ scenarios –ø–æ–∫—Ä—ã—Ç—ã
- [ ] Test –ø—Ä–æ—Ö–æ–¥–∏—Ç –¥–ª—è —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- [ ] CI/CD –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (GitHub Actions / GitLab CI)

**Dependencies:** TASK-3.1
**Risk Level:** LOW

---

## üìä SUMMARY & RECOMMENDATIONS

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞

| Phase | Epic | Tasks | Priority | Effort | Benefit | Recommendation |
|-------|------|-------|----------|--------|---------|----------------|
| **Phase 1** | Documentation | 10 tasks | üî¥ CRITICAL | 6-8h | HIGH | ‚úÖ **DO IMMEDIATELY** |
| **Phase 2** | Code (templates) | 3 tasks | üü° MEDIUM | 10-12h | LOW | ‚ùå **SKIP** (not worth it) |
| **Phase 3** | Testing | 2 tasks | üî¥ HIGH | 3-4h | HIGH | ‚úÖ **DO AFTER Phase 1** |

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

#### Week 1: Documentation Update
```
Day 1-2: TASK-1.1 - TASK-1.5 (critical PRD fixes)
Day 3: TASK-1.6 - TASK-1.10 (improvements + versioning)
Day 4: TASK-3.1 (validation checklist)
Day 5: TASK-3.2 (E2E tests)
```

#### Optional (Future): Code Improvements
```
SKIP Phase 2 - current heredoc approach is sufficient
Reconsider when:
  - Config becomes significantly more complex
  - Need multi-environment support (dev/staging/prod)
  - Community requests template-based customization
```

### Success Criteria (Phase 1 + Phase 3)

‚úÖ **Documentation aligned with v4.0 reality**
- PRD describes actual implementation (not aspirational)
- No mentions of unimplemented features as "implemented"
- Clear distinction between v3.x (deprecated) and v4.0 (current)

‚úÖ **All examples work**
- Code snippets can be copy-pasted without modification
- File paths are correct
- URI schemes match actual generated configs

‚úÖ **Tests validate alignment**
- Automated E2E test confirms PRD examples
- Checklist confirms all PRD sections accurate

---

## üìÖ TIMELINE

### Sprint 1: Documentation Alignment (Week 1)
```
Mon:  TASK-1.1, TASK-1.2 (2h) ‚úÖ
Tue:  TASK-1.3, TASK-1.4 (2h) ‚úÖ
Wed:  TASK-1.5, TASK-1.6, TASK-1.7 (1.5h) ‚úÖ
Thu:  TASK-1.8, TASK-1.9, TASK-1.10 (1h) ‚úÖ
Fri:  TASK-3.1, TASK-3.2 (3h) ‚úÖ

Total: 9.5 hours over 5 days
```

### Optional Sprint 2: Code Templates (Future)
```
DEFERRED - reassess in Q2 2025
```

---

## üéØ ACCEPTANCE CRITERIA (Overall)

**Phase 1 Complete When:**
- [ ] All 10 documentation tasks completed
- [ ] PRD version bumped to v4.1
- [ ] Document Control updated with v4.1 entry
- [ ] All references to v3.x TLS removed

**Phase 3 Complete When:**
- [ ] Validation checklist 100% passed
- [ ] E2E test script created and passing
- [ ] No discrepancies between PRD and code

**Project Success When:**
- [ ] PRD accurately describes v4.0 implementation
- [ ] Developers can use PRD as reliable reference
- [ ] No confusion between v3.x and v4.0 architectures

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-10-07
**–ê–≤—Ç–æ—Ä:** System Analysis
**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** Begin TASK-1.1 (FR-TEMPLATE-001 update)
