# Ð ÑƒÐºÐ¾Ð²Ð¾Ð´ÑÑ‚Ð²Ð¾ Ð¿Ð¾ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸ VLESS+Reality VPN

> ÐšÐ¾Ð¼Ð¿Ð»ÐµÐºÑÐ½Ð¾Ðµ Ñ€ÑƒÐºÐ¾Ð²Ð¾Ð´ÑÑ‚Ð²Ð¾ Ð¿Ð¾ Ð¾Ð±ÐµÑÐ¿ÐµÑ‡ÐµÐ½Ð¸ÑŽ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸ Ð¸ Ð·Ð°Ñ‰Ð¸Ñ‚Ðµ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹ VLESS+Reality VPN Ð¾Ñ‚ Ñ€Ð°Ð·Ð»Ð¸Ñ‡Ð½Ñ‹Ñ… ÑƒÐ³Ñ€Ð¾Ð·.

## ðŸ“‹ Ð¡Ð¾Ð´ÐµÑ€Ð¶Ð°Ð½Ð¸Ðµ

1. [ÐžÐ±Ð·Ð¾Ñ€ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸](#Ð¾Ð±Ð·Ð¾Ñ€-Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸)
2. [ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð° Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸](#Ð°Ñ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð°-Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸)
3. [ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð±Ð°Ð·Ð¾Ð²Ð¾Ð¹ Ð·Ð°Ñ‰Ð¸Ñ‚Ñ‹](#Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ°-Ð±Ð°Ð·Ð¾Ð²Ð¾Ð¹-Ð·Ð°Ñ‰Ð¸Ñ‚Ñ‹)
4. [Ð£ÑÐ¸Ð»ÐµÐ½Ð½Ð°Ñ Ð·Ð°Ñ‰Ð¸Ñ‚Ð°](#ÑƒÑÐ¸Ð»ÐµÐ½Ð½Ð°Ñ-Ð·Ð°Ñ‰Ð¸Ñ‚Ð°)
5. [ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸](#Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³-Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸)
6. [ÐžÐ±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ðµ Ð²Ñ‚Ð¾Ñ€Ð¶ÐµÐ½Ð¸Ð¹](#Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ðµ-Ð²Ñ‚Ð¾Ñ€Ð¶ÐµÐ½Ð¸Ð¹)
7. [Ð—Ð°Ñ‰Ð¸Ñ‚Ð° Ð¾Ñ‚ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ñ‹Ñ… ÑƒÐ³Ñ€Ð¾Ð·](#Ð·Ð°Ñ‰Ð¸Ñ‚Ð°-Ð¾Ñ‚-ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ñ‹Ñ…-ÑƒÐ³Ñ€Ð¾Ð·)
8. [ÐÑƒÐ´Ð¸Ñ‚ Ð¸ ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ðµ](#Ð°ÑƒÐ´Ð¸Ñ‚-Ð¸-ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ðµ)
9. [ÐŸÐ»Ð°Ð½Ñ‹ Ñ€ÐµÐ°Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ](#Ð¿Ð»Ð°Ð½Ñ‹-Ñ€ÐµÐ°Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ)

## ðŸ›¡ï¸ ÐžÐ±Ð·Ð¾Ñ€ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸

### ÐšÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ðµ Ð¿Ñ€Ð¸Ð½Ñ†Ð¸Ð¿Ñ‹ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸

VLESS+Reality VPN ÑÐ¸ÑÑ‚ÐµÐ¼Ð° Ð¿Ð¾ÑÑ‚Ñ€Ð¾ÐµÐ½Ð° Ð½Ð° ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ñ… Ð¿Ñ€Ð¸Ð½Ñ†Ð¸Ð¿Ð°Ñ… Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸:

1. **Ð“Ð»ÑƒÐ±Ð¾ÐºÐ°Ñ Ð·Ð°Ñ‰Ð¸Ñ‚Ð° (Defense in Depth)**
   - ÐœÐ½Ð¾Ð³Ð¾ÑƒÑ€Ð¾Ð²Ð½ÐµÐ²Ð°Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ð° Ð·Ð°Ñ‰Ð¸Ñ‚Ñ‹
   - ÐÐµÐ·Ð°Ð²Ð¸ÑÐ¸Ð¼Ñ‹Ðµ ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»ÑŒÐ½Ñ‹Ðµ Ñ‚Ð¾Ñ‡ÐºÐ¸
   - Fail-safe Ð¼ÐµÑ…Ð°Ð½Ð¸Ð·Ð¼Ñ‹

2. **ÐŸÑ€Ð¸Ð½Ñ†Ð¸Ð¿ Ð¼Ð¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ñ… Ð¿Ñ€Ð¸Ð²Ð¸Ð»ÐµÐ³Ð¸Ð¹**
   - ÐžÐ³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð½Ñ‹Ðµ Ð¿Ñ€Ð°Ð²Ð° Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð°
   - Ð˜Ð·Ð¾Ð»ÑÑ†Ð¸Ñ ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ð¾Ð²
   - ÐšÐ¾Ð½Ñ‚Ñ€Ð¾Ð»Ð¸Ñ€ÑƒÐµÐ¼Ð¾Ðµ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´

3. **Ð‘ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ Ð¿Ð¾ Ð´Ð¸Ð·Ð°Ð¹Ð½Ñƒ**
   - Ð’ÑÑ‚Ñ€Ð¾ÐµÐ½Ð½Ð°Ñ Ð·Ð°Ñ‰Ð¸Ñ‚Ð° Ð² Ð°Ñ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ñƒ
   - Ð‘ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ñ‹Ðµ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ
   - ÐŸÑ€Ð¾Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ðµ Ð¼ÐµÑ€Ñ‹ Ð·Ð°Ñ‰Ð¸Ñ‚Ñ‹

### Ð£Ð³Ñ€Ð¾Ð·Ñ‹ Ð¸ Ð¸Ñ… Ð¼Ð¸Ñ‚Ð¸Ð³Ð°Ñ†Ð¸Ñ

| Ð£Ð³Ñ€Ð¾Ð·Ð° | Ð’ÐµÑ€Ð¾ÑÑ‚Ð½Ð¾ÑÑ‚ÑŒ | Ð’Ð¾Ð·Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ | ÐœÐ¸Ñ‚Ð¸Ð³Ð°Ñ†Ð¸Ñ |
|--------|-------------|-------------|-----------|
| DDoS Ð°Ñ‚Ð°ÐºÐ¸ | Ð’Ñ‹ÑÐ¾ÐºÐ°Ñ | Ð¡Ñ€ÐµÐ´Ð½Ð¸Ð¹ | fail2ban, rate limiting |
| ÐŸÐµÑ€ÐµÐ±Ð¾Ñ€ Ð¿Ð°Ñ€Ð¾Ð»ÐµÐ¹ | Ð¡Ñ€ÐµÐ´Ð½ÑÑ | Ð’Ñ‹ÑÐ¾ÐºÐ¸Ð¹ | fail2ban, UFW |
| ÐÐ½Ð°Ð»Ð¸Ð· Ñ‚Ñ€Ð°Ñ„Ð¸ÐºÐ° | Ð¡Ñ€ÐµÐ´Ð½ÑÑ | Ð’Ñ‹ÑÐ¾ÐºÐ¸Ð¹ | Reality Ð¼Ð°ÑÐºÐ¸Ñ€Ð¾Ð²ÐºÐ° |
| ÐšÐ¾Ð¼Ð¿Ñ€Ð¾Ð¼ÐµÑ‚Ð°Ñ†Ð¸Ñ ÑÐµÑ€Ð²ÐµÑ€Ð° | ÐÐ¸Ð·ÐºÐ°Ñ | ÐšÑ€Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ | AIDE, Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ |
| Ð£Ñ‚ÐµÑ‡ÐºÐ° ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¹ | ÐÐ¸Ð·ÐºÐ°Ñ | Ð’Ñ‹ÑÐ¾ÐºÐ¸Ð¹ | Ð¨Ð¸Ñ„Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ, Ð¿Ñ€Ð°Ð²Ð° Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° |

## ðŸ—ï¸ ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð° Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸

### Ð£Ñ€Ð¾Ð²Ð½Ð¸ Ð·Ð°Ñ‰Ð¸Ñ‚Ñ‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Ð˜ÐÐ¢Ð•Ð ÐÐ•Ð¢                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Ð¡Ð•Ð¢Ð•Ð’ÐÐ¯ Ð—ÐÐ©Ð˜Ð¢Ð                     â”‚
â”‚  â€¢ UFW Firewall (Ð¿Ð¾Ñ€Ñ‚Ñ‹ 22, 80, 443)           â”‚
â”‚  â€¢ fail2ban (Ð·Ð°Ñ‰Ð¸Ñ‚Ð° Ð¾Ñ‚ Ð±Ñ€ÑƒÑ‚Ñ„Ð¾Ñ€ÑÐ°)             â”‚
â”‚  â€¢ DDoS Protection                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            REALITY ÐœÐÐ¡ÐšÐ˜Ð ÐžÐ’ÐšÐ                   â”‚
â”‚  â€¢ TLS 1.3 ÑˆÐ¸Ñ„Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ                         â”‚
â”‚  â€¢ SNI Ð¼Ð°ÑÐºÐ¸Ñ€Ð¾Ð²ÐºÐ° Ð¿Ð¾Ð´ microsoft.com            â”‚
â”‚  â€¢ Fallback Ð½Ð° Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ðµ ÑÐ°Ð¹Ñ‚Ñ‹                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              XRAY-CORE VPN                      â”‚
â”‚  â€¢ VLESS Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð»                              â”‚
â”‚  â€¢ AEAD ÑˆÐ¸Ñ„Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ                             â”‚
â”‚  â€¢ UUID Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ñ                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Ð¡Ð˜Ð¡Ð¢Ð•ÐœÐÐÐ¯ Ð—ÐÐ©Ð˜Ð¢Ð                     â”‚
â”‚  â€¢ AIDE (Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ñ†ÐµÐ»Ð¾ÑÑ‚Ð½Ð¾ÑÑ‚Ð¸)               â”‚
â”‚  â€¢ AppArmor/SELinux                            â”‚
â”‚  â€¢ ÐÑƒÐ´Ð¸Ñ‚ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              DOCKER Ð˜Ð—ÐžÐ›Ð¯Ð¦Ð˜Ð¯                    â”‚
â”‚  â€¢ ÐšÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ð¸Ð·Ð°Ñ†Ð¸Ñ ÑÐµÑ€Ð²Ð¸ÑÐ¾Ð²                    â”‚
â”‚  â€¢ ÐžÐ³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ðµ Ñ€ÐµÑÑƒÑ€ÑÐ¾Ð²                        â”‚
â”‚  â€¢ Ð¡ÐµÑ‚ÐµÐ²Ð°Ñ Ð¸Ð·Ð¾Ð»ÑÑ†Ð¸Ñ                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ÐšÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ñ‹ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸

#### 1. Ð¡ÐµÑ‚ÐµÐ²Ð°Ñ Ð·Ð°Ñ‰Ð¸Ñ‚Ð°
- **UFW Firewall**: Ð‘Ð°Ð·Ð¾Ð²Ð°Ñ Ð·Ð°Ñ‰Ð¸Ñ‚Ð° Ð½Ð° ÑƒÑ€Ð¾Ð²Ð½Ðµ ÑÐµÑ‚Ð¸
- **fail2ban**: Ð—Ð°Ñ‰Ð¸Ñ‚Ð° Ð¾Ñ‚ Ð°Ñ‚Ð°Ðº Ð¿ÐµÑ€ÐµÐ±Ð¾Ñ€Ð°
- **Rate Limiting**: ÐžÐ³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ðµ ÑÐºÐ¾Ñ€Ð¾ÑÑ‚Ð¸ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ð¹

#### 2. ÐšÑ€Ð¸Ð¿Ñ‚Ð¾Ð³Ñ€Ð°Ñ„Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð·Ð°Ñ‰Ð¸Ñ‚Ð°
- **Reality Protocol**: ÐœÐ°ÑÐºÐ¸Ñ€Ð¾Ð²ÐºÐ° VPN Ñ‚Ñ€Ð°Ñ„Ð¸ÐºÐ°
- **TLS 1.3**: Ð¡Ð¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ðµ ÑˆÐ¸Ñ„Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ
- **Forward Secrecy**: Ð—Ð°Ñ‰Ð¸Ñ‚Ð° Ð¾Ñ‚ ÐºÐ¾Ð¼Ð¿Ñ€Ð¾Ð¼ÐµÑ‚Ð°Ñ†Ð¸Ð¸ ÐºÐ»ÑŽÑ‡ÐµÐ¹

#### 3. Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð½Ð°Ñ Ð·Ð°Ñ‰Ð¸Ñ‚Ð°
- **AIDE**: ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ñ†ÐµÐ»Ð¾ÑÑ‚Ð½Ð¾ÑÑ‚Ð¸ Ñ„Ð°Ð¹Ð»Ð¾Ð²
- **AppArmor**: ÐžÐ±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»ÑŒ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð°
- **Audit Logging**: Ð”ÐµÑ‚Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ð¹

## ðŸ”§ ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð±Ð°Ð·Ð¾Ð²Ð¾Ð¹ Ð·Ð°Ñ‰Ð¸Ñ‚Ñ‹

### ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ°

Ð‘Ð°Ð·Ð¾Ð²Ð°Ñ Ð·Ð°Ñ‰Ð¸Ñ‚Ð° Ð½Ð°ÑÑ‚Ñ€Ð°Ð¸Ð²Ð°ÐµÑ‚ÑÑ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð¿Ñ€Ð¸ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐµ:

```bash
# Ð—Ð°Ð¿ÑƒÑÐº Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð¹ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸
sudo ./modules/security_hardening.sh auto-setup

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÑ‚Ð°Ñ‚ÑƒÑÐ° Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸
sudo ./modules/security_hardening.sh status
```

### ÐšÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ UFW Firewall

#### Ð‘Ð°Ð·Ð¾Ð²Ñ‹Ðµ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°

```bash
# Ð¡Ð±Ñ€Ð¾Ñ Ðº Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ°Ð¼ Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ
sudo ufw --force reset

# Ð—Ð°Ð¿Ñ€ÐµÑ‚ Ð²ÑÐµÑ… Ð²Ñ…Ð¾Ð´ÑÑ‰Ð¸Ñ… ÑÐ¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸Ð¹ Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ
sudo ufw default deny incoming

# Ð Ð°Ð·Ñ€ÐµÑˆÐµÐ½Ð¸Ðµ Ð²ÑÐµÑ… Ð¸ÑÑ…Ð¾Ð´ÑÑ‰Ð¸Ñ… ÑÐ¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸Ð¹
sudo ufw default allow outgoing

# Ð Ð°Ð·Ñ€ÐµÑˆÐµÐ½Ð¸Ðµ SSH (Ð¸Ð·Ð¼ÐµÐ½Ð¸Ñ‚Ðµ Ð¿Ð¾Ñ€Ñ‚ Ð¿Ñ€Ð¸ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ÑÑ‚Ð¸)
sudo ufw allow 22/tcp

# Ð Ð°Ð·Ñ€ÐµÑˆÐµÐ½Ð¸Ðµ HTTP Ð¸ HTTPS Ð´Ð»Ñ VPN
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp

# ÐÐºÑ‚Ð¸Ð²Ð°Ñ†Ð¸Ñ UFW
sudo ufw enable

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÑ‚Ð°Ñ‚ÑƒÑÐ°
sudo ufw status verbose
```

#### Ð Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð½Ñ‹Ðµ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°

```bash
# ÐžÐ³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ðµ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ð¹ SSH
sudo ufw limit ssh

# Ð Ð°Ð·Ñ€ÐµÑˆÐµÐ½Ð¸Ðµ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ñ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð½Ñ‹Ñ… IP
sudo ufw allow from 192.168.1.0/24 to any port 22

# Ð›Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ð¾Ð´Ð¾Ð·Ñ€Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð¹ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚Ð¸
sudo ufw logging on

# ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð»Ð¸Ð¼Ð¸Ñ‚Ð¾Ð² ÑÐºÐ¾Ñ€Ð¾ÑÑ‚Ð¸
echo "net/ipv4/netfilter/ip_conntrack_max = 65536" >> /etc/sysctl.conf
```

### ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° fail2ban

#### Ð‘Ð°Ð·Ð¾Ð²Ð°Ñ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ

```bash
# Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° fail2ban (ÐµÑÐ»Ð¸ Ð½Ðµ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½)
sudo apt install fail2ban -y

# Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾Ð¹ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸
sudo cp /etc/fail2ban/jail.conf /etc/fail2ban/jail.local

# Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸
sudo nano /etc/fail2ban/jail.local
```

#### ÐšÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ Ð´Ð»Ñ VPN Ð·Ð°Ñ‰Ð¸Ñ‚Ñ‹

```ini
[DEFAULT]
# Ð’Ñ€ÐµÐ¼Ñ Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ¸ (1 Ñ‡Ð°Ñ)
bantime = 3600

# Ð’Ñ€ÐµÐ¼Ñ Ð½Ð°Ð±Ð»ÑŽÐ´ÐµÐ½Ð¸Ñ (10 Ð¼Ð¸Ð½ÑƒÑ‚)
findtime = 600

# ÐœÐ°ÐºÑÐ¸Ð¼ÑƒÐ¼ Ð¿Ð¾Ð¿Ñ‹Ñ‚Ð¾Ðº Ð¿ÐµÑ€ÐµÐ´ Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ¾Ð¹
maxretry = 3

# Ð˜Ð³Ð½Ð¾Ñ€Ð¸Ñ€ÑƒÐµÐ¼Ñ‹Ðµ IP (Ð´Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ð²Ð°ÑˆÐ¸ IP)
ignoreip = 127.0.0.1/8 192.168.1.0/24

[sshd]
enabled = true
port = ssh
filter = sshd
logpath = /var/log/auth.log

[nginx-dos]
enabled = true
port = http,https
filter = nginx-dos
logpath = /var/log/nginx/access.log
maxretry = 10
findtime = 60
bantime = 3600

[vless-dos]
enabled = true
port = 443
filter = vless-dos
logpath = /opt/vless/logs/xray.log
maxretry = 20
findtime = 300
bantime = 1800
```

#### Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð° Ð´Ð»Ñ VLESS

```bash
# Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð° Ð´Ð»Ñ Ð·Ð°Ñ‰Ð¸Ñ‚Ñ‹ Ð¾Ñ‚ DoS Ð°Ñ‚Ð°Ðº Ð½Ð° VLESS
sudo cat > /etc/fail2ban/filter.d/vless-dos.conf << 'EOF'
[Definition]
failregex = ^.*\[.*\] .* (.*) rejected.*$
            ^.*\[.*\] .* (.*) connection failed.*$
            ^.*\[.*\] .* (.*) authentication failed.*$

ignoreregex =

datepattern = ^%%Y/%%m/%%d %%H:%%M:%%S
EOF

# ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐº fail2ban
sudo systemctl restart fail2ban

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÑ‚Ð°Ñ‚ÑƒÑÐ°
sudo fail2ban-client status
```

## ðŸ›¡ï¸ Ð£ÑÐ¸Ð»ÐµÐ½Ð½Ð°Ñ Ð·Ð°Ñ‰Ð¸Ñ‚Ð°

### ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ñ†ÐµÐ»Ð¾ÑÑ‚Ð½Ð¾ÑÑ‚Ð¸ Ñ„Ð°Ð¹Ð»Ð¾Ð² (AIDE)

#### Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð¸ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ°

```bash
# ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° AIDE
sudo ./modules/security_hardening.sh setup-aide

# Ð˜Ð»Ð¸ Ñ€ÑƒÑ‡Ð½Ð°Ñ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ°:
sudo apt install aide -y

# Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ… AIDE
sudo aideinit

# ÐšÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ…
sudo cp /var/lib/aide/aide.db.new /var/lib/aide/aide.db
```

#### ÐšÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ð°

```bash
# Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸ AIDE
sudo nano /etc/aide/aide.conf

# Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸Ð¹ Ð´Ð»Ñ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ð°
echo "/opt/vless/configs R" >> /etc/aide/aide.conf
echo "/opt/vless/certs R" >> /etc/aide/aide.conf
echo "/etc/systemd/system/vless-vpn.service R" >> /etc/aide/aide.conf
echo "/usr/local/bin R" >> /etc/aide/aide.conf
```

#### ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸

```bash
# Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÑÐºÑ€Ð¸Ð¿Ñ‚Ð° Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸
sudo cat > /usr/local/bin/aide-check << 'EOF'
#!/bin/bash
LOGFILE="/var/log/aide.log"
REPORT="/tmp/aide-report.txt"

# Ð—Ð°Ð¿ÑƒÑÐº Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸
aide --check > $REPORT 2>&1

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð²
if [ $? -ne 0 ]; then
    echo "$(date): AIDE detected changes:" >> $LOGFILE
    cat $REPORT >> $LOGFILE

    # ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ Ð² Telegram
    /opt/vless/modules/telegram_bot_manager.sh send-alert "AIDE: ÐžÐ±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ñ‹ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ Ð² ÑÐ¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ñ… Ñ„Ð°Ð¹Ð»Ð°Ñ…. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð»Ð¾Ð³Ð¸."
fi

# ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ… (ÐµÑÐ»Ð¸ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ Ð»ÐµÐ³Ð¸Ñ‚Ð¸Ð¼Ð½Ñ‹)
# aide --update
EOF

sudo chmod +x /usr/local/bin/aide-check

# Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð² cron Ð´Ð»Ñ ÐµÐ¶ÐµÐ´Ð½ÐµÐ²Ð½Ñ‹Ñ… Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¾Ðº
echo "0 6 * * * root /usr/local/bin/aide-check" >> /etc/crontab
```

### Ð£ÑÐ¸Ð»ÐµÐ½Ð¸Ðµ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸ SSH

```bash
# Ð ÐµÐ·ÐµÑ€Ð²Ð½Ð°Ñ ÐºÐ¾Ð¿Ð¸Ñ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸
sudo cp /etc/ssh/sshd_config /etc/ssh/sshd_config.backup

# ÐŸÑ€Ð¸Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ ÑƒÑÐ¸Ð»ÐµÐ½Ð½Ð¾Ð¹ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸ SSH
sudo cat > /etc/ssh/sshd_config.d/99-security.conf << 'EOF'
# ÐžÑ‚ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ root Ð²Ñ…Ð¾Ð´Ð°
PermitRootLogin no

# ÐžÑ‚ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ð²Ñ…Ð¾Ð´Ð° Ð¿Ð¾ Ð¿Ð°Ñ€Ð¾Ð»ÑŽ (Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÐºÐ»ÑŽÑ‡Ð¸)
PasswordAuthentication no
PermitEmptyPasswords no

# ÐžÐ³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹
AllowUsers your_username

# Ð£ÑÐ¸Ð»ÐµÐ½Ð½Ñ‹Ðµ Ð°Ð»Ð³Ð¾Ñ€Ð¸Ñ‚Ð¼Ñ‹
KexAlgorithms curve25519-sha256@libssh.org,diffie-hellman-group16-sha512
Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr
MACs hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha2-256,hmac-sha2-512

# Ð¢Ð°Ð¹Ð¼Ð°ÑƒÑ‚Ñ‹ Ð¸ Ð»Ð¸Ð¼Ð¸Ñ‚Ñ‹
ClientAliveInterval 300
ClientAliveCountMax 2
MaxAuthTries 3
MaxStartups 2
LoginGraceTime 30

# ÐžÑ‚ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ð½ÐµÐ½ÑƒÐ¶Ð½Ñ‹Ñ… Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¹
X11Forwarding no
AllowTcpForwarding no
AllowAgentForwarding no
PermitTunnel no
EOF

# ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐº SSH
sudo systemctl restart sshd
```

### ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° AppArmor/SELinux

```bash
# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÑ‚Ð°Ñ‚ÑƒÑÐ° AppArmor
sudo aa-status

# Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ñ Ð´Ð»Ñ Xray
sudo cat > /etc/apparmor.d/usr.local.bin.xray << 'EOF'
#include <tunables/global>

/usr/local/bin/xray {
  #include <abstractions/base>
  #include <abstractions/nameservice>

  capability net_bind_service,
  capability setuid,
  capability setgid,

  network inet stream,
  network inet6 stream,

  /usr/local/bin/xray mr,
  /opt/vless/configs/* r,
  /opt/vless/certs/* r,
  /opt/vless/logs/* rw,

  /proc/sys/net/core/rmem_default r,
  /proc/sys/net/core/rmem_max r,
  /proc/sys/net/core/wmem_default r,
  /proc/sys/net/core/wmem_max r,
}
EOF

# Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ñ
sudo apparmor_parser -r /etc/apparmor.d/usr.local.bin.xray
```

## ðŸ“Š ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸

### Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ð° Ð² Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð¼ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸

#### ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ ÑÐµÑ‚ÐµÐ²Ð¾Ð¹ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚Ð¸

```bash
# Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ð° Ð¿Ð¾Ð´Ð¾Ð·Ñ€Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð¹ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚Ð¸
sudo cat > /usr/local/bin/security-monitor << 'EOF'
#!/bin/bash

LOGFILE="/var/log/security-monitor.log"
THRESHOLD_CONNECTIONS=50
THRESHOLD_BANDWIDTH=100  # MB/s

while true; do
    # ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð° Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ð¹
    CONNECTIONS=$(netstat -an | grep ESTABLISHED | wc -l)
    if [ $CONNECTIONS -gt $THRESHOLD_CONNECTIONS ]; then
        echo "$(date): WARNING: High connection count: $CONNECTIONS" >> $LOGFILE
    fi

    # ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¿Ñ€Ð¾Ð¿ÑƒÑÐºÐ½Ð¾Ð¹ ÑÐ¿Ð¾ÑÐ¾Ð±Ð½Ð¾ÑÑ‚Ð¸
    RX_BYTES=$(cat /sys/class/net/eth0/statistics/rx_bytes)
    sleep 1
    RX_BYTES_NEW=$(cat /sys/class/net/eth0/statistics/rx_bytes)
    BANDWIDTH=$(( (RX_BYTES_NEW - RX_BYTES) / 1024 / 1024 ))

    if [ $BANDWIDTH -gt $THRESHOLD_BANDWIDTH ]; then
        echo "$(date): WARNING: High bandwidth usage: ${BANDWIDTH}MB/s" >> $LOGFILE
    fi

    sleep 10
done
EOF

sudo chmod +x /usr/local/bin/security-monitor

# Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ systemd ÑÐµÑ€Ð²Ð¸ÑÐ°
sudo cat > /etc/systemd/system/security-monitor.service << 'EOF'
[Unit]
Description=Security Monitoring Service
After=network.target

[Service]
Type=simple
ExecStart=/usr/local/bin/security-monitor
Restart=always
User=root

[Install]
WantedBy=multi-user.target
EOF

sudo systemctl enable security-monitor
sudo systemctl start security-monitor
```

### ÐÐ½Ð°Ð»Ð¸Ð· Ð»Ð¾Ð³Ð¾Ð² Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸

```bash
# Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ð°Ð½Ð°Ð»Ð¸Ð·Ð° Ð»Ð¾Ð³Ð¾Ð²
sudo cat > /usr/local/bin/analyze-security-logs << 'EOF'
#!/bin/bash

REPORT_FILE="/tmp/security-report-$(date +%Y%m%d).txt"

echo "ÐžÐ¢Ð§Ð•Ð¢ Ð‘Ð•Ð—ÐžÐŸÐÐ¡ÐÐžÐ¡Ð¢Ð˜ - $(date)" > $REPORT_FILE
echo "======================================" >> $REPORT_FILE

# ÐÐ½Ð°Ð»Ð¸Ð· Ð¿Ð¾Ð¿Ñ‹Ñ‚Ð¾Ðº Ð²Ñ…Ð¾Ð´Ð° SSH
echo -e "\n1. ÐŸÐžÐŸÐ«Ð¢ÐšÐ˜ Ð’Ð¥ÐžÐ”Ð SSH:" >> $REPORT_FILE
grep "Failed password" /var/log/auth.log | tail -20 >> $REPORT_FILE

# ÐÐ½Ð°Ð»Ð¸Ð· Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð¾Ðº fail2ban
echo -e "\n2. Ð‘Ð›ÐžÐšÐ˜Ð ÐžÐ’ÐšÐ˜ FAIL2BAN:" >> $REPORT_FILE
fail2ban-client status | grep "Jail list" >> $REPORT_FILE
for jail in $(fail2ban-client status | grep "Jail list" | cut -d: -f2 | tr ',' ' '); do
    echo "--- $jail ---" >> $REPORT_FILE
    fail2ban-client status $jail >> $REPORT_FILE
done

# ÐÐ½Ð°Ð»Ð¸Ð· ÑÐ¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸Ð¹ VPN
echo -e "\n3. VPN Ð¡ÐžÐ•Ð”Ð˜ÐÐ•ÐÐ˜Ð¯:" >> $REPORT_FILE
grep "accepted" /opt/vless/logs/xray.log | tail -10 >> $REPORT_FILE

# ÐÐ½Ð°Ð»Ð¸Ð· Ð¿Ð¾Ð´Ð¾Ð·Ñ€Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð¹ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚Ð¸
echo -e "\n4. ÐŸÐžÐ”ÐžÐ—Ð Ð˜Ð¢Ð•Ð›Ð¬ÐÐÐ¯ ÐÐšÐ¢Ð˜Ð’ÐÐžÐ¡Ð¢Ð¬:" >> $REPORT_FILE
grep -i "attack\|intrusion\|malware\|virus" /var/log/syslog | tail -10 >> $REPORT_FILE

# ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° Ð¾Ñ‚Ñ‡ÐµÑ‚Ð° Ð² Telegram
/opt/vless/modules/telegram_bot_manager.sh send-file $REPORT_FILE "Ð•Ð¶ÐµÐ´Ð½ÐµÐ²Ð½Ñ‹Ð¹ Ð¾Ñ‚Ñ‡ÐµÑ‚ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸"
EOF

sudo chmod +x /usr/local/bin/analyze-security-logs

# Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð² cron Ð´Ð»Ñ ÐµÐ¶ÐµÐ´Ð½ÐµÐ²Ð½Ð¾Ð³Ð¾ Ð°Ð½Ð°Ð»Ð¸Ð·Ð°
echo "0 7 * * * root /usr/local/bin/analyze-security-logs" >> /etc/crontab
```

## ðŸš¨ ÐžÐ±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ðµ Ð²Ñ‚Ð¾Ñ€Ð¶ÐµÐ½Ð¸Ð¹

### Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ñ Ð°Ð½Ð¾Ð¼Ð°Ð»Ð¸Ð¹

```bash
# Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ñ Ð°Ð½Ð¾Ð¼Ð°Ð»Ð¸Ð¹
sudo cat > /usr/local/bin/anomaly-detector << 'EOF'
#!/bin/bash

# Ð‘Ð°Ð·Ð¾Ð²Ñ‹Ðµ Ð¼ÐµÑ‚Ñ€Ð¸ÐºÐ¸ Ð´Ð»Ñ ÑÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ñ
BASELINE_CPU=20
BASELINE_MEMORY=30
BASELINE_CONNECTIONS=10

# Ð¢ÐµÐºÑƒÑ‰Ð¸Ðµ Ð¼ÐµÑ‚Ñ€Ð¸ÐºÐ¸
CURRENT_CPU=$(top -bn1 | grep "Cpu(s)" | awk '{print $2}' | sed 's/%us,//')
CURRENT_MEMORY=$(free | grep Mem | awk '{printf("%.0f", $3/$2 * 100.0)}')
CURRENT_CONNECTIONS=$(netstat -an | grep ESTABLISHED | wc -l)

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð°Ð½Ð¾Ð¼Ð°Ð»Ð¸Ð¹
alert_triggered=false

if (( $(echo "$CURRENT_CPU > $BASELINE_CPU * 3" | bc -l) )); then
    echo "ALERT: ÐÐ½Ð¾Ð¼Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ CPU: ${CURRENT_CPU}%"
    alert_triggered=true
fi

if [ $CURRENT_MEMORY -gt $((BASELINE_MEMORY * 3)) ]; then
    echo "ALERT: ÐÐ½Ð¾Ð¼Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ð°Ð¼ÑÑ‚Ð¸: ${CURRENT_MEMORY}%"
    alert_triggered=true
fi

if [ $CURRENT_CONNECTIONS -gt $((BASELINE_CONNECTIONS * 5)) ]; then
    echo "ALERT: ÐÐ½Ð¾Ð¼Ð°Ð»ÑŒÐ½Ð¾Ðµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÑÐ¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸Ð¹: $CURRENT_CONNECTIONS"
    alert_triggered=true
fi

# ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ Ð¿Ñ€Ð¸ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ð¸ Ð°Ð½Ð¾Ð¼Ð°Ð»Ð¸Ð¹
if [ "$alert_triggered" = true ]; then
    /opt/vless/modules/telegram_bot_manager.sh send-alert "ÐžÐ±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ñ‹ Ð°Ð½Ð¾Ð¼Ð°Ð»Ð¸Ð¸ Ð² ÑÐ¸ÑÑ‚ÐµÐ¼Ðµ. Ð¢Ñ€ÐµÐ±ÑƒÐµÑ‚ÑÑ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ°."
fi
EOF

sudo chmod +x /usr/local/bin/anomaly-detector

# Ð—Ð°Ð¿ÑƒÑÐº ÐºÐ°Ð¶Ð´Ñ‹Ðµ 5 Ð¼Ð¸Ð½ÑƒÑ‚
echo "*/5 * * * * root /usr/local/bin/anomaly-detector" >> /etc/crontab
```

### Honeypot Ð´Ð»Ñ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ñ Ð°Ñ‚Ð°Ðº

```bash
# ÐŸÑ€Ð¾ÑÑ‚Ð¾Ð¹ SSH honeypot
sudo cat > /usr/local/bin/ssh-honeypot << 'EOF'
#!/bin/bash

# Ð—Ð°Ð¿ÑƒÑÐº Ñ„ÐµÐ¹ÐºÐ¾Ð²Ð¾Ð³Ð¾ SSH ÑÐµÑ€Ð²ÐµÑ€Ð° Ð½Ð° Ð¿Ð¾Ñ€Ñ‚Ñƒ 2222
while true; do
    nc -l -p 2222 -c 'echo "SSH-2.0-OpenSSH_7.4"; read line; echo "$(date): Honeypot connection from $REMOTE_ADDR: $line" >> /var/log/honeypot.log'
done
EOF

sudo chmod +x /usr/local/bin/ssh-honeypot

# Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ systemd ÑÐµÑ€Ð²Ð¸ÑÐ° Ð´Ð»Ñ honeypot
sudo cat > /etc/systemd/system/ssh-honeypot.service << 'EOF'
[Unit]
Description=SSH Honeypot
After=network.target

[Service]
Type=simple
ExecStart=/usr/local/bin/ssh-honeypot
Restart=always
User=nobody

[Install]
WantedBy=multi-user.target
EOF

sudo systemctl enable ssh-honeypot
sudo systemctl start ssh-honeypot
```

## ðŸŽ¯ Ð—Ð°Ñ‰Ð¸Ñ‚Ð° Ð¾Ñ‚ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ñ‹Ñ… ÑƒÐ³Ñ€Ð¾Ð·

### Ð—Ð°Ñ‰Ð¸Ñ‚Ð° Ð¾Ñ‚ DDoS Ð°Ñ‚Ð°Ðº

#### ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð»Ð¸Ð¼Ð¸Ñ‚Ð¾Ð² Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ð¹

```bash
# ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° iptables Ð´Ð»Ñ Ð·Ð°Ñ‰Ð¸Ñ‚Ñ‹ Ð¾Ñ‚ DDoS
sudo cat > /usr/local/bin/ddos-protection << 'EOF'
#!/bin/bash

# ÐžÐ³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ðµ Ð½Ð¾Ð²Ñ‹Ñ… Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ð¹
iptables -A INPUT -p tcp --dport 443 -m connlimit --connlimit-above 10 -j REJECT

# ÐžÐ³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ðµ ÑÐºÐ¾Ñ€Ð¾ÑÑ‚Ð¸ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ð¹
iptables -A INPUT -p tcp --dport 443 -m hashlimit --hashlimit-name vless_limit --hashlimit 10/min --hashlimit-burst 20 --hashlimit-mode srcip --hashlimit-htable-expire 300000 -j ACCEPT

# Ð—Ð°Ñ‰Ð¸Ñ‚Ð° Ð¾Ñ‚ SYN flood
iptables -A INPUT -p tcp --syn -m hashlimit --hashlimit-name syn_limit --hashlimit 1/s --hashlimit-burst 3 --hashlimit-mode srcip -j ACCEPT

# Ð‘Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ° Ð¿Ð¾ÑÐ»Ðµ Ð¿Ñ€ÐµÐ²Ñ‹ÑˆÐµÐ½Ð¸Ñ Ð»Ð¸Ð¼Ð¸Ñ‚Ð¾Ð²
iptables -A INPUT -p tcp --dport 443 -j REJECT
EOF

sudo chmod +x /usr/local/bin/ddos-protection
sudo /usr/local/bin/ddos-protection
```

#### ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° ÑÐ¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ñ… Ð»Ð¸Ð¼Ð¸Ñ‚Ð¾Ð²

```bash
# Ð£Ð²ÐµÐ»Ð¸Ñ‡ÐµÐ½Ð¸Ðµ Ð»Ð¸Ð¼Ð¸Ñ‚Ð¾Ð² Ð´Ð»Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Ð±Ð¾Ð»ÑŒÑˆÐ¾Ð³Ð¾ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð° ÑÐ¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸Ð¹
echo "net.core.somaxconn = 65535" >> /etc/sysctl.conf
echo "net.core.netdev_max_backlog = 5000" >> /etc/sysctl.conf
echo "net.ipv4.tcp_max_syn_backlog = 65535" >> /etc/sysctl.conf
echo "net.ipv4.tcp_syn_retries = 1" >> /etc/sysctl.conf
echo "net.ipv4.tcp_synack_retries = 1" >> /etc/sysctl.conf

# ÐŸÑ€Ð¸Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐº
sudo sysctl -p
```

### Ð—Ð°Ñ‰Ð¸Ñ‚Ð° Ð¾Ñ‚ Ð°Ð½Ð°Ð»Ð¸Ð·Ð° Ñ‚Ñ€Ð°Ñ„Ð¸ÐºÐ°

#### Ð£ÑÐ¸Ð»ÐµÐ½Ð¸Ðµ Reality Ð¼Ð°ÑÐºÐ¸Ñ€Ð¾Ð²ÐºÐ¸

```bash
# Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ð´Ð»Ñ Ñ€Ð¾Ñ‚Ð°Ñ†Ð¸Ð¸ Reality Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð¾Ð²
sudo cat > /usr/local/bin/rotate-reality << 'EOF'
#!/bin/bash

TARGETS=("microsoft.com" "apple.com" "google.com" "amazon.com")
SNIS=("www.microsoft.com" "www.apple.com" "www.google.com" "www.amazon.com")

# Ð’Ñ‹Ð±Ð¾Ñ€ ÑÐ»ÑƒÑ‡Ð°Ð¹Ð½Ð¾Ð³Ð¾ target
RANDOM_INDEX=$((RANDOM % ${#TARGETS[@]}))
NEW_TARGET=${TARGETS[$RANDOM_INDEX]}
NEW_SNI=${SNIS[$RANDOM_INDEX]}

# ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸
/opt/vless/modules/cert_management.sh update-reality --target $NEW_TARGET --sni $NEW_SNI

# ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐº ÑÐµÑ€Ð²Ð¸ÑÐ°
systemctl restart vless-vpn

echo "Reality configuration updated: $NEW_TARGET / $NEW_SNI"
EOF

sudo chmod +x /usr/local/bin/rotate-reality

# Ð Ð¾Ñ‚Ð°Ñ†Ð¸Ñ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð¾Ð² ÐºÐ°Ð¶Ð´Ñ‹Ðµ 24 Ñ‡Ð°ÑÐ°
echo "0 3 * * * root /usr/local/bin/rotate-reality" >> /etc/crontab
```

### Ð—Ð°Ñ‰Ð¸Ñ‚Ð° Ð¾Ñ‚ ÐºÐ¾Ð¼Ð¿Ñ€Ð¾Ð¼ÐµÑ‚Ð°Ñ†Ð¸Ð¸ ÐºÐ»ÑŽÑ‡ÐµÐ¹

#### ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ñ€Ð¾Ñ‚Ð°Ñ†Ð¸Ñ ÐºÐ»ÑŽÑ‡ÐµÐ¹

```bash
# Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð¹ Ñ€Ð¾Ñ‚Ð°Ñ†Ð¸Ð¸ ÐºÐ»ÑŽÑ‡ÐµÐ¹
sudo cat > /usr/local/bin/rotate-keys << 'EOF'
#!/bin/bash

BACKUP_DIR="/opt/vless/backups/keys"
DATE=$(date +%Y%m%d-%H%M%S)

# Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ñ€ÐµÐ·ÐµÑ€Ð²Ð½Ð¾Ð¹ ÐºÐ¾Ð¿Ð¸Ð¸ Ñ‚ÐµÐºÑƒÑ‰Ð¸Ñ… ÐºÐ»ÑŽÑ‡ÐµÐ¹
mkdir -p $BACKUP_DIR
cp -r /opt/vless/certs/ $BACKUP_DIR/certs-$DATE/

# Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ Ð½Ð¾Ð²Ñ‹Ñ… ÐºÐ»ÑŽÑ‡ÐµÐ¹
/opt/vless/modules/cert_management.sh regenerate --force

# ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¹ Ð²ÑÐµÑ… Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹
/opt/vless/modules/user_management.sh regenerate-all

# ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐº ÑÐµÑ€Ð²Ð¸ÑÐ°
systemctl restart vless-vpn

# Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ðµ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð°
/opt/vless/modules/telegram_bot_manager.sh send-alert "ÐšÐ»ÑŽÑ‡Ð¸ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ñ‹. ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑÐ¼ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ Ð¾Ð±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸."

echo "Keys rotated successfully at $DATE"
EOF

sudo chmod +x /usr/local/bin/rotate-keys

# Ð Ð¾Ñ‚Ð°Ñ†Ð¸Ñ ÐºÐ»ÑŽÑ‡ÐµÐ¹ ÐºÐ°Ð¶Ð´ÑƒÑŽ Ð½ÐµÐ´ÐµÐ»ÑŽ
echo "0 2 * * 0 root /usr/local/bin/rotate-keys" >> /etc/crontab
```

## ðŸ“‹ ÐÑƒÐ´Ð¸Ñ‚ Ð¸ ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ðµ

### Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° Ð°ÑƒÐ´Ð¸Ñ‚Ð°

#### ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° auditd

```bash
# Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° auditd
sudo apt install auditd audispd-plugins -y

# ÐšÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ Ð¿Ñ€Ð°Ð²Ð¸Ð» Ð°ÑƒÐ´Ð¸Ñ‚Ð°
sudo cat > /etc/audit/rules.d/vless-audit.rules << 'EOF'
# ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¹
-w /opt/vless/configs/ -p wa -k vless_config_change
-w /opt/vless/certs/ -p wa -k vless_cert_change

# ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¸Ð²Ð½Ñ‹Ñ… ÐºÐ¾Ð¼Ð°Ð½Ð´
-w /usr/bin/sudo -p x -k sudo_usage
-w /bin/su -p x -k su_usage

# ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ ÑÐµÑ‚ÐµÐ²Ñ‹Ñ… Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐº
-w /etc/ufw/ -p wa -k firewall_change
-w /etc/fail2ban/ -p wa -k fail2ban_change

# ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ SSH
-w /etc/ssh/sshd_config -p wa -k ssh_config_change
-w /etc/ssh/sshd_config.d/ -p wa -k ssh_config_change

# ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° Ðº Ñ„Ð°Ð¹Ð»Ð°Ð¼ Ð¿Ð°Ñ€Ð¾Ð»ÐµÐ¹
-w /etc/passwd -p wa -k passwd_change
-w /etc/shadow -p wa -k shadow_change
-w /etc/group -p wa -k group_change

# ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ ÑÐ¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ñ… Ð²Ñ‹Ð·Ð¾Ð²Ð¾Ð²
-a always,exit -F arch=b64 -S execve -k exec_commands
-a always,exit -F arch=b32 -S execve -k exec_commands
EOF

# ÐŸÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð¿Ñ€Ð°Ð²Ð¸Ð»
sudo augenrules --load
sudo systemctl restart auditd
```

#### ÐÐ½Ð°Ð»Ð¸Ð· Ð°ÑƒÐ´Ð¸Ñ‚ Ð»Ð¾Ð³Ð¾Ð²

```bash
# Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ð°Ð½Ð°Ð»Ð¸Ð·Ð° Ð°ÑƒÐ´Ð¸Ñ‚ Ð»Ð¾Ð³Ð¾Ð²
sudo cat > /usr/local/bin/audit-analyzer << 'EOF'
#!/bin/bash

REPORT_FILE="/tmp/audit-report-$(date +%Y%m%d).txt"

echo "ÐÐ£Ð”Ð˜Ð¢ ÐžÐ¢Ð§Ð•Ð¢ - $(date)" > $REPORT_FILE
echo "========================" >> $REPORT_FILE

# ÐÐ½Ð°Ð»Ð¸Ð· Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¹
echo -e "\n1. Ð˜Ð—ÐœÐ•ÐÐ•ÐÐ˜Ð¯ ÐšÐžÐÐ¤Ð˜Ð“Ð£Ð ÐÐ¦Ð˜Ð™ VLESS:" >> $REPORT_FILE
ausearch -k vless_config_change -ts today 2>/dev/null >> $REPORT_FILE

# ÐÐ½Ð°Ð»Ð¸Ð· Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ sudo
echo -e "\n2. Ð˜Ð¡ÐŸÐžÐ›Ð¬Ð—ÐžÐ’ÐÐÐ˜Ð• SUDO:" >> $REPORT_FILE
ausearch -k sudo_usage -ts today 2>/dev/null | aureport -x --summary >> $REPORT_FILE

# ÐÐ½Ð°Ð»Ð¸Ð· ÑÐµÑ‚ÐµÐ²Ñ‹Ñ… Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹
echo -e "\n3. Ð˜Ð—ÐœÐ•ÐÐ•ÐÐ˜Ð¯ Ð¡Ð•Ð¢Ð•Ð’Ð«Ð¥ ÐÐÐ¡Ð¢Ð ÐžÐ•Ðš:" >> $REPORT_FILE
ausearch -k firewall_change,fail2ban_change -ts today 2>/dev/null >> $REPORT_FILE

# ÐÐ½Ð°Ð»Ð¸Ð· Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð½Ñ‹Ñ… ÐºÐ¾Ð¼Ð°Ð½Ð´
echo -e "\n4. Ð’Ð«ÐŸÐžÐ›ÐÐ•ÐÐÐ«Ð• ÐšÐžÐœÐÐÐ”Ð«:" >> $REPORT_FILE
ausearch -k exec_commands -ts today 2>/dev/null | aureport -x --summary >> $REPORT_FILE

# ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° Ð¾Ñ‚Ñ‡ÐµÑ‚Ð°
/opt/vless/modules/telegram_bot_manager.sh send-file $REPORT_FILE "ÐÑƒÐ´Ð¸Ñ‚ Ð¾Ñ‚Ñ‡ÐµÑ‚"
EOF

sudo chmod +x /usr/local/bin/audit-analyzer

# Ð•Ð¶ÐµÐ´Ð½ÐµÐ²Ð½Ñ‹Ð¹ Ð°Ð½Ð°Ð»Ð¸Ð· Ð°ÑƒÐ´Ð¸Ñ‚ Ð»Ð¾Ð³Ð¾Ð²
echo "0 8 * * * root /usr/local/bin/audit-analyzer" >> /etc/crontab
```

### Compliance Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸

```bash
# Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ñ Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸ÑÐ¼ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸
sudo cat > /usr/local/bin/compliance-check << 'EOF'
#!/bin/bash

REPORT_FILE="/tmp/compliance-report-$(date +%Y%m%d).txt"

echo "ÐŸÐ ÐžÐ’Ð•Ð ÐšÐ Ð¡ÐžÐžÐ¢Ð’Ð•Ð¢Ð¡Ð¢Ð’Ð˜Ð¯ Ð¢Ð Ð•Ð‘ÐžÐ’ÐÐÐ˜Ð¯Ðœ Ð‘Ð•Ð—ÐžÐŸÐÐ¡ÐÐžÐ¡Ð¢Ð˜" > $REPORT_FILE
echo "=============================================" >> $REPORT_FILE

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÐ¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ñ… Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐº
echo -e "\n1. Ð¡Ð˜Ð¡Ð¢Ð•ÐœÐÐ«Ð• ÐÐÐ¡Ð¢Ð ÐžÐ™ÐšÐ˜:" >> $REPORT_FILE

# SSH ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ
if grep -q "PermitRootLogin no" /etc/ssh/sshd_config; then
    echo "âœ… SSH root login Ð¾Ñ‚ÐºÐ»ÑŽÑ‡ÐµÐ½" >> $REPORT_FILE
else
    echo "âŒ SSH root login Ð²ÐºÐ»ÑŽÑ‡ÐµÐ½" >> $REPORT_FILE
fi

if grep -q "PasswordAuthentication no" /etc/ssh/sshd_config; then
    echo "âœ… SSH password authentication Ð¾Ñ‚ÐºÐ»ÑŽÑ‡ÐµÐ½" >> $REPORT_FILE
else
    echo "âŒ SSH password authentication Ð²ÐºÐ»ÑŽÑ‡ÐµÐ½" >> $REPORT_FILE
fi

# UFW ÑÑ‚Ð°Ñ‚ÑƒÑ
if ufw status | grep -q "Status: active"; then
    echo "âœ… UFW firewall Ð°ÐºÑ‚Ð¸Ð²ÐµÐ½" >> $REPORT_FILE
else
    echo "âŒ UFW firewall Ð½ÐµÐ°ÐºÑ‚Ð¸Ð²ÐµÐ½" >> $REPORT_FILE
fi

# fail2ban ÑÑ‚Ð°Ñ‚ÑƒÑ
if systemctl is-active --quiet fail2ban; then
    echo "âœ… fail2ban Ð°ÐºÑ‚Ð¸Ð²ÐµÐ½" >> $REPORT_FILE
else
    echo "âŒ fail2ban Ð½ÐµÐ°ÐºÑ‚Ð¸Ð²ÐµÐ½" >> $REPORT_FILE
fi

# AIDE ÑÑ‚Ð°Ñ‚ÑƒÑ
if which aide > /dev/null; then
    echo "âœ… AIDE ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½" >> $REPORT_FILE
else
    echo "âŒ AIDE Ð½Ðµ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½" >> $REPORT_FILE
fi

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿Ñ€Ð°Ð² Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð°
echo -e "\n2. ÐŸÐ ÐÐ’Ð Ð”ÐžÐ¡Ð¢Ð£ÐŸÐ Ðš Ð¤ÐÐ™Ð›ÐÐœ:" >> $REPORT_FILE

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿Ñ€Ð°Ð² Ð½Ð° ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸
if [ "$(stat -c %a /opt/vless/configs/)" = "755" ]; then
    echo "âœ… ÐŸÑ€Ð°Ð²Ð° Ð½Ð° configs Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ðµ (755)" >> $REPORT_FILE
else
    echo "âŒ ÐÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ðµ Ð¿Ñ€Ð°Ð²Ð° Ð½Ð° configs" >> $REPORT_FILE
fi

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿Ñ€Ð°Ð² Ð½Ð° ÑÐµÑ€Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ñ‹
if [ "$(stat -c %a /opt/vless/certs/)" = "700" ]; then
    echo "âœ… ÐŸÑ€Ð°Ð²Ð° Ð½Ð° certs Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ðµ (700)" >> $REPORT_FILE
else
    echo "âŒ ÐÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ðµ Ð¿Ñ€Ð°Ð²Ð° Ð½Ð° certs" >> $REPORT_FILE
fi

# ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° Ð¾Ñ‚Ñ‡ÐµÑ‚Ð°
/opt/vless/modules/telegram_bot_manager.sh send-file $REPORT_FILE "Compliance Ð¾Ñ‚Ñ‡ÐµÑ‚"
EOF

sudo chmod +x /usr/local/bin/compliance-check

# Ð•Ð¶ÐµÐ½ÐµÐ´ÐµÐ»ÑŒÐ½Ð°Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ñ
echo "0 9 * * 1 root /usr/local/bin/compliance-check" >> /etc/crontab
```

## ðŸš¨ ÐŸÐ»Ð°Ð½Ñ‹ Ñ€ÐµÐ°Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ

### ÐŸÐ»Ð°Ð½ Ñ€ÐµÐ°Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð½Ð° Ð¸Ð½Ñ†Ð¸Ð´ÐµÐ½Ñ‚Ñ‹

#### ÐšÐ»Ð°ÑÑÐ¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ñ Ð¸Ð½Ñ†Ð¸Ð´ÐµÐ½Ñ‚Ð¾Ð²

| Ð£Ñ€Ð¾Ð²ÐµÐ½ÑŒ | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ | Ð’Ñ€ÐµÐ¼Ñ Ñ€ÐµÐ°Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ | Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ |
|---------|----------|-------------------|----------|
| P1 - ÐšÑ€Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ | ÐšÐ¾Ð¼Ð¿Ñ€Ð¾Ð¼ÐµÑ‚Ð°Ñ†Ð¸Ñ ÑÐµÑ€Ð²ÐµÑ€Ð° | 15 Ð¼Ð¸Ð½ÑƒÑ‚ | ÐÐµÐ¼ÐµÐ´Ð»ÐµÐ½Ð½Ð°Ñ Ð¸Ð·Ð¾Ð»ÑÑ†Ð¸Ñ |
| P2 - Ð’Ñ‹ÑÐ¾ÐºÐ¸Ð¹ | DDoS Ð°Ñ‚Ð°ÐºÐ° | 30 Ð¼Ð¸Ð½ÑƒÑ‚ | ÐÐºÑ‚Ð¸Ð²Ð°Ñ†Ð¸Ñ Ð·Ð°Ñ‰Ð¸Ñ‚Ñ‹ |
| P3 - Ð¡Ñ€ÐµÐ´Ð½Ð¸Ð¹ | ÐŸÐ¾Ð´Ð¾Ð·Ñ€Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ | 1 Ñ‡Ð°Ñ | ÐÐ½Ð°Ð»Ð¸Ð· Ð¸ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ |
| P4 - ÐÐ¸Ð·ÐºÐ¸Ð¹ | ÐÐ°Ñ€ÑƒÑˆÐµÐ½Ð¸Ñ Ð¿Ð¾Ð»Ð¸Ñ‚Ð¸Ðº | 4 Ñ‡Ð°ÑÐ° | Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ |

#### ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð¾Ñ‚Ð²ÐµÑ‚Ð½Ñ‹Ðµ Ð¼ÐµÑ€Ñ‹

```bash
# Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð³Ð¾ Ñ€ÐµÐ°Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ
sudo cat > /usr/local/bin/incident-response << 'EOF'
#!/bin/bash

INCIDENT_TYPE=$1
SOURCE_IP=$2

case $INCIDENT_TYPE in
    "ddos")
        # Ð‘Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ° IP
        ufw deny from $SOURCE_IP

        # Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ðµ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð°
        /opt/vless/modules/telegram_bot_manager.sh send-alert "DDoS Ð°Ñ‚Ð°ÐºÐ° Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð° Ð¾Ñ‚ IP: $SOURCE_IP. IP Ð·Ð°Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ð½."

        # Ð›Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ
        echo "$(date): DDoS attack blocked from $SOURCE_IP" >> /var/log/security-incidents.log
        ;;

    "intrusion")
        # ÐÐµÐ¼ÐµÐ´Ð»ÐµÐ½Ð½Ð°Ñ Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ°
        ufw deny from $SOURCE_IP

        # Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ snapshot ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹
        /opt/vless/modules/backup_restore.sh create --emergency

        # ÐšÑ€Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ðµ
        /opt/vless/modules/telegram_bot_manager.sh send-alert "ðŸš¨ ÐšÐ Ð˜Ð¢Ð˜Ð§Ð•Ð¡ÐšÐ˜Ð™ Ð˜ÐÐ¦Ð˜Ð”Ð•ÐÐ¢: ÐžÐ±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¾ Ð²Ñ‚Ð¾Ñ€Ð¶ÐµÐ½Ð¸Ðµ Ð¾Ñ‚ IP: $SOURCE_IP"

        # Ð˜Ð·Ð¾Ð»ÑÑ†Ð¸Ñ ÑÐµÑ€Ð²Ð¸ÑÐ° (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾)
        # systemctl stop vless-vpn
        ;;

    "bruteforce")
        # Ð£Ð²ÐµÐ»Ð¸Ñ‡ÐµÐ½Ð¸Ðµ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸ Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ¸ fail2ban
        fail2ban-client set sshd bantime 86400

        # Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ðµ
        /opt/vless/modules/telegram_bot_manager.sh send-alert "Ð‘Ñ€ÑƒÑ‚Ñ„Ð¾Ñ€Ñ Ð°Ñ‚Ð°ÐºÐ° Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð° Ð¾Ñ‚ IP: $SOURCE_IP"
        ;;
esac
EOF

sudo chmod +x /usr/local/bin/incident-response
```

### ÐŸÐ»Ð°Ð½ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ

#### ÐŸÑ€Ð¾Ñ†ÐµÐ´ÑƒÑ€Ð° Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ Ð¿Ð¾ÑÐ»Ðµ ÐºÐ¾Ð¼Ð¿Ñ€Ð¾Ð¼ÐµÑ‚Ð°Ñ†Ð¸Ð¸

```bash
# Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹
sudo cat > /usr/local/bin/disaster-recovery << 'EOF'
#!/bin/bash

echo "ÐÐÐ§ÐÐ›Ðž ÐŸÐ ÐžÐ¦Ð•Ð”Ð£Ð Ð« Ð’ÐžÐ¡Ð¡Ð¢ÐÐÐžÐ’Ð›Ð•ÐÐ˜Ð¯ Ð¡Ð˜Ð¡Ð¢Ð•ÐœÐ«"
echo "========================================"

# 1. Ð˜Ð·Ð¾Ð»ÑÑ†Ð¸Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹
echo "1. Ð˜Ð·Ð¾Ð»ÑÑ†Ð¸Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹..."
systemctl stop vless-vpn
ufw deny incoming

# 2. Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ñ„Ð¾Ñ€ÐµÐ½Ð·Ð¸Ñ‡ÐµÑÐºÐ¾Ð¹ ÐºÐ¾Ð¿Ð¸Ð¸
echo "2. Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ñ„Ð¾Ñ€ÐµÐ½Ð·Ð¸Ñ‡ÐµÑÐºÐ¾Ð¹ ÐºÐ¾Ð¿Ð¸Ð¸..."
FORENSIC_DIR="/tmp/forensics-$(date +%Y%m%d-%H%M%S)"
mkdir -p $FORENSIC_DIR
cp -r /opt/vless/logs/ $FORENSIC_DIR/
cp -r /var/log/ $FORENSIC_DIR/system_logs/
ps aux > $FORENSIC_DIR/processes.txt
netstat -tulpn > $FORENSIC_DIR/network.txt

# 3. ÐŸÐ¾Ð»Ð½Ð°Ñ Ñ€ÐµÐ³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ ÐºÐ»ÑŽÑ‡ÐµÐ¹
echo "3. Ð ÐµÐ³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ Ð²ÑÐµÑ… ÐºÐ»ÑŽÑ‡ÐµÐ¹..."
/opt/vless/modules/cert_management.sh regenerate --force

# 4. Ð¡Ð¼ÐµÐ½Ð° Ð²ÑÐµÑ… Ð¿Ð°Ñ€Ð¾Ð»ÐµÐ¹
echo "4. Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ Ð½Ð¾Ð²Ñ‹Ñ… Ð¿Ð°Ñ€Ð¾Ð»ÐµÐ¹..."
NEW_SSH_PASS=$(openssl rand -base64 32)
echo "ÐÐ¾Ð²Ñ‹Ð¹ Ð¿Ð°Ñ€Ð¾Ð»ÑŒ SSH: $NEW_SSH_PASS"

# 5. ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹
echo "5. ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹..."
apt update && apt upgrade -y

# 6. ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ñ†ÐµÐ»Ð¾ÑÑ‚Ð½Ð¾ÑÑ‚Ð¸
echo "6. ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ñ†ÐµÐ»Ð¾ÑÑ‚Ð½Ð¾ÑÑ‚Ð¸ Ñ„Ð°Ð¹Ð»Ð¾Ð²..."
aide --check

# 7. Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ ÑÐµÑ€Ð²Ð¸ÑÐ°
echo "7. Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ ÑÐµÑ€Ð²Ð¸ÑÐ°..."
systemctl start vless-vpn
ufw allow 22,80,443/tcp

# 8. Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ðµ Ð¾ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ð¸
/opt/vless/modules/telegram_bot_manager.sh send-alert "ÐŸÑ€Ð¾Ñ†ÐµÐ´ÑƒÑ€Ð° Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð°. Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð°."

echo "ÐŸÐ ÐžÐ¦Ð•Ð”Ð£Ð Ð Ð’ÐžÐ¡Ð¡Ð¢ÐÐÐžÐ’Ð›Ð•ÐÐ˜Ð¯ Ð—ÐÐ’Ð•Ð Ð¨Ð•ÐÐ"
EOF

sudo chmod +x /usr/local/bin/disaster-recovery
```

### ÐšÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ñ‹ ÑÐºÑÑ‚Ñ€ÐµÐ½Ð½Ð¾Ð³Ð¾ Ñ€ÐµÐ°Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ

```bash
# Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ñ„Ð°Ð¹Ð»Ð° ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð¾Ð²
sudo cat > /opt/vless/emergency-contacts.txt << 'EOF'
ÐšÐžÐÐ¢ÐÐšÐ¢Ð« Ð­ÐšÐ¡Ð¢Ð Ð•ÐÐÐžÐ“Ðž Ð Ð•ÐÐ“Ð˜Ð ÐžÐ’ÐÐÐ˜Ð¯
==============================

ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€:
- Telegram: @admin_username
- Email: admin@example.com
- Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½: +1234567890

Ð ÐµÐ·ÐµÑ€Ð²Ð½Ñ‹Ð¹ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€:
- Telegram: @backup_admin
- Email: backup@example.com

Ð¢ÐµÑ…Ð½Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ°:
- Email: support@example.com
- Ticket ÑÐ¸ÑÑ‚ÐµÐ¼Ð°: https://support.example.com

ÐŸÑ€Ð°Ð²Ð¾Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¾Ñ€Ð³Ð°Ð½Ñ‹:
- ÐŸÐ¾Ð»Ð¸Ñ†Ð¸Ñ: 102
- ÐšÐ¸Ð±ÐµÑ€Ð¿Ð¾Ð»Ð¸Ñ†Ð¸Ñ: +7-xxx-xxx-xxxx

ÐŸÐ ÐžÐ¦Ð•Ð”Ð£Ð Ð«:
1. ÐŸÑ€Ð¸ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ð¸ Ð¸Ð½Ñ†Ð¸Ð´ÐµÐ½Ñ‚Ð° - Ð½ÐµÐ¼ÐµÐ´Ð»ÐµÐ½Ð½Ð¾ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð¸Ñ‚ÑŒ Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð³Ð¾ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð°
2. ÐŸÑ€Ð¸ Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚Ð¸ Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð³Ð¾ - ÑÐ²ÑÐ·Ð°Ñ‚ÑŒÑÑ Ñ Ñ€ÐµÐ·ÐµÑ€Ð²Ð½Ñ‹Ð¼
3. ÐŸÑ€Ð¸ ÑÐµÑ€ÑŒÐµÐ·Ð½Ð¾Ð¼ Ð½Ð°Ñ€ÑƒÑˆÐµÐ½Ð¸Ð¸ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸ - ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð¸Ñ‚ÑŒ Ð¿Ñ€Ð°Ð²Ð¾Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¾Ñ€Ð³Ð°Ð½Ñ‹
4. Ð’ÑÐµ Ð¸Ð½Ñ†Ð¸Ð´ÐµÐ½Ñ‚Ñ‹ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð² /var/log/security-incidents.log
EOF
```

---

**Ð’Ð°Ð¶Ð½Ð¾**: Ð ÐµÐ³ÑƒÐ»ÑÑ€Ð½Ð¾ Ð¾Ð±Ð½Ð¾Ð²Ð»ÑÐ¹Ñ‚Ðµ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸ Ð¸ ÑÐ»ÐµÐ´Ð¸Ñ‚Ðµ Ð·Ð° Ð½Ð¾Ð²Ñ‹Ð¼Ð¸ ÑƒÐ³Ñ€Ð¾Ð·Ð°Ð¼Ð¸. Ð‘ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ - ÑÑ‚Ð¾ Ð½ÐµÐ¿Ñ€ÐµÑ€Ñ‹Ð²Ð½Ñ‹Ð¹ Ð¿Ñ€Ð¾Ñ†ÐµÑÑ, Ñ‚Ñ€ÐµÐ±ÑƒÑŽÑ‰Ð¸Ð¹ Ð¿Ð¾ÑÑ‚Ð¾ÑÐ½Ð½Ð¾Ð³Ð¾ Ð²Ð½Ð¸Ð¼Ð°Ð½Ð¸Ñ Ð¸ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ð¹.

**Ð¡Ð»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¹ ÑˆÐ°Ð³**: [Architecture](architecture.md)